"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3056],{69232:function(e,n,t){t.d(n,{W:function(){return a}});var r=t(47457),i=t(91012),o=t(49929),s=t(52322),a=function(e){var n=e.length,t=e.idealLength,a=e.maxLength;return(0,s.jsxs)(i.x,{fontSize:"xs",color:n>=a?"red.400":"gray.500",children:[n>=a&&(0,s.jsx)(o.G,{icon:r.e7})," ",n,"/",t]})}},56317:function(e,n,t){t.d(n,{r:function(){return nQ}});var r=t(7099),i=t(55452),o=t(20010),s=t(56915),a=t(48273),c=t(40110),l=t(80353),d=t(11919),u=t(45650),f=t(49929),p=t(55966),h=t(2784),x=t(13720),m=t(12741),g=t(20412),v=t(60577),j=t(87254),b=t(2167),y=t(71354),C=t(50390),O=t(81927),w=t(94659),k=t(53738),S=t(91012),E=t(72360),I=t(66724),P=t(18751),D=t(23313),A=t(8388),T=t(51331),R=t(49922),_=t(82483),M=t(32333),L=t(10710),z="gray.700",N=t(95235),Z=t(82269),G=t(48322),F=t(52322),U=["error","refetch"];function W(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function H(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?W(Object(t),!0).forEach(function(n){(0,N.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):W(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var V=function(e){var n=e.error,t=e.refetch,r=(0,Z.Z)(e,U);return(0,F.jsx)(k.xu,H(H({px:6,py:4},r),{},{children:(0,F.jsxs)(E.b,{p:6,status:"error",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",children:[(0,F.jsx)(G.z,{mr:0,boxSize:"30px",alignSelf:"center"}),(0,F.jsx)(I.C,{mt:4,mb:2,fontSize:"md",children:(0,F.jsx)(i.cC,{id:"uNQm3r"})}),(0,F.jsx)(P.X,{maxWidth:"md",children:n.message}),(0,F.jsx)(u.z,{mt:4,onClick:function(){return t()},children:(0,F.jsx)(i.cC,{id:"6gRgw8"})})]})}))},B=t(19664),q=t(97269),K=t(92619),Y=t(85982),J=t(64827),Q=function(){return j.ag._({id:"QbrUIo"})},X=function(){return j.ag._({id:"FbBkvL"})},$=function(e){var n=e.isAnalyticsLoading,t=e.hasError,r=e.view,o=e.setView,s=e.description;return t?(0,F.jsx)(K.x,{children:(0,F.jsx)(i.cC,{id:"ZlwDi6"})}):(0,F.jsxs)(d.k,{direction:"column",flex:1,children:[(0,F.jsx)(K.x,{children:n?(0,F.jsx)(ee,{}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(i.cC,{id:"ZlwDi6"}),(0,F.jsxs)(w.g,{align:"stretch",spacing:4,children:[(0,F.jsx)(S.x,{color:"gray.500",fontSize:"sm",fontWeight:"normal",letterSpacing:"normal",children:s}),(0,F.jsxs)(Y.E,{children:[(0,F.jsx)(Y.U,{children:(0,F.jsx)(u.z,{leftIcon:(0,F.jsx)(f.G,{icon:q.M,"aria-label":Q()}),variant:"ghost",fontWeight:"600",bg:"deckView"===r?"trueblue.50":"transparent",color:"deckView"===r?"trueblue.500":z,onClick:function(){return o("deckView")},children:Q()})}),(0,F.jsx)(Y.U,{children:(0,F.jsx)(u.z,{leftIcon:(0,F.jsx)(f.G,{icon:B.AG,"aria-label":X()}),variant:"ghost",fontWeight:"600",bg:"cardEngagement"===r?"trueblue.50":"transparent",color:"cardEngagement"===r?"trueblue.500":z,onClick:function(){return o("cardEngagement")},children:X()})})]})]})]})}),(0,F.jsx)(J.o,{})]})},ee=function(){return(0,F.jsxs)(w.g,{align:"stretch",spacing:4,children:[(0,F.jsx)(O.O,{h:12,width:"30%"}),(0,F.jsx)(O.O,{h:4,width:"80%"})]})},en=t(74373),et=t(68871),er=t(8283),ei=t(98875),eo=t(46358),es=t(62141),ea=t(98621),ec=t.n(ea),el=t(74542),ed=function(e){var n=e.degree,t=e.alpha,r=e.startColor,i=void 0===r?"#ECC94B":r,o=e.endColor,s=void 0===o?"#38A169":o;if(Number.isNaN(n))return ec()("#e5e0df").toHex8String();var a=ec()(i).toHsl(),c=ec()(s).toHsl();return ec()({h:(0,el.t7)(a.h,c.h,n),s:(0,el.t7)(a.s,c.s,n),l:(0,el.t7)(a.l,c.l,n),a:void 0===t?1:t}).toHex8String()},eu=function(e,n){return e.reduce(function(e,t){return e[t.cardId]=t[n],e},{})},ef=function e(n,t){var r,i=0;for(var o in n)i+=(null!==(r=t[o])&&void 0!==r?r:0)+e(n[o],t);return i},ep=function(e,n){var t,r=0;for(var i in e)r=Math.max((null!==(t=n[i])&&void 0!==t?t:0)+ef(e[i],n),r);return r},eh=t(81333),ex=t(56623),em=t(51068),eg=t(67784),ev=t(93319),ej=t(67887),eb=t(49747),ey=t(34717),eC=t(8635),eO=t(43227),ew=t(34860),ek=t(23769),eS=t(13813),eE=t(16844),eI=t(62349),eP=t.n(eI);function eD(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function eA(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?eD(Object(t),!0).forEach(function(n){(0,N.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eD(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var eT=function(e){var n=e.cardsViewed,t=e.totalCards,r=ed({degree:n/t}),o=t>0;return(0,F.jsxs)(er.U,{spacing:3,children:[(0,F.jsxs)(d.k,{flex:1,position:"relative",children:[(0,F.jsx)(eE.E,{h:4,flex:1,borderRadius:"sm",value:n,max:o?t:void 0,bg:"gray.200",sx:{"> div":{bg:r}}}),o&&n===t&&(0,F.jsx)(e_,{top:0,right:0,transform:"translate(50%,-50%)",position:"absolute"})]}),(0,F.jsx)(S.x,{w:{base:10,lg:12},fontSize:"sm",whiteSpace:"nowrap",textAlign:"left",children:o?"".concat(n,"/").concat(t):(0,F.jsx)(i.cC,{id:"8Va3Pt"})})]})},eR=function(e){var n=e.cardCount,t=(0,h.useMemo)(function(){return eP()(1,n)},[n]);return(0,F.jsxs)(er.U,{spacing:3,filter:"blur(3px)",children:[(0,F.jsx)(d.k,{flex:1,position:"relative",children:(0,F.jsx)(eE.E,{h:4,flex:1,borderRadius:"sm",value:t,max:n,bg:"gray.300",sx:{"> div":{bg:"gray.300"}}})}),(0,F.jsxs)(S.x,{w:{base:10,lg:12},fontSize:"sm",whiteSpace:"nowrap",textAlign:"left",color:"gray.600",children:[t,"/",n]})]})},e_=function(e){var n=(0,ek.Z)({},e);return(0,F.jsx)(k.Cd,eA(eA({bg:"green.500",size:"18px",border:"2px solid white",color:"white"},n),{},{children:(0,F.jsx)(f.G,{icon:eS.LE,"aria-label":j.ag._({id:"y886Ns"}),size:"xs"})}))};function eM(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function eL(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?eM(Object(t),!0).forEach(function(n){(0,N.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eM(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ez=function(e){var n,t=e.cards,r=e.isColorized,i=void 0!==r&&r,o=e.scaleToMax,s=void 0!==o&&o,a=e.includeChildren,c=e.showViewersPercent,l=void 0!==c&&c,d=e.leftLabel,u=e.rightLabel,f=e.tooltipLabel,x=e.cardLookupTable,g=e.onAnalyticsPanelClose,v=(n=a?ep(t,x):Math.max.apply(Math,(0,m.Z)(Object.values(x))),function(e){return(0,el.t7)(0,100,e/n)}),j=(0,h.useCallback)(function(e){return v(e)},[v]);return(0,F.jsxs)(k.xu,{mt:6,mb:4,children:[(0,F.jsxs)(er.U,{mb:3,children:[(0,F.jsx)(er.U,{children:(0,F.jsx)(p.NZ,{children:d})}),(0,F.jsx)(ev.L,{}),(0,F.jsx)(er.U,{children:(0,F.jsx)(p.kH,{placement:"top",label:f,children:(0,F.jsx)(er.U,{children:(0,F.jsx)(p.NZ,{borderBottom:"0.125em dashed",borderBottomColor:"gray.400",children:u})})})})]}),(0,F.jsx)(k.xu,{width:"100%",children:Object.entries(t).map(function(e){var n,t=(0,eh.Z)(e,2),r=t[0],o=t[1];return(0,F.jsx)(eN,{id:r,childCards:o,percentage:null!==(n=x[r])&&void 0!==n?n:0,calculatePercentageScale:j,isColorized:i,cardLookupTable:x,scaleToMax:s,includeChildren:a,showViewersPercent:l,onAnalyticsPanelClose:g},r)})})]})},eN=function e(n){var t=n.id,r=n.cardLookupTable,o=n.childCards,s=n.percentage,a=n.calculatePercentageScale,c=n.isColorized,l=n.scaleToMax,u=n.includeChildren,x=n.showViewersPercent,m=n.onAnalyticsPanelClose,g=(0,ei.ye)("screenshotsEnabled"),v=(0,h.useState)(!1),j=v[0],b=v[1],C=(0,ew.Ux)({placement:"top",gutter:12,enterDelay:200}),O=C.referenceRef,w=C.popperRef,E=C.isHovering,I=C.getPopperProps,P=C.onMouseOver,D=C.onMouseOut,A=(0,h.useCallback)(function(){b(!j)},[j]),T=(0,h.useCallback)(function(){(0,eO.D)({cardId:t}),m()},[t,m]),R=(0,eC.c)(t),_=(0,eC.T)({cardId:t}).title,M=Object.values(o).length>0,L=0===s,z=u?s+ef(o,r):s,N=j?z:0,Z=l?a(z):Math.min(100,N),G=j?s:z,U=l?a(G):Math.min(100,G),W={startColor:"#F6AD55",endColor:"#68D391"},H=c?ed(eL({degree:Z/100},W)):"trueblue.50",V=c?ed(eL({degree:U/100},W)):"trueblue.100";return(0,F.jsxs)(y.K,{children:[(0,F.jsxs)(d.k,{direction:"column",onMouseOver:P,onMouseOut:D,children:[(0,F.jsxs)(d.k,{ref:O,h:8,px:2,bg:"gray.100",borderRadius:"md",position:"relative",overflow:"hidden",alignItems:"center",_focusWithin:{shadow:"outline"},children:[(0,F.jsxs)(er.U,{pos:"absolute",zIndex:1,children:[M&&(0,F.jsx)(ej.h,{"aria-label":"expand-card",size:"xs",variant:"ghost",isRound:!0,colorScheme:"blackAlpha",icon:(0,F.jsx)(f.G,{icon:eg._t}),transform:j?"rotate(90deg)":"",onClick:A,_focus:{shadow:"none"}}),!M&&(0,F.jsx)(d.k,{w:6,justifyContent:"center",alignItems:"center",children:L?(0,F.jsx)(p.kH,{label:(0,F.jsx)(i.cC,{id:"s+PDNe"}),children:(0,F.jsx)(k.xu,{color:"blackAlpha.500",children:(0,F.jsx)(f.G,{icon:em.Aq,size:"sm"})})}):(0,F.jsx)(k.xu,{color:"blackAlpha.300",fontSize:"xx-small",children:(0,F.jsx)(f.G,{icon:ex.nZ,size:"sm"})})}),(0,F.jsx)(S.x,{color:L?"blackAlpha.500":void 0,noOfLines:1,children:_||(0,F.jsx)(i.cC,{id:"wja8aL"})})]}),(0,F.jsxs)(k.xu,{position:"absolute",w:"100%",height:"100%",top:0,left:0,pointerEvents:"none",children:[(0,F.jsx)(k.xu,{position:"absolute",h:"100%",bg:L?"blackAlpha.200":H,w:"".concat(Z,"%")}),(0,F.jsx)(k.xu,{transitionProperty:"all",transitionDuration:"normal",position:"absolute",h:"100%",bg:L?"blackAlpha.300":V,w:"".concat(U,"%")})]}),c&&100===s&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(ev.L,{}),(0,F.jsx)(e_,{alignSelf:"center",zIndex:1})]})]}),E&&(0,F.jsx)(p.qh,eL({ref:w,src:g?null==R?void 0:R.previewUrl:ey.Z.src,fallbackSrc:ey.Z.src,shouldShow:E,onClick:T,tooltip:(0,F.jsx)(i.cC,{id:"3YmIR6"}),label:x?(0,F.jsx)(i.cC,{id:"wmqtMZ",values:{percentage:s}}):void 0},I()))]}),(0,F.jsx)(k.xu,{pl:8,children:M&&Object.entries(o).map(function(n){var t,i=(0,eh.Z)(n,2),o=i[0],s=i[1];return(0,F.jsx)(eb.U,{in:j,children:(0,F.jsx)(e,{id:o,childCards:s,percentage:null!==(t=r[o])&&void 0!==t?t:0,cardLookupTable:r,calculatePercentageScale:a,scaleToMax:l,isColorized:c,includeChildren:u,showViewersPercent:x,onAnalyticsPanelClose:m})},o)})})]})},eZ=function(){return(0,F.jsx)(y.K,{spacing:2,children:(0,F.jsx)(i.cC,{id:"QXJTby",components:{0:(0,F.jsx)(S.x,{}),1:(0,F.jsx)(S.x,{}),2:(0,F.jsx)(S.x,{})}})})},eG=function(e){var n=e.timeInMS;return void 0===n?(0,F.jsx)(F.Fragment,{}):(0,F.jsx)(i.cC,{id:"yXHI9B",values:{timeInSeconds:n/1e3}})},eF=function(e){var n=e.docId,t=e.viewerFilter,r=e.currentViewerFilterCount,o=e.onAnalyticsPanelClose,s=(0,eo.qr)().getState(),a=(0,es.X9)(s),c=(0,D.IrH)({variables:{docId:n}}),l=c.data,d=c.error,p=c.loading,x=c.refetch,m=(0,h.useState)("viewTimePercent"),g=m[0],v=m[1],j="viewTimePercent"===g?{chartDescription:(0,F.jsx)(i.cC,{id:"dpTE1c",values:{viewerCount:r}}),leftLabel:(0,F.jsx)(i.cC,{id:"ml51m3"}),rightLabel:(0,F.jsx)(i.cC,{id:"8R7bfR"})}:{chartDescription:(0,F.jsx)(i.cC,{id:"b2VMTo",values:{viewerCount:r}}),leftLabel:(0,F.jsx)(i.cC,{id:"kTgCTO"}),rightLabel:(0,F.jsx)(i.cC,{id:"AKDcmS"})},b=j.chartDescription,y=j.rightLabel,C=j.leftLabel,O="viewersOnly"===t?"viewers":"everyone",w=(0,ei.ye)("cardViewedThreshold"),S=(0,h.useMemo)(function(){var e;return(null==l?void 0:null===(e=l.docCardsStats)||void 0===e?void 0:e[O])||[]},[null==l?void 0:l.docCardsStats,O]),E=(0,h.useMemo)(function(){return eu(S,g)},[S,g]),I=(0,h.useCallback)(function(){return v("viewTimePercent")},[]),P=(0,h.useCallback)(function(){return v("viewersPercent")},[]);return(0,F.jsxs)(k.xu,{children:[(0,F.jsxs)(er.U,{my:4,children:[(0,F.jsx)(u.z,{leftIcon:(0,F.jsx)(f.G,{icon:et.SZ,"aria-label":"Time spend"}),variant:"ghost",fontWeight:"600",bg:"viewTimePercent"===g?"trueblue.50":"transparent",color:"viewTimePercent"===g?"trueblue.500":z,onClick:I,children:(0,F.jsx)(i.cC,{id:"XyvAeS"})}),(0,F.jsx)(u.z,{leftIcon:(0,F.jsx)(f.G,{icon:en.jG,"aria-label":"Percent viewed"}),variant:"ghost",fontWeight:"600",bg:"viewersPercent"===g?"trueblue.50":"transparent",color:"viewersPercent"===g?"trueblue.500":z,onClick:P,children:(0,F.jsx)(i.cC,{id:"vXtpAZ"})})]}),(0,F.jsx)(eW,{description:b}),d&&(0,F.jsx)(V,{error:d,refetch:x}),p&&!d&&(0,F.jsx)(eU,{}),!p&&!d&&(0,F.jsx)(ez,{cards:a.tree,cardLookupTable:E,scaleToMax:"viewTimePercent"===g,isColorized:"viewersPercent"===g,includeChildren:"viewTimePercent"===g,showViewersPercent:"viewersPercent"===g,rightLabel:y,leftLabel:C,tooltipLabel:"viewTimePercent"===g?(0,F.jsx)(eZ,{}):(0,F.jsx)(eG,{timeInMS:w}),onAnalyticsPanelClose:o})]})},eU=function(e){var n=e.includeDescription;return(0,F.jsx)(d.k,{direction:"column",mt:6,mb:4,children:(0,F.jsxs)(w.g,{align:"stretch",children:[void 0!==n&&n&&(0,F.jsx)(O.O,{h:5,mb:3,w:"70%"}),(0,m.Z)([,,,,,]).map(function(e,n){return(0,F.jsx)(O.O,{h:8},n)})]})})},eW=function(e){var n=e.description;return(0,F.jsx)(S.x,{color:z,children:n})},eH=t(89364),eV=t(73851),eB=t(36258),eq=t(19875),eK=t(77525),eY=t(74642),eJ=t(35319),eQ=t(27912),eX=t(12221),e$=t(13061),e0=t(65903),e1=t.n(e0),e2=t(829),e5=t.n(e2),e3=t(75085),e4=t(81188),e6=["name","profileImg","email","isCreator","isContributor","isAnonymous"];function e8(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function e9(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?e8(Object(t),!0).forEach(function(n){(0,N.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):e8(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var e7=function(e){var n=e.uniqueViewers,t=e.docCreatedDate,r=(0,ei.ye)("cardViewedThreshold");return(0,F.jsx)(eV.h,{children:(0,F.jsxs)(eB.Tr,{children:[(0,F.jsx)(ne,{label:(0,F.jsx)(i.cC,{id:"LZHJAq",values:{uniqueViewers:n}}),tooltip:(0,F.jsx)(i.cC,{id:"aaiIlJ",values:{docCreatedDate:t}}),width:"40%"}),(0,F.jsx)(ne,{label:(0,F.jsx)(i.cC,{id:"pRGfP3"}),width:"35%"}),(0,F.jsx)(ne,{label:(0,F.jsx)(i.cC,{id:"QfqHuz"}),tooltip:(0,F.jsx)(eG,{timeInMS:r}),width:"25%"})]})})},ne=function(e){var n=e.label,t=e.width,r=e.tooltip,i=(0,F.jsx)(eq.Th,{w:t,children:(0,F.jsx)(S.x,{display:"inline",borderBottom:r?"0.125em dashed":void 0,borderBottomColor:r?"gray.400":void 0,children:n})});return r?(0,F.jsx)(p.kH,{placement:"top",label:r,children:i}):i},nn=["Yesterday at 11:02 am","Today at 12:55 pm","Dec 12, 2020, 10:19 pm","Apr 14, 2023, 4:30 pm","Jan 1, 2021, 12:03 am","Dec 7, 1984, 12:03 am","May 14, 2002, 3:56 pm"],nt=function(e){var n=e.viewers,t=e.currentViewerFilterCount,r=e.docCreatedDate,i=e.creatorId,o=e.contributors,s=e.cardCount,a=e.handleTableRowClick,c=e.hasIndividualAnalytics,l=(0,L.SE)().user,d=c?n:e5()(n,function(e){var n;return[(null===(n=e.user)||void 0===n?void 0:n.id)===(null==l?void 0:l.id)?0:1,-e.lastOpened]}).slice(0,3);return(0,F.jsx)(eK.x,{children:(0,F.jsxs)(eY.i,{colorScheme:"blackAlpha",children:[(0,F.jsx)(e7,{uniqueViewers:t,docCreatedDate:r}),(0,F.jsx)(eJ.p,{children:d.map(function(e,t){var r=e.user,d=e.lastOpened,u=e.visitorId,f=(null==r?void 0:r.id)===i,p=o.some(function(e){return e.user.id===(null==r?void 0:r.id)}),h=r?r.displayName+(r.id===(null==l?void 0:l.id)?" "+j.ag._({id:"dDUgzP"}):"")||"":j.ag._({id:"VmjbJY"}),x=d?e1()((0,e4.P9)(d)):j.ag._({id:"/JO3xr"}),m={name:h,id:(null==r?void 0:r.id)||u||"",email:null==r?void 0:r.email,isCreator:f,isContributor:p,profileImg:null==r?void 0:r.profileImageUrl,lastOpened:x},g=t===n.length-1,v=(null==r?void 0:r.id)===(null==l?void 0:l.id),b=!c&&!v;return(0,F.jsxs)(eB.Tr,{cursor:"pointer",onClick:function(){return a(m)},_hover:{bg:"blackAlpha.50"},borderBottom:"none",children:[(0,F.jsx)(eQ.Td,{borderBottom:g?"0 none":void 0,children:(0,F.jsx)(nr,{name:h,email:null==r?void 0:r.email,profileImg:null==r?void 0:r.profileImageUrl,isContributor:p,isCreator:f,isAnonymous:!r})}),(0,F.jsx)(eQ.Td,{borderBottom:g?"0 none":void 0,children:b?(0,F.jsx)(S.x,{fontSize:"sm",filter:"blur(3px)",color:"gray.600",children:nn[t%nn.length]}):(0,F.jsx)(S.x,{fontSize:"sm",children:x})}),(0,F.jsx)(eQ.Td,{borderBottom:g?"0 none":void 0,children:b?(0,F.jsx)(eR,{cardCount:s}):(0,F.jsx)(eT,{cardsViewed:e.cardsViewed||0,totalCards:s||0})})]},(null==r?void 0:r.id)||u)})})]})})},nr=function(e){var n=e.name,t=e.profileImg,r=e.email,o=e.isCreator,s=void 0!==o&&o,a=e.isContributor,c=e.isAnonymous,l=(0,Z.Z)(e,e6);return(0,F.jsxs)(er.U,e9(e9({},l),{},{children:[(0,F.jsx)(eX.q,{size:"sm",name:n,src:t}),(0,F.jsxs)(y.K,{spacing:.5,children:[(0,F.jsxs)(S.x,{children:[n,void 0!==c&&c&&(0,F.jsx)(p.Yq,{label:(0,F.jsx)(i.cC,{id:"VHgG8W",values:{GAMMA_ARTIFACT_PROPER_NOUN:e3.Yc}}),ml:2})]}),(0,F.jsxs)(er.U,{mt:1,children:[(0,F.jsx)(S.x,{fontSize:"sm",color:"gray.500",children:void 0===r?"":r}),(s||void 0!==a&&a)&&(0,F.jsx)(e$.Vp,{size:"sm",transform:"translate(0, 1.5px)",children:s?(0,F.jsx)(i.cC,{id:"UE2beD"}):(0,F.jsx)(i.cC,{id:"3L51iw"})})]})]})]}))},ni=function(e){var n,t,r,o,s=e.user,a=e.onBackClick,l=e.docId,d=e.onAnalyticsPanelClose,f=(0,eo.qr)().getState(),p=(0,es.X9)(f),x=(0,D.IrH)({variables:{docId:l,userId:s.id},skip:!l||!s.id,pollInterval:9e5,notifyOnNetworkStatusChange:!0}),m=x.data,g=x.error,v=x.loading,j=x.refetch,y=null!==(n=null==m?void 0:null===(t=m.docCardsStats)||void 0===t?void 0:null===(r=t.everyone)||void 0===r?void 0:r.length)&&void 0!==n?n:0,C=null==m?void 0:null===(o=m.docCardsStats)||void 0===o?void 0:o.cardCount,O=(0,h.useMemo)(function(){var e;return(null==m?void 0:null===(e=m.docCardsStats)||void 0===e?void 0:e.everyone)||[]},[null==m?void 0:m.docCardsStats]),w=(0,h.useMemo)(function(){return eu(O,"viewTimePercent")},[O]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(K.x,{children:(0,F.jsx)(u.z,{"aria-label":"Back",leftIcon:(0,F.jsx)(eH.R,{}),variant:"ghost",onClick:a,children:(0,F.jsx)(i.cC,{id:"iH8pgl"})})}),(0,F.jsx)(J.o,{}),(0,F.jsx)(c.i,{}),(0,F.jsx)(b.f,{children:(0,F.jsxs)(k.xu,{children:[(0,F.jsx)(no,{user:s,showLastOpened:!0}),C&&(0,F.jsx)(eW,{description:(0,F.jsx)(i.cC,{id:"YJOrjl",values:{cardsViewed:y,totalCards:C}})}),v&&!g&&(0,F.jsx)(eU,{includeDescription:!0}),g&&(0,F.jsx)(V,{error:g,refetch:j}),!g&&!v&&(0,F.jsx)(ez,{cards:p.tree,scaleToMax:!0,includeChildren:!0,leftLabel:(0,F.jsx)(i.cC,{id:"ml51m3"}),rightLabel:(0,F.jsx)(i.cC,{id:"8R7bfR"}),cardLookupTable:w,tooltipLabel:(0,F.jsx)(eZ,{}),onAnalyticsPanelClose:d})]})})]})},no=function(e){var n=e.user,t=e.showLastOpened;return(0,F.jsxs)(er.U,{align:"center",my:6,children:[(0,F.jsx)(nr,{name:n.name,profileImg:n.profileImg,email:n.email,isCreator:n.isCreator,isContributor:n.isContributor,width:t?"50%":void 0}),t&&(0,F.jsxs)(w.g,{align:"flex-start",spacing:0,children:[(0,F.jsx)(p.NZ,{children:(0,F.jsx)(i.cC,{id:"pRGfP3"})}),(0,F.jsx)(S.x,{children:n.lastOpened})]})]})},ns=t(87567),na=t(47299),nc=t(81295),nl=t(26673),nd=t(9088),nu=t(30893),nf=t(40771),np=t(63849),nh=t(2575),nx=function(e,n,t){return"everyone"===e?j.ag._({id:"1IE7uf",values:{everyone:n}}):"viewersOnly"===e?j.ag._({id:"r/tA4Y",values:{viewersOnly:t}}):j.ag._({id:"V9JX7d"})},nm={everyone:nc.Nd,viewersOnly:na.Md,accessLinkOnly:ns.uW},ng=function(e){var n=e.selected,t=e.handleMenuItemChange,r=e.everyoneCount,o=e.viewersOnlyCount;return(0,F.jsxs)(nd.v,{children:[(0,F.jsx)(nu.j,{leftIcon:(0,F.jsx)(f.G,{size:"xs",icon:nm[n]}),as:u.z,size:"md",rightIcon:(0,F.jsx)(f.G,{size:"xs",icon:nl.pt}),children:nx(n,r,o)}),(0,F.jsx)(nf.q,{zIndex:2,maxW:"380px",children:(0,F.jsxs)(np._,{defaultValue:n,value:n,onChange:function(e){Array.isArray(e)||t(e)},children:[(0,F.jsx)(nh.i,{value:"everyone",isDisabled:0===r,children:(0,F.jsxs)(d.k,{align:"center",children:[(0,F.jsx)(f.G,{icon:nm.everyone,size:"xs"}),(0,F.jsxs)(k.xu,{ml:3,children:[(0,F.jsx)(S.x,{children:nx("everyone",r,o)}),(0,F.jsx)(S.x,{fontSize:"sm",color:"gray.500",children:(0,F.jsx)(i.cC,{id:"c5ESvc",values:{GAMMA_ARTIFACT_PROPER_NOUN:e3.Yc}})})]})]})}),(0,F.jsx)(nh.i,{value:"viewersOnly",isDisabled:0===o,children:(0,F.jsxs)(d.k,{align:"center",children:[(0,F.jsx)(f.G,{icon:nm.viewersOnly,size:"xs"}),(0,F.jsxs)(k.xu,{ml:3,children:[(0,F.jsx)(S.x,{children:nx("viewersOnly",r,o)}),(0,F.jsx)(S.x,{fontSize:"sm",color:"gray.500",children:(0,F.jsx)(i.cC,{id:"5hKO48",values:{GAMMA_ARTIFACT_PROPER_NOUN:e3.Yc}})})]})]})}),!1]})})]})},nv=t(46102),nj=t(6802),nb=t(70258),ny=t(80237),nC=t(59309),nO=t(2574),nw=t(92638),nk=t(33951),nS=t(10897),nE=t(14582),nI=t(75715),nP=t(96492),nD=t(14141),nA=t(40837),nT=["chartTitle","TooltipInner","showZero","shouldRoundYValues","showMaxAndMiddle","data","barColor","customTooltipStyles","onClick"];function nR(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function n_(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nR(Object(t),!0).forEach(function(n){(0,N.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nR(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var nM={top:55,right:20,bottom:40,left:24},nL=function(e){return Math.round(e).toString()},nz={backgroundColor:"var(--chakra-colors-blackAlpha-800)",color:"var(--chakra-colors-gray-100)",fontFamily:"Inter, sans-serif",boxShadow:"var(--chakra-shadows-4)",fontSize:"var(--chakra-fontSizes-xs)",borderRadius:"var(--chakra-radii-sm)",fontWeight:"var(--chakra-fontWeights-semibold)",borderWidth:"1px",borderColor:"black",paddingRight:"var(--chakra-space-1.5)",paddingLeft:"var(--chakra-space-1.5)",paddingTop:"var(--chakra-space-0.5)",paddingBottom:"var(--chakra-space-0.5)",zIndex:"var(--chakra-zIndex-tooltip)",minWidth:"60px",lineHeight:"var(--chakra-lineHeights-base)"},nN="var(--chakra-colors-gray-500)",nZ="var(--chakra-colors-gray-200)",nG=function(e){var n,t=e.width,r=e.height,i=e.margin,o=void 0===i?nM:i,s=e.chartData,a=e.TooltipInner,c=e.showZero,l=e.shouldRoundYValues,d=e.showMaxAndMiddle,u=e.barColor,f=e.customTooltipStyles,p=e.onClick,x=void 0===p?function(){}:p,g=(0,nP.Z)(),v=g.showTooltip,j=g.tooltipOpen,b=g.tooltipLeft,y=g.tooltipTop,C=g.tooltipData,O=g.hideTooltip,w=(0,h.useRef)(),S=(0,h.useRef)();(0,h.useEffect)(function(){return function(){w.current&&clearTimeout(w.current),S.current&&clearTimeout(S.current)}},[]);var E=s.map(function(e){return e.y}),I=Math.max.apply(Math,(0,m.Z)(E)),P=[I,Math.round(I/2)],D=(n=d?P:E,Math.max.apply(Math,(0,m.Z)(n.map(function(e){return(0,nI.Z)(e.toString(),{fontFamily:"Inter, sans-serif",fontSize:"var(--chakra-fontSizes-sm)",fontWeight:"600"})||0})))),A=o.left+D,T=t-A-o.right,R=r-o.top-o.bottom,_=n_(n_(n_({},nD.j),nz),f),M=(0,h.useMemo)(function(){return(0,nw.Z)({range:[0,T],domain:s.map(function(e){return e.x}),padding:.3})},[T,s]),L=(0,h.useMemo)(function(){return(0,nk.Z)({range:[R,0],round:!0,domain:[0,I]})},[R,I]),z=c?L(Math.min.apply(Math,(0,m.Z)(E.filter(function(e){return 0!==e})))):R,N=c&&R-z>6;return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(k.xu,{children:(0,F.jsxs)("svg",{width:t,height:r,children:[(0,F.jsx)("rect",{x:0,y:0,rx:4,width:t,height:r,fill:"var(--chakra-colors-gray-100)"}),(0,F.jsx)(nC.Z,{top:o.top,left:A,children:s.map(function(e){var n,t,r=e.y,i=e.x,o="bar-".concat(i,"-").concat(r),s=M.bandwidth(),a=R-(null!==(n=L(r))&&void 0!==n?n:0),l=N&&0===a?6:a,d=null!==(t=M(i))&&void 0!==t?t:0,f=R-l;return(0,F.jsxs)(nC.Z,{children:[(0,F.jsx)(nS.Z,{x:d,y:f,width:s,height:l,radius:5,topLeft:!0,topRight:!0,fill:c&&0===r?nZ:u,onMouseLeave:function(){w.current=window.setTimeout(function(){O()},300)},onMouseMove:function(n){w.current&&clearTimeout(w.current);var t=(0,ny.Z)(n);v({tooltipData:e,tooltipTop:null==t?void 0:t.y,tooltipLeft:null==t?void 0:t.x})},onClick:function(n){return x(n,e)}}),(0,F.jsx)(nE.Z,{x:d,y:0,width:s,height:Math.max(0,R-l),opacity:0,onMouseLeave:function(){S.current=window.setTimeout(function(){O()},300)},onMouseMove:function(n){S.current&&clearTimeout(S.current);var t=(0,ny.Z)(n);v({tooltipData:e,tooltipTop:null==t?void 0:t.y,tooltipLeft:null==t?void 0:t.x})}})]},o)})}),(0,F.jsx)(nj.Z,{top:o.top,left:A,scale:L,stroke:nZ,strokeWidth:2,tickValues:d?P:void 0,numTicks:d?void 0:2,hideZero:!0,tickFormat:l?nL:void 0,tickLength:6,tickStroke:nZ,tickLabelProps:function(){return{fill:nN,textAnchor:"end",fontFamily:"Inter, sans-serif",fontSize:"var(--chakra-fontSizes-sm)",fontWeight:"600",dy:"0.33em",dx:-4}}}),(0,F.jsx)(nb.Z,{top:R+o.top,left:A,scale:M,stroke:nZ,numTicks:4,tickStroke:nZ,tickLabelProps:function(){return{fill:nN,textAnchor:"middle",fontFamily:"Inter, sans-serif",fontSize:"var(--chakra-fontSizes-sm)",fontWeight:"600",dy:4}},strokeWidth:2,tickLength:6})]})}),j&&C&&(0,F.jsx)(nA.Z,{top:y,left:b,style:_,children:(0,F.jsx)(a,{x:C.x,y:C.y})})]})},nF=function(e){var n=e.chartTitle,t=e.TooltipInner,r=e.showZero,i=void 0===r||r,o=e.shouldRoundYValues,s=void 0===o||o,a=e.showMaxAndMiddle,c=void 0===a||a,l=e.data,d=e.barColor,u=void 0===d?"var(--chakra-colors-trueblue-200)":d,f=e.customTooltipStyles,p=e.onClick,h=void 0===p?function(){}:p,x=(0,Z.Z)(e,nT);return(0,F.jsxs)(k.xu,n_(n_({position:"relative",height:"300px"},x),{},{children:[(0,F.jsx)(S.x,{size:"xs",color:"gray.500",fontWeight:"600",position:"absolute",top:3,left:"50%",transform:"translateX(-50%)",children:n}),(0,F.jsx)(nO.Z,{children:function(e){var n=e.width,r=e.height;return n<10?null:(0,F.jsx)(nG,{width:n,height:r,showZero:i,chartData:l,barColor:u,customTooltipStyles:f,onClick:h,TooltipInner:t,shouldRoundYValues:s,showMaxAndMiddle:c})}})]}))},nU=function(e,n){var t="LLL d",r=new Date;r.setDate(r.getDate()-n+1);for(var i=[],o=0;o<n;o++)!function(n){var o=new Date(r);o.setDate(o.getDate()+n);var s=(0,nv.Z)(o,{representation:"date"}),a=e.find(function(e){return e.date===s});a?i.push({x:(0,A.p6)(a.date,t),y:a.uniqueVisitors?a.uniqueVisitors:0}):i.push({x:(0,A.p6)(s,t),y:0})}(o);return i},nW=function(e){var n=nU(e.viewData,e.dayCount);return(0,F.jsx)(nF,{data:n,my:3,chartTitle:(0,F.jsx)(i.cC,{id:"mSEibf"}),TooltipInner:nH})},nH=function(e){var n=e.x,t=e.y;return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(S.x,{children:n}),(0,F.jsx)(S.x,{children:(0,F.jsx)(i.cC,{id:"6MKtHx",values:{y:t}})})]})},nV=function(e,n,t){if(!t)return 0;var r,i,o,s=null!==(r=t.uniqueViewers)&&void 0!==r?r:0,a=null!==(i=null===(o=e.editors)||void 0===o?void 0:o.length)&&void 0!==i?i:0;return"everyone"===n?s:"viewersOnly"===n?Math.max(0,s-a):0},nB=function(e){var n,t,r,o=e.doc,s=e.handleSharePanelOpen,a=e.onAnalyticsPanelClose,l=(0,D.xls)({variables:{memoId:o.id},skip:!o.id,pollInterval:9e5,notifyOnNetworkStatusChange:!0}),f=l.loading,p=l.data,x=l.error,m=l.refetch,g=(0,L.SE)().user,v=(0,h.useState)("deckView"),O=v[0],w=v[1],k=(0,h.useState)(null),S=k[0],E=k[1],I=(0,h.useState)("everyone"),P=I[0],z=I[1],N=(0,A.p6)(o.createdTime,"PPP"),Z=o.title||(0,F.jsx)(i.cC,{id:"wja8aL"}),G=(null==p?void 0:p.memoStats.viewers)||[],U=(null==p?void 0:null===(t=p.memoStats.dailyViews)||void 0===t?void 0:t.dayCount)||0,W=(n=null==p?void 0:p.memoStats)&&n.dailyViews?"everyone"===P?n.dailyViews.everyone?n.dailyViews.everyone:[]:"viewersOnly"===P&&n.dailyViews.viewers?n.dailyViews.viewers:[]:[],H=(0,T.Y)("individual_analytics",o.organization),B=(0,_.zc)().openUpsellModal,q=W.every(function(e){return 0===e.uniqueVisitors}),K=G.filter(function(e){var n;return"everyone"===P||!(null!==(n=o.editors)&&void 0!==n&&n.some(function(n){var t,r;return(null===(t=e.user)||void 0===t?void 0:t.id)===(null===(r=n.user)||void 0===r?void 0:r.id)}))}),Y=nV(o,P,null==p?void 0:p.memoStats),J=(0,h.useCallback)(function(e){z(e)},[]),ee=(0,h.useCallback)(function(e){w(e)},[]),en=(0,h.useCallback)(function(e){if(!H&&e.id!==(null==g?void 0:g.id)){B({segmentEvent:M.AA.GAMMA_PRO_UPSELL_SUBSCRIPTION_INDIVIDUAL_ANALYTICS});return}E(e)},[B,H,g]),et=(0,h.useCallback)(function(){E(null)},[]),er=void 0!==x;return(0,F.jsxs)(F.Fragment,{children:[S&&(0,F.jsx)(ni,{user:S,onBackClick:et,docId:o.id,onAnalyticsPanelClose:a}),!S&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)($,{hasError:er,isAnalyticsLoading:f,setView:ee,view:O,description:(0,F.jsx)(i.cC,{id:"uEtUah",values:{docTitle:Z,docCreatedDate:N}})}),er&&(0,F.jsx)(V,{error:x,refetch:m}),!er&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(c.i,{}),(0,F.jsxs)(b.f,{children:[f&&(0,F.jsx)(nq,{}),!f&&G.length<=1&&(0,F.jsx)(nK,{handleSharePanelOpen:s}),!f&&(0,F.jsxs)(y.K,{direction:"column",mt:4,spacing:4,children:[(0,F.jsxs)(d.k,{direction:"row",justify:"space-between",align:"center",children:[(0,F.jsx)(C.X,{as:"h2",size:"md",children:"cardEngagement"===O?X():Q()}),(0,F.jsx)(ng,{selected:P,handleMenuItemChange:J,everyoneCount:nV(o,"everyone",null==p?void 0:p.memoStats),viewersOnlyCount:nV(o,"viewersOnly",null==p?void 0:p.memoStats)})]}),"deckView"===O&&q&&(0,F.jsx)(nY,{handleSharePanelOpen:s,dayCount:U}),"deckView"===O&&!q&&(0,F.jsx)(nW,{viewData:W,dayCount:U}),"cardEngagement"===O&&(0,F.jsx)(eF,{docId:o.id,viewerFilter:P,currentViewerFilterCount:Y,onAnalyticsPanelClose:a}),(0,F.jsx)(nt,{creatorId:(null===(r=o.createdBy)||void 0===r?void 0:r.id)||"",viewers:K,currentViewerFilterCount:Y,docCreatedDate:N,contributors:o.editors||[],cardCount:(null==p?void 0:p.memoStats.cardCount)||0,handleTableRowClick:en,hasIndividualAnalytics:H}),K.length>3&&!H&&(0,F.jsx)(u.z,{variant:"ghost",size:"sm",color:"gray.600",colorScheme:"gray",onClick:function(){return B({segmentEvent:M.AA.GAMMA_PRO_UPSELL_SUBSCRIPTION_INDIVIDUAL_ANALYTICS})},children:(0,F.jsx)(i.cC,{id:"BKBX4n",values:{0:K.length-3}})}),!H&&(0,F.jsx)(R.m,{segmentEvent:M.AA.GAMMA_PRO_UPSELL_SUBSCRIPTION_INDIVIDUAL_ANALYTICS,description:j.ag._({id:"GYgPBy"})})]})]})]})]})]})},nq=function(){return(0,F.jsxs)(d.k,{direction:"column",py:2,children:[(0,F.jsx)(O.O,{h:10,width:"40%",mb:4}),(0,F.jsx)(O.O,{h:40,mb:4}),(0,F.jsx)(w.g,{align:"stretch",children:(0,m.Z)([,,,]).map(function(e,n){return(0,F.jsx)(O.O,{h:12},n)})})]})},nK=function(e){var n=e.handleSharePanelOpen;return(0,F.jsx)(d.k,{p:3,px:4,mt:2,bg:"gray.100",color:z,borderRadius:"base",children:(0,F.jsxs)(d.k,{align:"baseline",fontSize:"sm",children:[(0,F.jsx)(k.xu,{pr:2,children:(0,F.jsx)(f.G,{icon:v.IL,"aria-label":"user-icon",size:"sm"})}),(0,F.jsx)(S.x,{children:(0,F.jsx)(i.cC,{id:"FNMh4I",components:{0:(0,F.jsx)(S.x,{as:"button",onClick:n,textDecoration:"underline",fontWeight:"600",color:"gray.800"})}})})]})})},nY=function(e){var n=e.handleSharePanelOpen,t=e.dayCount;return(0,F.jsxs)(E.b,{my:4,p:6,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",colorScheme:"gray",children:[(0,F.jsx)(k.Cd,{size:"30px",bg:"gray.500",children:(0,F.jsx)(f.G,{icon:g.Im,color:"white"})}),(0,F.jsx)(I.C,{mt:4,mb:2,fontSize:"md",children:(0,F.jsx)(i.cC,{id:"2OzAI5"})}),t>0&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(P.X,{maxWidth:"sm",children:(0,F.jsx)(i.cC,{id:"qQLmo7",values:{dayCount:t}})}),(0,F.jsx)(u.z,{mt:4,onClick:n,children:(0,F.jsx)(i.cC,{id:"IXzWG0"})})]})]})},nJ=function(e){var n,t,r,o,s,a,l=e.doc,d=e.onAnalyticsPanelClose,u=(0,eo.qr)().getState(),f=(0,es.X9)(u),p=(0,L.SE)().user,x=(0,D.IrH)({variables:{docId:l.id,userId:null==p?void 0:p.id},skip:!(null!=p&&p.id),pollInterval:9e5,notifyOnNetworkStatusChange:!0}),m=x.data,g=x.error,v=x.loading,j=x.refetch,y=null!==(n=null==m?void 0:null===(t=m.docCardsStats)||void 0===t?void 0:null===(r=t.everyone)||void 0===r?void 0:r.length)&&void 0!==n?n:0,C=null==m?void 0:null===(o=m.docCardsStats)||void 0===o?void 0:o.cardCount,O=(0,h.useMemo)(function(){var e;return(null==m?void 0:null===(e=m.docCardsStats)||void 0===e?void 0:e.everyone)||[]},[null==m?void 0:m.docCardsStats]),w=(0,h.useMemo)(function(){return eu(O,"viewTimePercent")},[O]);if(!p)return null;var I=p.id===(null===(s=l.createdBy)||void 0===s?void 0:s.id),P=null===(a=l.editors)||void 0===a?void 0:a.some(function(e){return e.user.id===p.id}),A={name:p.displayName,id:p.id,profileImg:p.profileImageUrl,email:p.email,isContributor:P,isCreator:I};return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(K.x,{children:[(0,F.jsx)(i.cC,{id:"ZlwDi6"}),(0,F.jsx)(S.x,{fontSize:"sm",fontWeight:"normal",letterSpacing:"normal",color:"gray.500",noOfLines:1,children:l.title||(0,F.jsx)(i.cC,{id:"wja8aL"})})]}),(0,F.jsx)(J.o,{}),(0,F.jsx)(c.i,{}),(0,F.jsx)(b.f,{children:(0,F.jsxs)(k.xu,{children:[(0,F.jsx)(no,{user:A}),void 0!==C&&(0,F.jsx)(eW,{description:(0,F.jsx)(i.cC,{id:"YJOrjl",values:{cardsViewed:y,totalCards:C}})}),v&&!g&&(0,F.jsx)(eU,{includeDescription:!0}),g&&(0,F.jsx)(V,{error:g,refetch:j,px:0}),!g&&!v&&(0,F.jsx)(ez,{cards:f.tree,scaleToMax:!0,includeChildren:!0,leftLabel:(0,F.jsx)(i.cC,{id:"ml51m3"}),rightLabel:(0,F.jsx)(i.cC,{id:"8R7bfR"}),cardLookupTable:w,tooltipLabel:(0,F.jsx)(eZ,{}),onAnalyticsPanelClose:d}),(0,F.jsxs)(E.b,{children:[(0,F.jsx)(G.z,{}),(0,F.jsx)(i.cC,{id:"Znuvj3",values:{GAMMA_PROPER_NOUN:e3.N6,GAMMA_ARTIFACT_PROPER_NOUN:e3.Yc}})]})]})})]})},nQ=function(e){var n=e.doc,t=e.mode,m=e.isAnalyticsPanelOpen,g=e.onAnalyticsPanelClose,v=e.onSharePanelOpen,j=(0,x.i)({base:"sm",md:"2xl",lg:"4xl"}),b=(0,h.useCallback)(function(){v&&(v(),g())},[v,g]);return(0,F.jsx)(p.Wk,{isDark:!1,children:(0,F.jsxs)(o.u_,{onClose:g,isOpen:m,size:j,blockScrollOnMount:!1,children:[(0,F.jsx)(s.Z,{}),(0,F.jsxs)(a.h,{children:["full"===t?(0,F.jsx)(nB,{doc:n,handleSharePanelOpen:b,onAnalyticsPanelClose:g}):(0,F.jsx)(nJ,{doc:n,onAnalyticsPanelClose:g}),(0,F.jsx)(c.i,{my:4}),(0,F.jsx)(l.m,{children:(0,F.jsxs)(d.k,{justifyContent:"full"===t?"space-between":"flex-end",flex:1,children:["full"===t&&(0,F.jsx)(u.z,{leftIcon:(0,F.jsx)(f.G,{icon:r.zB}),variant:"ghost",onClick:b,children:(0,F.jsx)(i.cC,{id:"IXzWG0"})}),(0,F.jsx)(u.z,{variant:"solid",onClick:g,children:(0,F.jsx)(i.cC,{id:"DPfwMq"})})]})})]})]})})}},87796:function(e,n,t){t.d(n,{U:function(){return i},V:function(){return o}});var r=t(95148),i=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n?e||"Untitled":e?"".concat(e," | Gamma"):"Gamma"},o=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e||(n?"":r.D)}},21061:function(e,n,t){t.d(n,{Av:function(){return S},U8:function(){return k}});var r=t(95235),i=t(393),o=t(11919),s=t(2784),a=t(43997),c=t(58118),l=t(46358),d=t(13720),u=t(72043),f=t(53738),p=t(12436),h=t.n(p),x=t(73062),m=t(52322);function g(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function v(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?g(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var j=function(e){var n=e.setWidth,t=e.width,r=e.position,i=e.onClose,a=e.panelRef,l=e.initialWidth,d=e.isDragging,u=e.setIsDragging,p=(0,s.useMemo)(function(){return(0,x.n)()},[])>0&&"right"===r,g=(0,s.useState)(t),j=g[0],b=g[1],y=(0,s.useState)(null),C=y[0],O=y[1],w=h()(function(e){var n,t=Math.min(Math.max(n="left"===r?e.clientX:-((e.clientX-C)*1)+j,c.pn),c.ZQ);n<=c.Nh?(a.current.style.transitionProperty="width",a.current.style.transitionDuration="var(--chakra-transition-duration-normal)",t=0):t>c.pn&&(a.current.style.transitionProperty="",a.current.style.transitionDuration=""),a.current.style.width="".concat(t,"px")},30),k=function e(){u(!1),O(null);var t=a.current.style.width;"0px"===t?(i(),n(l)):n(parseInt(t.replace("px",""),10)),a.current.style.transitionProperty="",a.current.style.transitionDuration="",window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",e)};(0,s.useEffect)(function(){return C&&(window.addEventListener("mousemove",w),window.addEventListener("mouseup",k)),function(){window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",k)}},[C]);var S={};return S="left"===r?{right:-4,position:"absolute"}:p?{position:"relative"}:{left:-4,position:"absolute"},(0,m.jsx)(o.k,v(v({h:"100%",bg:p?"gray.200":d?"blackAlpha.200":"rgba(0,0,0,0)",w:p?2:4,justifyContent:"center",alignItems:"center",cursor:"col-resize",_hover:{bg:p?"gray.400":"blackAlpha.200"},transitionProperty:"common",transitionDuration:"normal",role:"group",onMouseDown:function(e){e.preventDefault(),u(!0),O(e.clientX),b(t)},position:"absolute",display:["none","none","none","flex"]},S),{},{children:!p&&(0,m.jsx)(f.xu,{bg:"white",borderRadius:"full",w:1,h:10,opacity:d?1:".5",transitionProperty:"common",transitionDuration:"normal",_groupHover:{opacity:1}})}))},b=t(59115);function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var O={ifPanelHasRoomToOpen:function(e,n){return{base:n,xl:e}}},w=function(e){var n,t=e.position,f=e.panelLifecycle,p=(0,s.useRef)(),h=(0,s.useState)(!1),x=h[0],g=h[1],v=(0,a.I0)(),y=(0,l.CG)((0,b.SL)(t)),w=(0,l.CG)((0,b.Fw)(t)),k=(0,l.CG)((0,b.CO)(t)),S=(0,l.CG)((0,b.eh)(t)),E=null!==(n=null==S?void 0:S.canCollapse)&&void 0!==n&&n,I=(0,s.useCallback)(function(){v((0,b.sR)({position:t}))},[v,t]),P=(0,s.useCallback)(function(){v((0,b.Yp)({component:S}))},[S,v]),D=(0,s.useCallback)(function(e){v((0,b.UG)({width:e,position:t})),f.emit("resize",{})},[v,f,t]),A=(0,r.Z)({zIndex:Number((0,i.dQ)("zIndices","overlay"))+1,position:O.ifPanelHasRoomToOpen("relative","fixed"),height:"100%",top:0,bottom:0},t,0);w||x||(A.transitionProperty="width",A.transitionDuration="normal"),(0,s.useEffect)(function(){var e=function(e){"width"===e.propertyName&&f.emit("resize",{})};return p.current.addEventListener("transitionend",e),function(){p.current&&p.current.removeEventListener("transitionend",e)}},[f,p]);var T=(0,d.i)(O.ifPanelHasRoomToOpen(!0,!1))||!1;return(0,s.useEffect)(function(){y&&!T&&E&&I()},[T,y,I,E]),(0,m.jsxs)(o.k,C(C({ref:p},A),{},{style:{width:y||E?k:0},maxW:"100%","data-print-hidden":!0,children:[y&&"right"===t&&(0,m.jsx)(j,{isDragging:x,setIsDragging:g,position:t,width:k,setWidth:D,panelRef:p,onClose:I,initialWidth:c.Ld}),(0,m.jsx)(u.Mn.Provider,{value:f,children:S&&(y||E)&&(0,m.jsx)(S,{isDragging:x,isOpen:y,closePanel:I,openPanel:P,panelRef:p,lifecycle:f,hasRoomToOpen:T})}),y&&"left"===t&&(0,m.jsx)(j,{isDragging:x,setIsDragging:g,position:t,width:k,setWidth:D,panelRef:p,onClose:I,initialWidth:c.X9})]}))},k=(0,s.memo)(function(e){return(0,m.jsx)(w,C({position:"right"},e))});k.displayName="RightPanelContainer";var S=(0,s.memo)(function(e){return(0,m.jsx)(w,C({position:"left"},e))});S.displayName="LeftPanelContainer"},53923:function(e,n,t){t.d(n,{Pp:function(){return d},UV:function(){return l},Xy:function(){return u},nO:function(){return c}});var r=t(2784),i=t(43997),o=t(46358),s=t(72043),a=t(59115),c=function(){return(0,o.CG)((0,a.CO)("left"))},l=function(){return(0,o.CG)((0,a.CO)("right"))},d=function(e){var n=e.panelPosition,t=(0,i.I0)(),s=(0,o.CG)((0,a.OC)(e)),c=(0,r.useCallback)(function(){t((0,a.uJ)({component:e}))},[e,t]);return{togglePanel:(0,r.useCallback)(function(r){var i=!s;(null==r?void 0:r.override)==="open"?i=!0:(null==r?void 0:r.override)==="closed"&&(i=!1),i?t((0,a.Yp)({component:e,disableTransition:!!(null==r?void 0:r.disableTransition)})):t((0,a.sR)({position:n}))},[e,n,s,t]),initPanel:c,isPanelOpen:s}},u=function(){var e=(0,r.useMemo)(function(){return new s.st},[]),n=(0,r.useMemo)(function(){return new s.st},[]),t=(0,r.useMemo)(function(){return new s.st},[]);return(0,r.useEffect)(function(){if(t&&e&&n){var r=e.pipe(t),i=n.pipe(t);return function(){r(),i()}}},[e,n,t]),{leftPanelLifecycle:e,rightPanelLifecycle:n,globalPanelLifecycle:t}}},89458:function(e,n,t){t.d(n,{T:function(){return V}});var r=t(20406),i=t(81333),o=t(28526),s=t.n(o),a=t(55452),c=t(87254),l=t(55479),d=t(75944),u=t(71354),f=t(76360),p=t(75342),h=t(2046),x=t(70287),m=t(8283),g=t(27777),v=t(45650),j=t(55966),b=t(2784),y=t(23313),C=t(20010),O=t(56915),w=t(48273),k=t(92619),S=t(91012),E=t(2167),I=t(80353),P=t(76648),D=t(52322),A=function(e){var n=e.onClose,t=e.domainName,r=e.onDelete,i=e.isDeleting;return(0,D.jsxs)(C.u_,{isOpen:!0,onClose:n,trapFocus:!1,size:"xl",isCentered:!0,closeOnOverlayClick:!1,children:[(0,D.jsx)(O.Z,{}),(0,D.jsxs)(w.h,{children:[(0,D.jsx)(k.x,{children:(0,D.jsx)(u.K,{spacing:0,children:(0,D.jsx)(S.x,{children:(0,D.jsx)(a.cC,{id:"T3exbL",values:{domainName:t}})})})}),(0,D.jsx)(E.f,{children:(0,D.jsx)(u.K,{spacing:4,children:(0,D.jsx)(S.x,{children:(0,D.jsx)(a.cC,{id:"DkFGZj"})})})}),(0,D.jsx)(I.m,{children:(0,D.jsxs)(P.h,{children:[(0,D.jsx)(v.z,{isDisabled:i,variant:"ghost",colorScheme:"gray",onClick:n,children:(0,D.jsx)(a.cC,{id:"dEgA5A"})}),(0,D.jsx)(v.z,{variant:"ghost",colorScheme:"red",isLoading:i,onClick:r,loadingText:c.ag._({id:"EF2EU9"}),children:(0,D.jsx)(a.cC,{id:"cnGeoo"})})]})})]})]})},T=t(12662),R=t(40130),_=t(31145),M=t(4036),L=t(84103),z=t(93319),N=t(67887),Z=t(49929),G=t(42879),F={pending:{tooltip:(0,D.jsx)(a.cC,{id:"/BjVEU"}),badgeText:(0,D.jsx)(a.cC,{id:"bl9677"}),badgeColorScheme:"yellow"},failed:{tooltip:(0,D.jsx)(a.cC,{id:"7Bj3x9"}),badgeText:(0,D.jsx)(a.cC,{id:"7Bj3x9"}),badgeColorScheme:"red"}},U=function(e){var n=e.status,t=e.onClick;if("verified"===n)return null;var r=F[n],i=r.tooltip,o=r.badgeText,s=r.badgeColorScheme;return(0,D.jsx)(j.kH,{label:i,placement:"top",children:(0,D.jsx)(M.C,{display:"flex",justifyContent:"center",colorScheme:s,cursor:t?"pointer":"default",onClick:t||void 0,children:o})})},W=function(e){var n=e.domain,t=e.onDomainSetupClick,o=e.path,d=e.onDeleteClick,u=e.numDomains,h=(0,G.mn)({domain:n,path:o}),x=(0,l.p)(),g="verified"!==n.status||"verified"===n.status&&u>1,C=(0,y.NEQ)(),O=(0,i.Z)(C,1)[0],w=(0,b.useCallback)((0,r.Z)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({variables:{id:n.id}});case 2:x({title:(0,D.jsx)(a.cC,{id:"LIAJwx"}),status:"success",duration:3e3,position:"top",isClosable:!0});case 3:case"end":return e.stop()}},e)})),[O,n.id,x]);return(0,D.jsx)(f.Z,{children:(0,D.jsx)(p.e,{children:(0,D.jsxs)(m.U,{children:["verified"===n.status?(0,D.jsx)(j.kH,{label:h,placement:"top",children:(0,D.jsx)(v.z,{as:L.r,variant:"link",href:h,target:"_blank",rightIcon:(0,D.jsx)(Z.G,{icon:_.faArrowUpRightFromSquare}),children:n.name})}):(0,D.jsx)(S.x,{children:n.name}),(0,D.jsx)(z.L,{}),(0,D.jsx)(U,{status:n.status,onClick:"failed"===n.status?w:null}),(0,D.jsxs)(P.h,{children:[(0,D.jsx)(j.kH,{label:(0,D.jsx)(a.cC,{id:"UqSZMD"}),placement:"top",children:(0,D.jsx)(N.h,{onClick:function(){t(n.name)},"aria-label":c.ag._({id:"UqSZMD"}),size:"sm",variant:"ghost",colorScheme:"blackAlpha",icon:(0,D.jsx)(Z.G,{icon:R.faCircleInfo})})}),g&&(0,D.jsx)(j.kH,{label:(0,D.jsx)(a.cC,{id:"C2YqXi"}),placement:"top",children:(0,D.jsx)(N.h,{onClick:function(){d(null==n?void 0:n.id)},"aria-label":c.ag._({id:"C2YqXi"}),size:"sm",variant:"ghost",colorScheme:"red",icon:(0,D.jsx)(Z.G,{icon:T.faTrashCan})})})]})]})})})},H=t(34860),V=function(e){var n,t=e.site,o=e.path,C=e.onDomainSetupClick,O=e.onAddDomain,w=e.isAddingDomain,k=e.refetchSites,S=(0,l.p)(),E=(0,b.useState)(),I=E[0],P=E[1],T=(0,b.useState)(""),R=T[0],_=T[1],M=(0,d.q)({id:"delete-domain-modal"}),L=M.isOpen,z=M.onOpen,N=M.onClose,Z=t.domains.find(function(e){return e.id===I}),F=(0,G.m6)(R),U=(0,y.Yqv)(),V=(0,i.Z)(U,2),B=V[0],q=V[1].loading,K=(0,b.useState)(void 0),Y=K[0],J=K[1];(0,H.vm)(function(){I?J(null==Z?void 0:Z.name):J(void 0)},[I,null==Z?void 0:Z.name],[I]);var Q=(0,b.useCallback)(function(){N(),P(function(){})},[N]),X=(0,b.useCallback)((0,r.Z)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Z){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,B({variables:{id:I}});case 4:return e.next=6,k();case 6:S({title:(0,D.jsx)(a.cC,{id:"V4fbcv",values:{0:Z.name}}),status:"success",duration:3e3,position:"top",isClosable:!0}),Q();case 8:case"end":return e.stop()}},e)})),[k,B,I,Z,Q,S]);return(0,D.jsxs)(u.K,{spacing:4,children:[(0,D.jsx)(f.Z,{variant:"filled",children:(0,D.jsx)(p.e,{children:(0,D.jsxs)(u.K,{spacing:4,children:[(0,D.jsxs)(h.NI,{children:[(0,D.jsx)(x.l,{children:(0,D.jsx)(a.cC,{id:"AZ4xlc"})}),(0,D.jsxs)(m.U,{children:[(0,D.jsx)(g.I,{bg:"white",placeholder:(null==t?void 0:null===(n=t.domains)||void 0===n?void 0:n.length)?c.ag._({id:"B6e4xs"}):c.ag._({id:"1y9z1r"}),value:R,onChange:function(e){return _(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&F&&(e.preventDefault(),O(R),_(""))}}),(0,D.jsx)(u.K,{children:(0,D.jsx)(j.kH,{label:(0,D.jsx)(a.cC,{id:"aUB5ST"}),placement:"top",shouldWrapChildren:!0,isDisabled:F,children:(0,D.jsx)(v.z,{isDisabled:!F,variant:"plain",onClick:function(){O(R),_("")},isLoading:w,children:(0,D.jsx)(a.cC,{id:"EdEpYN"})})})})]})]}),t.domains.map(function(e){return(0,D.jsx)(W,{domain:e,onDomainSetupClick:C,path:o,onDeleteClick:function(e){P(e),z()},numDomains:t.domains.length||0},e.id)})]})})}),L&&(0,D.jsx)(A,{onClose:Q,onDelete:X,domainName:Y,isDeleting:q})]})}},74995:function(e,n,t){t.d(n,{w:function(){return W}});var r,i=t(60697),o=t(55452),s=t(55479),a=t(20010),c=t(56915),l=t(48273),d=t(92619),u=t(64827),f=t(2167),p=t(76360),h=t(75342),x=t(71354),m=t(91012),g=t(11919),v=t(45650),j=t(8283),b=t(40110),y=t(74642),C=t(73851),O=t(36258),w=t(19875),k=t(35319),S=t(27912),E=t(72360),I=t(48322),P=t(35837),D=t(58499),A=t(80353),T=t(49929),R=t(55966),_=t(2784),M=t(34860),L=t(85041),z=t(20406),N=t(28526),Z=t.n(N),G=t(42879),F=(r=(0,z.Z)(Z().mark(function e(n){var t,r,i,o,s;return Z().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/domains/connectToken").then(function(e){return e.json()}).then(function(e){if(!e.auth_token)throw Error("No auth token returned");return e.auth_token});case 2:if(t=e.sent,window.entri){e.next=5;break}throw Error("Entri not found");case 5:return i=(r=(0,G.Yd)(n)).domain,o=r.dnsRecords,console.log("[launchEntri] Launching Entri with config",s={applicationId:"gamma",token:t,prefilledDomain:i,dnsRecords:o}),window.entri.showEntri(s),e.abrupt("return",new Promise(function(e,n){var t=function t(r){console.log("onEntriClose: event",r),window.removeEventListener("onEntriClose",t),r.detail.success?e(r.detail):n(r.detail)};window.addEventListener("onEntriClose",t,!1)}));case 10:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),U=t(52322),W=function(e){var n=e.isOpen,t=e.onClose,r=e.domainName,z=e.onDomainConfirmed,N=(0,_.useState)("initial"),Z=N[0],W=N[1],H=(0,_.useRef)(!1),V=(0,_.useState)(function(){return void 0!==window.entri}),B=V[0],q=V[1],K=(0,_.useState)(!1),Y=K[0],J=K[1],Q=(0,s.p)();(0,M.Gq)(L.oc,{predicate:function(){return void 0===window.entri},onload:function(){q(!0),H.current=!0}});var X=(0,_.useMemo)(function(){return(0,G.Yd)(r||"")},[r]),$=X.dnsRecords,ee=X.isRootDomain,en=X.subdomain;return(0,U.jsx)(R.Wk,{isDark:!1,children:(0,U.jsxs)(a.u_,{isOpen:n,onClose:t,size:"3xl",children:[(0,U.jsx)(c.Z,{}),(0,U.jsxs)(l.h,{children:[(0,U.jsx)(d.x,{children:(0,U.jsx)(o.cC,{id:"xQMU8T",values:{domainName:r}})}),(0,U.jsx)(u.o,{}),(0,U.jsxs)(f.f,{children:["initial"===Z&&(0,U.jsx)(p.Z,{variant:"filled",children:(0,U.jsx)(h.e,{children:(0,U.jsxs)(x.K,{spacing:4,py:4,mx:"auto",children:[(0,U.jsxs)(x.K,{spacing:2,children:[(0,U.jsxs)(x.K,{spacing:1,children:[(0,U.jsx)(m.x,{textAlign:"center",fontSize:"2xl",children:(0,U.jsx)(T.G,{icon:i.g4,size:"lg"})}),(0,U.jsx)(m.x,{fontWeight:"semibold",fontSize:"lg",textAlign:"center",children:(0,U.jsx)(o.cC,{id:"w5l5pM"})})]}),(0,U.jsx)(m.x,{textAlign:"center",maxW:"unset",children:(0,U.jsx)(o.cC,{id:"MhdvBQ"})})]}),(0,U.jsx)(g.k,{align:"center",justify:"center",w:"100%",children:(0,U.jsxs)(x.K,{w:64,maxW:"100%",children:[(0,U.jsx)(v.z,{size:"md",variant:"solid",isDisabled:!B,isLoading:Y,onClick:function(){r&&(J(!0),F(r).then(function(e){console.log("[ENTRI] Successfully setup domain",e),Q({title:(0,U.jsx)(o.cC,{id:"p8Oc6N"}),description:(0,U.jsx)(o.cC,{id:"HqV46b"}),status:"success",duration:3e3,isClosable:!0,position:"top"}),null==z||z(r)}).catch(function(e){Q({title:(0,U.jsx)(o.cC,{id:"l/2jzv"}),description:e.message,status:"error",duration:3e3,isClosable:!0,position:"top"})}).finally(function(){J(!1)}))},children:(0,U.jsx)(o.cC,{id:"qu+sXe"})}),(0,U.jsxs)(j.U,{children:[(0,U.jsx)(b.i,{}),(0,U.jsx)(m.x,{color:"gray.600",children:(0,U.jsx)(o.cC,{id:"BzEFor"})}),(0,U.jsx)(b.i,{})]}),(0,U.jsx)(v.z,{size:"md",variant:"plain",onClick:function(){W("manualSetup")},children:(0,U.jsx)(o.cC,{id:"ANIrop"})})]})})]})})}),"manualSetup"===Z&&(0,U.jsx)(p.Z,{variant:"filled",children:(0,U.jsx)(h.e,{children:(0,U.jsxs)(x.K,{spacing:6,children:[(0,U.jsx)(m.x,{fontWeight:"semibold",fontSize:"lg",children:(0,U.jsx)(o.cC,{id:"L5N7HX"})}),(0,U.jsxs)(y.i,{variant:"simple",children:[(0,U.jsx)(C.h,{children:(0,U.jsxs)(O.Tr,{children:[(0,U.jsx)(w.Th,{children:(0,U.jsx)(o.cC,{id:"6YtxFj"})}),(0,U.jsx)(w.Th,{children:(0,U.jsx)(o.cC,{id:"+zy2Nq"})}),(0,U.jsx)(w.Th,{isNumeric:!0,children:(0,U.jsx)(o.cC,{id:"HKH+W+"})})]})}),(0,U.jsx)(k.p,{children:($||[]).map(function(e){return(0,U.jsxs)(O.Tr,{children:[(0,U.jsx)(S.Td,{fontFamily:"mono",children:e.host}),(0,U.jsx)(S.Td,{fontFamily:"mono",children:e.type}),(0,U.jsx)(S.Td,{isNumeric:!0,fontFamily:"mono",children:e.value})]},e.value)})})]}),(0,U.jsxs)(E.b,{status:"info",colorScheme:"orange",children:[(0,U.jsx)(I.z,{}),(0,U.jsxs)(x.K,{children:[(0,U.jsx)(m.x,{fontWeight:"bold",fontSize:"md",children:(0,U.jsx)(o.cC,{id:"NxHkkp"})}),(0,U.jsxs)(P.GS,{pl:"4",spacing:"2",children:[ee?1===L.Co.length?(0,U.jsx)(P.HC,{children:(0,U.jsx)(o.cC,{id:"YMrXdT",values:{0:L.Co[0]},components:{0:(0,U.jsx)(D.E,{colorScheme:"gray"}),1:(0,U.jsx)(D.E,{colorScheme:"gray"}),2:(0,U.jsx)(D.E,{colorScheme:"gray"})}})}):(0,U.jsx)(P.HC,{children:(0,U.jsx)(o.cC,{id:"FM+LNW",values:{0:L.Co.slice(0,-1).map(function(e){return(0,U.jsx)(D.E,{colorScheme:"gray",children:e},e)}),1:L.Co.slice(-1)[0]},components:{0:(0,U.jsx)(D.E,{colorScheme:"gray"}),1:(0,U.jsx)(j.U,{display:"inline",divider:(0,U.jsx)("span",{children:", "})}),2:(0,U.jsx)(D.E,{colorScheme:"gray"}),3:(0,U.jsx)(D.E,{colorScheme:"gray"})}})}):null,(0,U.jsx)(P.HC,{children:(0,U.jsx)(o.cC,{id:"Jmb6Yp",values:{subdomain:en,GAMMA_SITES_HOST:L.ax},components:{0:(0,U.jsx)(D.E,{colorScheme:"gray"}),1:(0,U.jsx)(D.E,{colorScheme:"gray"}),2:(0,U.jsx)(D.E,{colorScheme:"gray"})}})})]})]})]}),z&&(0,U.jsxs)(j.U,{justifyContent:"space-between",children:[(0,U.jsx)(v.z,{variant:"plain",onClick:function(){return W("initial")},children:(0,U.jsx)(o.cC,{id:"iH8pgl"})}),(0,U.jsx)(v.z,{variant:"solid",onClick:function(){t(),null==z||z(r)},size:"md",mx:"auto",children:(0,U.jsx)(o.cC,{id:"RyhVuk"})})]})]})})})]}),(0,U.jsx)(A.m,{})]})]})})}},97873:function(e,n,t){t.d(n,{q:function(){return w}});var r=t(95235),i=t(20406),o=t(81333),s=t(31145),a=t(76035),c=t(28526),l=t.n(c),d=t(55452),u=t(55479),f=t(53738),p=t(8283),h=t(91012),x=t(45650),m=t(97907),g=t(49929),v=t(2784),j=t(21010),b=t(42879),y=t(52322);function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function O(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var w=function(e){var n,t,r,c,C=e.doc,w=e.site,k=e.path,S=(0,u.p)(),E=(0,j.sIg)(),I=(0,o.Z)(E,1)[0],P=(0,j.sR8)(),D=(0,o.Z)(P,1)[0],A=(0,j.odt)(),T=(0,o.Z)(A,1)[0],R=(0,j.L24)(),_=(0,o.Z)(R,1)[0],M=(0,j.kui)(),L=(0,o.Z)(M,2),z=L[0],N=L[1].loading,Z=(0,j.V$$)(),G=(0,o.Z)(Z,2),F=G[0],U=G[1].loading,W=null==C?void 0:C.id,H=null==C?void 0:null===(r=C.organization)||void 0===r?void 0:r.id,V=(0,b.mn)({domain:null==w?void 0:null===(c=w.domains)||void 0===c?void 0:c[0],path:k}),B=null==w?void 0:w.id;return{publishAndDeploy:(0,v.useCallback)((0,i.Z)(l().mark(function e(){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(W){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,b.iL)(W);case 4:return e.next=6,I({variables:{id:W},update:function(e,n){var t=n.data,r=null==t?void 0:t.publishDoc;r&&e.updateQuery({query:j.yE1,variables:{id:r.id}},function(e){var n;return(e||console.log("%c Publish doc _data is undefined or null","color: red; font-size: 16px"),null!=e&&e.doc)?{doc:O(O({},e.doc),{},{publishedTime:r.publishedTime,publishedSnapshotId:null===(n=r.publishedSnapshot)||void 0===n?void 0:n.id})}:e})}}).then(function(){return D({variables:{siteId:null==w?void 0:w.id}})}).then(function(){S({render:function(){return(0,y.jsx)(f.xu,{color:"white",p:3,bg:"green.500",shadow:"md",borderRadius:"md",children:(0,y.jsxs)(p.U,{spacing:4,children:[(0,y.jsx)(f.xu,{children:(0,y.jsx)(g.G,{icon:a.faCircleCheck})}),(0,y.jsx)(h.x,{fontWeight:"semibold",children:"Your changes have been published."}),V&&(0,y.jsx)(x.z,{variant:"plain",as:"a",target:"_blank",_hover:{textDecoration:"none",color:"trueblue.500"},href:V,rightIcon:(0,y.jsx)(g.G,{icon:s.faArrowUpRightFromSquare}),children:"View site"}),(0,y.jsx)(m.P,{onClick:function(){return S.closeAll()}})]})})},status:"success",position:"top",duration:5e3,isClosable:!0})}).catch(function(e){S({title:(0,y.jsx)(d.cC,{id:"DD5mqk"}),status:"error",position:"top",isClosable:!0}),console.error("Error publishing site:",e.message)});case 6:case"end":return e.stop()}},e)})),[W,I,D,null==w?void 0:w.id,S,V]),addDomain:(0,v.useCallback)((n=(0,i.Z)(l().mark(function e(n){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!B||!W)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,z({variables:{input:{siteId:B,name:n}},refetchQueries:["GetSites","GetDoc"]});case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),console.error("Error adding domain:",e.t0),S({status:"error",title:(0,y.jsx)(d.cC,{id:"HugOMA"}),isClosable:!0,position:"top"});case 11:case"end":return e.stop()}},e,null,[[2,7]])})),function(e){return n.apply(this,arguments)}),[z,W,B,S]),isAddingDomain:N,createSite:(0,v.useCallback)((t=(0,i.Z)(l().mark(function e(n){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(W){e.next=2;break}return e.abrupt("return");case 2:F({variables:{input:{workspaceId:H,name:n,domains:[{name:n}],routes:[]}},refetchQueries:["GetSites","GetDoc"]}).catch(function(e){console.error("Error creating site:",e.message)});case 3:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),[W,H,F]),isCreatingSite:U,unpublishAndDeploy:(0,v.useCallback)((0,i.Z)(l().mark(function e(){var n;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!B||!W)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,_({variables:{id:W},update:function(e,n){var t=n.data,r=null==t?void 0:t.unpublishDoc;r&&e.updateQuery({query:j.yE1,variables:{id:r.id}},function(e){return null!=e&&e.doc?{doc:O(O({},e.doc),{},{publishedSnapshotId:null})}:e})}}).then(function(){return T({variables:{input:{siteId:B,routes:(0,b.kj)({docId:W,routes:(null==w?void 0:w.routes)||[],path:null})}}})}).then(function(){return D({variables:{siteId:null==w?void 0:w.id}})}).then(function(){S({description:null!=w&&w.name?(0,y.jsx)(d.cC,{id:"Qv0Wgn",values:{0:null==w?void 0:w.name}}):(0,y.jsx)(d.cC,{id:"3fkTmP"}),status:"success",position:"top",duration:5e3,isClosable:!0})}).catch(function(e){S({title:(0,y.jsx)(d.cC,{id:"uMOlnl"}),status:"error",position:"top",isClosable:!0}),console.error("Error unpublishing site:",e.message)});case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}},e)})),[B,W,_,null==w?void 0:w.routes,null==w?void 0:w.id,null==w?void 0:w.name,T,D,S]),updateRoutes:(0,v.useCallback)((0,i.Z)(l().mark(function e(){var n;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!W||!B)){e.next=2;break}return e.abrupt("return");case 2:return n=(0,b.kj)({routes:(null==w?void 0:w.routes)||[],docId:W,path:k}),e.next=5,T({variables:{input:{siteId:B,routes:n}}});case 5:case"end":return e.stop()}},e)})),[T,W,null==w?void 0:w.routes,B,k])}}},18066:function(e,n,t){t.d(n,{y:function(){return R}});var r=t(2885),i=t(49626),o=t(55452),s=t(72360),a=t(48322),c=t(53738),l=t(66724),d=t(18751),u=t(71354),f=t(91012),p=t(93319),h=t(45650),x=t(49929),m=t(2784),g=t(23313),v=t(75085),j=t(53865),b=t(16686),y=t(52322),C=function(e){var n=e.openThemeEditor;return(0,y.jsxs)(u.K,{bg:"gray.100",p:4,textAlign:"left",spacing:4,borderRadius:"md",my:2,children:[(0,y.jsx)(f.x,{textAlign:"center",fontWeight:"700",children:(0,y.jsx)(o.cC,{id:"yNvg2Q"})}),(0,y.jsx)(f.x,{fontSize:"sm",color:"gray.700",children:(0,y.jsx)(o.cC,{id:"qYwzxB"})}),(0,y.jsx)(h.z,{onClick:n,variant:"solid",leftIcon:(0,y.jsx)(x.G,{icon:b.Jy}),"data-testid":"new-theme-button",children:(0,y.jsx)(o.cC,{id:"srRMnJ"})})]})},O=t(3334),w=t(2875),k=t(10710),S=t(95235),E=t(12741),I=t(27440),P=t(76817);function D(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function A(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?D(Object(t),!0).forEach(function(n){(0,S.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var T=function(e){var n=e.themes,t=e.type,r=e.currentTheme,i=e.setTheme,o=e.openThemeEditor,s=e.gridProps;return(0,y.jsx)(I.r,A(A({gap:1,flex:1,my:2,mx:-2},s),{},{children:(0,E.Z)(n).sort(j.qb).map(function(e){return(0,y.jsx)(P.o,{type:t,theme:e,isChecked:e.id===r.id,onEditClick:o,onThemeClicked:i,variant:"ghost"},e.id)})}))},R=function(e){var n=e.currentTheme,t=e.setTheme,b=e.openThemeEditor,S=e.onClose,E=e.showEditBackgroundButton,I=e.gridProps,P=void 0===I?{templateColumns:{base:"repeat(2, 1fr)"}}:I,D=(0,k.SE)().currentWorkspace,A=(0,g.BCl)({variables:{workspaceId:null==D?void 0:D.id,archived:!1},skip:!D,fetchPolicy:"cache-first",nextFetchPolicy:"cache-only"}),R=A.data,_=A.loading,M=(0,g.BCl)({variables:{workspaceId:null,archived:!1},fetchPolicy:"cache-first",nextFetchPolicy:"cache-only"}),L=M.data,z=M.loading,N=(null==R?void 0:R.themes)||[],Z=(null==L?void 0:L.themes)||[],G=(0,m.useCallback)(function(){b((0,j.QB)(null==L?void 0:L.themes),!0)},[L,b]),F=(null==N?void 0:N.length)>0,U=(0,m.useCallback)(function(){w.pw.emit(w.TI.OPEN_PAGE_SETUP,"background"),null==S||S()},[S]);return(0,y.jsxs)(y.Fragment,{children:[null!=n&&n.archived?(0,y.jsxs)(s.b,{status:"warning",mb:4,children:[(0,y.jsx)(a.z,{}),(0,y.jsxs)(c.xu,{children:[(0,y.jsx)(l.C,{children:(0,y.jsx)(o.cC,{id:"WTUBPK",values:{GAMMA_ARTIFACT_PROPER_NOUN:v.Yc}})}),(0,y.jsx)(d.X,{children:(0,y.jsx)(o.cC,{id:"5iFuNk"})})]})]}):null,(0,y.jsxs)(u.K,{spacing:2,children:[(0,y.jsxs)(u.K,{direction:"row",children:[(0,y.jsx)(f.x,{color:"gray.500",fontWeight:"600",fontSize:"sm",children:(0,y.jsx)(o.cC,{id:"B+0JwP"})}),(0,y.jsx)(p.L,{}),F&&D&&(0,y.jsx)(h.z,{size:"xs",leftIcon:(0,y.jsx)(x.G,{icon:i.r8}),onClick:G,"data-testid":"new-theme-button",children:(0,y.jsx)(o.cC,{id:"FiwgR9"})})]}),_?(0,y.jsx)(O.S,{size:2,gridProps:P}):F?(0,y.jsx)(T,{themes:N,type:"custom",currentTheme:n,setTheme:t,openThemeEditor:b,gridProps:P}):D?(0,y.jsx)(C,{openThemeEditor:G}):null,(0,y.jsxs)(u.K,{pt:2,direction:["column","row"],children:[(0,y.jsx)(f.x,{color:"gray.500",fontWeight:"600",fontSize:"sm",children:(0,y.jsx)(o.cC,{id:"VjG5AF"})}),(0,y.jsx)(p.L,{}),(void 0===E||E)&&(0,y.jsx)(h.z,{size:"xs",leftIcon:(0,y.jsx)(x.G,{icon:r.UH}),onClick:U,children:(0,y.jsx)(o.cC,{id:"+EZioz"})})]}),z?(0,y.jsx)(O.S,{size:4,gridProps:P}):(0,y.jsx)(T,{themes:Z,type:"standard",currentTheme:n,setTheme:t,openThemeEditor:b,gridProps:P})]})]})}},42048:function(e,n,t){t.d(n,{B:function(){return D}});var r=t(55452),i=t(87254),o=t(78116),s=t(56915),a=t(16796),c=t(64827),l=t(92619),d=t(2167),u=t(80353),f=t(45650),p=t(55966),h=t(2784),x=t(95235),m=t(82269),g=t(2046),v=t(70287),j=t(60807),b=t(53738),y=t(34860),C=t(69297),O=t(52322),w=["label","initialValue","updateValue","helperText","language"];function k(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var S=function(e){var n=e.label,r=e.initialValue,i=e.updateValue,o=e.helperText,s=e.language,a=(0,m.Z)(e,w),c=(0,h.useState)(void 0===r?"":r),l=c[0],d=c[1],u=(0,h.useState)(null),f=u[0],p=u[1],S=(0,y.Kt)(i,100),E=(0,h.useState)(),I=E[0],P=E[1];(0,h.useEffect)(function(){"css"===s?Promise.all([t.e(8917),t.e(7120),t.e(6214)]).then(t.bind(t,65284)).then(function(e){P(e.css())}):"html"===s&&Promise.all([t.e(8917),t.e(7120),t.e(6214),t.e(4100),t.e(2163)]).then(t.bind(t,22163)).then(function(e){P(e.html())})},[s]),(0,y.vm)(function(){p(null),S(l)},[l,S],[l]);var D=[I].filter(Boolean);return(0,O.jsxs)(g.NI,{isInvalid:!!f,children:[(0,O.jsx)(v.l,{children:n}),f&&(0,O.jsx)(j.J1,{children:f}),o&&(0,O.jsx)(g.Q6,{children:o}),(0,O.jsx)(b.xu,{border:"1px solid",borderColor:"gray.200",fontSize:"md",position:"relative",children:(0,O.jsx)(h.Suspense,{fallback:(0,O.jsx)("span",{}),children:(0,O.jsx)(C.B,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?k(Object(t),!0).forEach(function(n){(0,x.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({value:l,extensions:D,onChange:d},a))})})]})},E=t(46358),I=t(62141),P=t(21529),D=(0,h.memo)(function(e){var n=e.isOpen,t=e.onClose,x=e.editor,m=(0,P.A)(x),g=(0,E.CG)(I.$p).bodyStart,v=(0,h.useCallback)(function(e){null==x||x.commands.updateNestedAttributesAtPos(0,{customCode:{bodyStart:e}})},[x]);return(0,O.jsx)(p.Wk,{isDark:!1,children:(0,O.jsxs)(o.d,{returnFocusOnClose:!1,isOpen:n,placement:"right",onClose:t,size:"lg",children:[(0,O.jsx)(s.Z,{background:"none"}),(0,O.jsxs)(a.s,{onKeyDown:m,"data-testid":"custom-code-drawer",motionProps:{variants:{enter:{x:"0%",transition:{duration:.2}},exit:{x:"100%",transition:{duration:.1}}}},children:[(0,O.jsx)(c.o,{}),(0,O.jsx)(l.x,{children:(0,O.jsx)(r.cC,{id:"E16GGw"})}),(0,O.jsx)(d.f,{overflowX:"hidden",children:(0,O.jsx)(S,{label:i.ag._({id:"fC5kYg"}),helperText:i.ag._({id:"0AZNtw"}),initialValue:g,updateValue:v,language:"html",height:"600px"})}),(0,O.jsx)(u.m,{children:(0,O.jsx)(f.z,{w:"100%",variant:"solid",onClick:t,children:(0,O.jsx)(r.cC,{id:"DPfwMq"})})})]})]})})});D.displayName="CustomCodeDrawer"},59734:function(e,n,t){t.d(n,{_i:function(){return A._},eT:function(){return X}});var r,i,o,s,a,c=t(95235),l=t(81333),d=t(55452),u=t(55479),f=t(5632),p=t(2784),h=t(23313),x=t(77381),m=t(70204),g=t(46358),v=t(10710),j=t(68941),b=t(69209),y=function(e){var n=(0,g.TL)(),t=(0,v.SE)().currentWorkspace;(0,p.useEffect)(function(){if(e)return j.VH.updateWorkspaceInLdContext(e).then(function(){n((0,b.vH)({isDocWorkspaceSet:!0}))}),function(){j.VH.updateWorkspaceInLdContext(t).then(function(){n((0,b.vH)({isDocWorkspaceSet:!1}))})}},[t,n,e])},C=t(1368),O=t(7328),w=t(57981),k=(0,w.Ps)(r||(r=(0,O.Z)(["\n  fragment DefaultCardFields on Card {\n    id\n    archived\n    docId\n    title\n    text\n    previewUrl\n    createdTime\n    updatedTime\n  }\n"])));(0,w.Ps)(i||(i=(0,O.Z)(["\n  mutation CreateCard($id: ID!, $docId: ID!) {\n    createCard(id: $id, docId: $docId) {\n      id\n    }\n  }\n"]))),(0,w.Ps)(o||(o=(0,O.Z)(["\n  ","\n  query GetCard($id: ID!, $docId: ID!) {\n    card(id: $id, docId: $docId) {\n      ...DefaultCardFields\n    }\n  }\n"])),k),(0,w.Ps)(s||(s=(0,O.Z)(["\n  ","\n  query GetCards($docId: ID!) {\n    docCards(docId: $docId, archived: false) {\n      ...DefaultCardFields\n    }\n  }\n"])),k);var S=(0,w.Ps)(a||(a=(0,O.Z)(["\n  ","\n  subscription SubscribeToCards($docId: ID!) {\n    docCards(docId: $docId) {\n      ...DefaultCardFields\n    }\n  }\n"])),k),E=t(93589),I=t(51823),P=t(61701),D=t(68197),A=t(46732),T=t(75944),R=t(46988),_=t(20010),M=t(56915),L=t(48273),z=t(92619),N=t(64827),Z=t(2167),G=t(71354),F=t(91012),U=t(80353),W=t(76648),H=t(45650),V=t(52322),B=t(29677),q=function(e){var n,t=(null===(n=(0,g.CG)((0,R.oH)(e||"")))||void 0===n?void 0:n.status)==="running",r=(0,p.useRef)(t);r.current=t;var i=(0,p.useState)(function(){return new B.B}),o=i[0],s=i[1],a=(0,p.useCallback)(function(){o.resolve()},[o]),c=(0,T.q)(),l=c.isOpen,d=c.onOpen,u=c.onClose;return{confirmNavigationFn:(0,p.useCallback)(function(){if(!r.current)return Promise.resolve();var e=new B.B;return s(e),d(),e.promise},[d]),confirmNavigationModalProps:{isOpen:l,onClose:u,onConfirm:a}}},K=function(e){var n=e.isOpen,t=e.onClose,r=e.onConfirm;return(0,V.jsxs)(_.u_,{onClose:t,isOpen:n,isCentered:!0,children:[(0,V.jsx)(M.Z,{}),(0,V.jsxs)(L.h,{children:[(0,V.jsx)(z.x,{children:(0,V.jsx)(d.cC,{id:"YeK6T+"})}),(0,V.jsx)(N.o,{}),(0,V.jsx)(Z.f,{children:(0,V.jsxs)(G.K,{spacing:4,children:[(0,V.jsx)(F.x,{fontWeight:"bold",children:(0,V.jsx)(d.cC,{id:"Wr6Y7m"})}),(0,V.jsx)(F.x,{children:(0,V.jsx)(d.cC,{id:"n0Fn6S"})})]})}),(0,V.jsx)(U.m,{children:(0,V.jsxs)(W.h,{children:[(0,V.jsx)(H.z,{variant:"ghost",onClick:t,children:(0,V.jsx)(d.cC,{id:"dEgA5A"})}),(0,V.jsx)(H.z,{variant:"ghost",color:"red.600",onClick:r,children:(0,V.jsx)(d.cC,{id:"QxM8i/"})})]})})]})]})};function Y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function J(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Y(Object(t),!0).forEach(function(n){(0,c.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Y(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Q=function(e){var n=e.children,t=(0,u.p)(),r=(0,v.we)(),i=(0,g.CG)(D.XV),o=(0,v.SE)(),s=o.user,a=o.userStatus,c=(0,p.useRef)(null),j=(0,g.TL)(),b=(0,f.useRouter)(),O=b.push,w=b.replace,k=(0,g.CG)(D.yx),T=(0,I.NO)(),R=(0,l.Z)(T,3),_=R[0],M=R[1],L=R[2],z=M&&M.match(I.sg),N=z?z[0]:null,Z=q(N),G=Z.confirmNavigationFn,F=Z.confirmNavigationModalProps,U=(0,p.useState)({isUnauthorized:void 0,setCollaborativeEditorInstance:function(e){c.current=e,H(function(n){return J(J({},n),{},{editor:e})})},getCollaborativeEditorInstance:function(){return c.current},confirmNavigation:G,editor:void 0}),W=U[0],H=U[1];(0,x.ts)(k),y(null==k?void 0:k.organization);var B=(0,h.WMx)({variables:{id:N},returnPartialData:!0,nextFetchPolicy:"cache-only"}),Y=(0,l.Z)(B,2),Q=Y[0],X=Y[1],$=X.data,ee=X.loading,en=X.called,et=X.subscribeToMore,er=(0,v.py)("view",null==$?void 0:$.doc);(0,v.$K)(Q),(0,p.useEffect)(function(){if(et&&W.docId&&en)return et({document:P.dU,variables:{id:W.docId},updateQuery:function(e,n){var t=n.subscriptionData;return t.data&&t.data.doc&&e.doc?{doc:J(J(J({},e.doc),t.data.doc),{},{__typename:"Doc"})}:e}})},[W.docId,et,en]);var ei=(0,h.WBF)({variables:{docId:N},returnPartialData:!0,nextFetchPolicy:"cache-only"}),eo=(0,l.Z)(ei,2),es=eo[0],ea=eo[1],ec=ea.data,el=ea.called,ed=ea.subscribeToMore;return((0,m.p)(null==ec?void 0:ec.docCards,W.editor),(0,p.useEffect)(function(){if(ed&&W.docId&&el)return ed({document:S,variables:{docId:W.docId},updateQuery:function(e,n){var t=n.subscriptionData;return t.data&&t.data.docCards?t.data:e}})},[W.docId,ed,el]),(0,p.useEffect)(function(){if(W.docId!==N&&M){if(!N){t({id:"invalid_doc_id_error",title:(0,V.jsx)(d.cC,{id:"742lf1"}),description:"",status:"error",position:"top",isClosable:!1,duration:null});return}Q(),es(),H(function(e){return J(J({},e),{},{docId:N})})}},[W.docId,M,N,Q,es,j,t]),(0,p.useEffect)(function(){if("loading"!==a&&en&&!ee&&M){if(!$||!$.doc||!1===er){"loggedOut"===a&&O("/signin?redirect_to=".concat(encodeURIComponent(window.location.href))),H(function(e){return J(J({},e),{},{isUnauthorized:!0})});return}if(!i&&$.doc.archived){w("/");return}H(function(e){return!1===e.isUnauthorized?e:J(J({},e),{},{isUnauthorized:!1})}),j((0,D.pl)({doc:$.doc}))}},[r,er,$,ee,M,en,i,a,O,j,w,s]),(0,p.useEffect)(function(){return function(){j((0,D.mc)())}},[j]),(0,p.useEffect)(function(){if(k&&N){var e="".concat(k.title?"".concat((0,E.lV)(k.title),"-"):"").concat(N);M!==e&&(0,C.lO)({pathname:"".concat(_,"/").concat(e).concat(L||""),emitChange:!1})}},[k,N,M,_,L]),W.docId)?(0,V.jsxs)(A.r.Provider,{value:W,children:[n,(0,V.jsx)(K,J({},F))]}):(0,V.jsx)(V.Fragment,{})};function X(e){return(0,p.memo)(function(n){return(0,V.jsx)(Q,{children:(0,V.jsx)(e,J({},n))})})}},30174:function(e,n,t){t.d(n,{m:function(){return s}});var r=t(11919);t(2784);var i=t(1153),o=t(52322),s=function(e){var n=e.children;return(0,o.jsxs)(r.k,{alignSelf:"stretch",position:"relative",height:"var(--100vh)",direction:"column",children:[(0,o.jsx)(i.Y,{}),n]})}},1005:function(e,n,t){t.d(n,{m:function(){return F}});var r=t(81333),i=t(55452),o=t(87254),s=t(11919),a=t(53738),c=t(94659),l=t(36895),d=t(50390),u=t(91012),f=t(55966),p=t(2784),h=t(23313),x=t(43602),m=t(9846),g=t(46358),v=t(80318),j=t(6010),b=t(62141),y=t(10710),C={src:"/_next/static/media/Sal-Fishing-2x.1a2d0290.png"},O=t(81188),w=t(83906),k=t(9088),S=t(30893),E=t(45650),I=t(40771),P=t(63849),D=t(2575),A=t(97907),T=t(65903),R=t.n(T),_=t(52322),M=function(e){var n=e.count,t=e.onClose,r=e.commentStatusFilter,a=e.setCommentStatusFilter,c=r===h.Ux9.Open?o.ag._({id:"Kz1TxG"}):o.ag._({id:"kywJax"});return(0,_.jsxs)(s.k,{width:"100%",px:6,py:4,justifyContent:"space-between",alignItems:"center",h:16,tabIndex:0,outline:"none",children:[(0,_.jsx)(d.X,{size:"md",flex:1,noOfLines:1,children:(0,_.jsx)(i.cC,{id:"eiUA4k",values:{count:n}})}),(0,_.jsxs)(k.v,{closeOnSelect:!0,children:[(0,_.jsx)(S.j,{as:E.z,size:"sm",rightIcon:(0,_.jsx)(w.v,{}),mr:8,children:R()(c)}),(0,_.jsx)(I.q,{zIndex:3,children:(0,_.jsxs)(P._,{defaultValue:r,title:o.ag._({id:"0cVgUw"}),type:"radio",children:[(0,_.jsx)(D.i,{onClick:function(){return a(h.Ux9.Open)},value:"open",children:(0,_.jsx)(i.cC,{id:"1TNIig"})}),(0,_.jsx)(D.i,{onClick:function(){return a(h.Ux9.Closed)},value:"closed",children:(0,_.jsx)(i.cC,{id:"D87pha"})})]})})]}),(0,_.jsx)(A.P,{position:"absolute",top:2,right:2,onClick:t,"data-comment-feed-close-button":!0})]})},L=t(95235),z=t(50350);function N(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?N(Object(t),!0).forEach(function(n){(0,L.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var G=function(e){var n=e.user,t=e.editor,r=(0,p.useState)(function(){var e=(0,v.W1)(t,z.Et);return e&&e.length?e[0]:(0,v.xN)(function(){return z.Et},t,"")}),i=r[0],o=r[1];(0,p.useEffect)(function(){if(i&&t)return function(){var e,n;null===(e=(n=t.commands).createDraftComment)||void 0===e||e.call(n,i)}},[i,t]);var s=(0,v.iZ)({draftComment:i,clearDraftComment:function(){i&&(null===(r=(s=t.commands).removeDraftComments)||void 0===r||r.call(s,[i]));var e,n,r,s,a=(0,v.xN)(function(){return z.Et},t,"");null===(e=(n=t.commands).createDraftComment)||void 0===e||e.call(n,a),o(a)},editor:t}),a=(0,p.useCallback)(function(e){var n=e.editor;o(function(e){return e?Z(Z({},e),{},{json:n.view.state.doc.toJSON(),text:n.view.state.doc.textContent}):e})},[]);return(0,_.jsx)(v.Ag,{draftComment:i,user:n,onCommentDraftUpdate:a,onCommentSave:s,commentIdToHighlight:null})},F=function(e){var n,t=e.onClose,w=e.editor,k=(0,g.CG)(b.yx),S=(0,h.$gs)().isConnected,E=(0,p.useState)(h.Ux9.Open),I=E[0],P=E[1],D=null==k?void 0:k.comments,A=null==k?void 0:null===(n=k.comments)||void 0===n?void 0:n.filter(function(e){return e.status===I}),T=(0,g.CG)(b.gh),R=(0,y.py)("comment",k)&&S,L=(0,y.SE)().user,z=(0,x.$m)(k,L),N=(0,p.useMemo)(function(){return(0,O.yd)({items:A||[],sortBy:O.Yz,latestTimeGetterFn:O.z3})},[A]);return D&&k&&w?(0,_.jsxs)(s.k,{direction:"column",h:"100%",overflowX:"hidden",className:j.G,w:"100%",children:[(0,_.jsx)(M,{commentStatusFilter:I,setCommentStatusFilter:P,count:(null==A?void 0:A.length)||0,onClose:t}),(0,_.jsxs)(s.k,{direction:"column",className:"comments-list",flex:1,overflowY:"auto",tabIndex:0,outline:"none",children:[(0,_.jsx)(m.V,{label:(0,_.jsx)(i.cC,{id:"pQvCbR"}),isConnected:S,mx:6}),z&&!L&&k&&(0,_.jsx)(v.IZ,{doc:k,accessLink:z}),R&&(0,_.jsx)(a.xu,{px:6,py:2,children:(0,_.jsx)(G,{user:L,editor:w})}),!(null!=A&&A.length)&&(0,_.jsxs)(c.g,{align:"center",p:6,textAlign:"center",spacing:8,children:[(0,_.jsx)(a.xu,{w:"80%",maxW:"300px",mb:6,alignContent:"center",children:(0,_.jsx)(l.E,{src:C.src,width:"640px",alt:"Sal, the Gamma mascot, fishing extraterrestrially"})}),(0,_.jsxs)(a.xu,{children:[(0,_.jsx)(d.X,{size:"xs",mb:2,children:"open"===I?(0,_.jsx)(i.cC,{id:"W7i5f5"}):(0,_.jsx)(i.cC,{id:"mpDN1V"})}),(0,_.jsx)(u.x,{fontSize:"sm",children:(0,_.jsx)(i.cC,{id:"iB9OEi"})})]})]}),Object.entries(N).filter(function(e){return(0,r.Z)(e,2)[1].length}).map(function(e){var n=(0,r.Z)(e,2),i=n[0],a=n[1];return(0,_.jsxs)(s.k,{direction:"column",children:[(0,_.jsx)(f.NZ,{px:6,pt:4,pb:2,position:"sticky",top:-2,bg:"white",zIndex:2,children:{today:o.ag._({id:"ecUA8p"}),thisWeek:o.ag._({id:"yByRxz"}),earlier:o.ag._({id:"HPqZkW"})}[i]}),(0,_.jsx)(s.k,{direction:"column",children:a.map(function(e){return(0,_.jsx)(v.q5,{instanceType:"feed",userCanComment:R,editor:w,comment:e,selfUser:L,docId:null==k?void 0:k.id,editorMode:T,onClose:t,isRootComment:!0,pt:6,px:6,pb:4},e.id)})})]},i)})]})]}):null}},80405:function(e,n,t){t.d(n,{s:function(){return x}});var r=t(95235),i=t(82269),o=t(2784),s=t(56692),a=t(76903),c=t(2875),l=t(46732),d=t(1005),u=t(52322),f=["closePanel"];function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function h(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var x=function(e){var n=e.closePanel,t=(0,i.Z)(e,f),r=(0,l._)().editor;return(0,o.useEffect)(function(){var e=function(e){e.open&&n()};return c.pw.on(c.TI.POPUP_COMMENT_TOGGLED,e),function(){c.pw.on(c.TI.POPUP_COMMENT_TOGGLED,e)}},[n]),(0,o.useEffect)(function(){return s.F7.on("keydown","COMMENT_FEED_PANEL",function(e){return!!document.activeElement.closest('[data-panelid="comment-feed-panel"]')&&("Escape"===e.key&&n(),!0)})},[n]),(0,u.jsx)(a.s,h(h({},t),{},{bgColor:"white","data-panelid":"comment-feed-panel",children:(0,u.jsx)(d.m,{onClose:n,editor:r})}))};x.panelPosition="right"},28677:function(e,n,t){t.d(n,{Rr:function(){return nV},QK:function(){return nH}});var r,i,o=t(95235),s=t(82269),a=t(11919),c=t(87202),l=t(2784),d=t(98875),u=t(56692),f=t(76903),p=t(46358),h=t(2875),x=t(62141),m=t(46732),g=t(64629),v=t(55452),j=t(71354),b=t(67887),y=t(49929),C=t(55966),O=t(19674),w=t(30341),k=t(32333),S=t(17033),E=t(86733),I=t(36895),P=t(91012),D=t(45650),A=t(72360),T=t(66724),R=t(18751),_=t(88299),M=t(52322),L=function(e){var n=e.onClose;return(0,M.jsxs)(j.K,{flex:1,align:"center",justify:"center",p:6,spacing:6,children:[(0,M.jsx)(I.E,{src:"https://cdn.gamma.app/zc87vhr30n8uf3n/b4b04402416f4ec8b5c1dc24f4c2a3d6/optimized/Sal-Spaceship-Riding.png",px:12}),(0,M.jsx)(_.K,{children:(0,M.jsx)(P.x,{children:(0,M.jsx)(v.cC,{id:"jVQv+Q"})})}),(0,M.jsx)(D.z,{variant:"ghost",colorScheme:"blackAlpha",leftIcon:(0,M.jsx)(y.G,{icon:E.faXmark}),onClick:n,children:(0,M.jsx)(v.cC,{id:"pqZJT2"})})]})},z=function(){return(0,M.jsxs)(A.b,{status:"warning",mt:12,minH:20,flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",borderRadius:"lg",borderWidth:"1px",children:[(0,M.jsx)(T.C,{children:(0,M.jsx)(v.cC,{id:"rvbk/4"})}),(0,M.jsx)(R.X,{children:(0,M.jsx)(v.cC,{id:"XNkIFY"})})]})},N=t(12677),Z=t(87254),G=t(8283),F=t(21891),U=t(25793),W=t(94659),H=t(27191),V=t(68740),B=t(95498),q=t(74586),K=t(24224),Y="40px",J=function(e){var n=e.value,t=e.onChange,r=e.onSubmit,i=e.isLoading,o=e.editor;e.resetMessages,(0,K.F1)(o);var s=o.state,a=s.selection,c=s.doc.textBetween(a.from,a.to,"\n"),d=(0,B.q)().hasEnoughCreditsToChat,u=(0,q.fg)(),f=(0,l.useRef)(null),p=(0,l.useState)(!1),h=p[0],x=p[1],m=a instanceof H.qv,g=a instanceof H.Bs,v=m&&"card"===a.node.type.name,j=a.empty||v?Z.ag._({id:"XrfE9D"}):m?Z.ag._({id:"CsUli9"}):g&&c?Z.ag._({id:"+NPPZN",values:{0:c.length>50?c.slice(0,50)+"...":c}}):Z.ag._({id:"/fY1js"}),O=(0,l.useCallback)(function(){f.current&&(f.current.style.height=Y,f.current.style.height="".concat(f.current.scrollHeight,"px"))},[]);return(0,l.useEffect)(function(){return o.on("selectionUpdate",O),function(){o.off("selectionUpdate",O)}},[o,O]),(0,l.useEffect)(function(){h?O():setTimeout(function(){x(!0),O()},400)},[h,j,O,n]),(0,M.jsxs)(G.U,{align:"end",children:[(0,M.jsx)(F.B,{size:"md",children:(0,M.jsx)(U.g,{"data-gamma-child-tiptap-editor":!0,id:"ai-chat-input",h:Y,minH:Y,ref:f,resize:"none",maxH:h?32:Y,bg:"white",shadow:"md",autoFocus:!0,isDisabled:!d,placeholder:j,value:n,onKeyPress:function(e){"Enter"===e.key&&n.length>0&&!i&&(e.preventDefault(),r())},onChange:function(e){return t(e.target.value)},pr:12})}),(0,M.jsx)(C.kH,{placement:"top",label:(0,M.jsxs)(W.g,{spacing:0,children:[(0,M.jsx)(P.x,{children:"Send request"}),!u&&(0,M.jsxs)(P.x,{color:"gray.400",children:[(0,M.jsx)(V.J,{type:"chatSuggestion",ml:0})," if successful"]}),(0,M.jsx)(C.f2,{shortcut:"Enter"})]}),children:(0,M.jsx)(b.h,{"aria-label":"Send message",isDisabled:!n||i,size:"sm",h:Y,w:Y,variant:"solid",icon:(0,M.jsx)(y.G,{icon:N.Fz,fixedWidth:!0}),onClick:r})})]})},Q=t(67541),X=t(70548),$=t(20406),ee=t(28526),en=t.n(ee),et=t(12483),er=t(69862),ei=t(16034),eo=t(23313),es=t(96412),ea=t(13089),ec=t(41701),el=t(90129),ed=t(29017),eu=t(48200),ef=t(29395),ep=t(64426),eh=t(68941),ex=t(39429),em=t(50265),eg=[new(function(e){(0,el.Z)(s,e);var n,t,r,i=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,eu.Z)(s);if(n){var r=(0,eu.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,ed.Z)(this,e)});function s(e){var n;return(0,es.Z)(this,s),n=i.call(this,e),(0,o.Z)((0,ec.Z)(n),"prompt",void 0),n.prompt=e.prompt,n}return(0,ea.Z)(s,[{key:"runPrompt",value:(t=(0,$.Z)(en().mark(function e(n){var t,r,i,o,s,a,c;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.input,r=n.context,i=n.variables,o=n.trackFns,a=void 0===(s=n.retries)?2:s,e.next=3,(0,ep.I)(t,r.interactionId,{timeout:eh.VH.get("aiRequestTimeouts").basicReply});case 3:if(c=e.sent){e.next=6;break}throw Error("Couldn't get response from prompt");case 6:if(!((0,ex.y)(c)||null!=c&&c.includes("```"))){e.next=11;break}if(!(a<=0)){e.next=9;break}throw new er.eo("Did not receive proper response after retries",{chatMessage:"Sorry, I am having trouble understanding. Could you try asking in a different way?",inputMessage:r.message,resp:c,interactionId:r.interactionId});case 9:return o.trackRequestRetry({interactionId:r.interactionId,retriesRemaining:a,resp:c}),e.abrupt("return",this.runPrompt({input:t,context:r,variables:i,trackFns:o,retries:a-1}));case 11:return e.abrupt("return",c);case 12:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"run",value:(r=(0,$.Z)(en().mark(function e(n){var t,r,i,o,s,a,c,l,d;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.context,r=n.addMessage,i=n.history,o=n.trackFns,s=n.provider,a={message:t.message},c=(0,em.x)(i||[]),l=this.prompt.prepare({variables:a,history:c,params:{provider:s},interactionId:t.interactionId}),e.next=6,this.runPrompt({input:l,context:t,variables:a,trackFns:o,retries:1});case 6:d=e.sent,o.trackRequestComplete({taskContext:t,outputMessage:d}),r({from:"Designer",type:"text",message:d,resp:d,interactionId:t.interactionId});case 9:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})}]),s}(ef.B))({key:"CHAT",description:"A general chat message, or a request that doesn't fit any of the previous categories",classifyExamples:["hi how are you","hdfoho;safjw","help there are bees everywhere","great job!","this looks ugly"],prompt:new ei.V({systemPromptOperation:eo.Run.BasicReplyChatSystem,userPromptOperation:eo.Run.BasicReplyChatUser,variables:["message"],params:{maxTokens:150,temperature:0}})})],ev=function(e){return eg.find(function(n){return n.key===e})},ej=function(e){return!!eg.find(function(n){return n.key===e})},eb=t(12741),ey=t(28248),eC=t(2492),eO=t(49945),ew=t(90399),ek=t(73593),eS=t(9850),eE=t.n(eS),eI=t(41261),eP=t(34264),eD=t(60636),eA=t(43981),eT=function(){function e(n){(0,es.Z)(this,e),(0,o.Z)(this,"type","insert-card"),(0,o.Z)(this,"description",void 0),(0,o.Z)(this,"cardId",void 0),(0,o.Z)(this,"afterCardId",void 0),(0,o.Z)(this,"content",void 0),this.description=n.description,this.cardId=n.cardId,this.afterCardId=n.afterCardId,this.content=n.content}return(0,ea.Z)(e,[{key:"isApplied",value:function(e){return!!(0,eP.Bw)(e,this.cardId)}},{key:"getPreviewJson",value:function(e){var n=e.state.tr;this.transact(e,n);var t=eE()(n.doc.toJSON());return(0,eA.Y0)(t,this.cardId)}},{key:"apply",value:function(e){if(this.isApplied(e)){console.debug("[InsertCardModification] NOT applying modification, card already exists with cardId=".concat(this.cardId),{modification:this});return}var n=e.state.tr;this.transact(e,n),console.debug("[InsertCardModification] Applying modification",{modification:this}),e.view.dispatch(n),(0,eI.YS)({editor:e,cardId:this.cardId})}},{key:"transact",value:function(e,n){var t=(0,eP.Bw)(e,this.afterCardId);if(!t)return null;var r=(0,eA.Fr)(e,this.content),i=t.pos+t.node.nodeSize;n.insert(i,r.content.firstChild);var o=(0,eD.t)(n.doc.resolve(i),1);return n.setSelection(o),{from:i,to:i+n.doc.nodeAt(i).nodeSize}}},{key:"getContentForTracking",value:function(){return this.content}}]),e}(),eR=function(){function e(n){(0,es.Z)(this,e),(0,o.Z)(this,"type","remove-card"),(0,o.Z)(this,"description",void 0),(0,o.Z)(this,"cardId",void 0),this.description=n.description,this.cardId=n.cardId}return(0,ea.Z)(e,[{key:"isApplied",value:function(e){return!(0,eP.Bw)(e,this.cardId)}},{key:"getPreviewJson",value:function(e){return null}},{key:"apply",value:function(e){var n=e.state.tr,t=(0,eP.Bw)(e,this.cardId);t&&(n.delete(t.pos,t.pos+t.node.nodeSize),console.debug("[RemoveCardModification] Applying modification",{modification:this}),e.view.dispatch(n))}},{key:"getContentForTracking",value:function(){return this.cardId}}]),e}(),e_=t(68933),eM=function(e){(0,el.Z)(i,e);var n,t,r=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,eu.Z)(i);if(n){var r=(0,eu.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,ed.Z)(this,e)});function i(){return(0,es.Z)(this,i),r.apply(this,arguments)}return(0,ea.Z)(i,[{key:"getResponseMessages",value:(t=(0,$.Z)(en().mark(function e(n){var t,r,i,o,s,a,c,l,d,u,f,p,h,x,m;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.editor,r=n.context,o=(i=n.response).suggestion,s=i.message,a=i.raw,o){e.next=3;break}throw new er.$D("No card content returned",{interactionId:r.interactionId,resp:a,chatMessage:s||(0,e_.az)(),inputMessage:r.message});case 3:return e.next=5,(0,eC.y)(o);case 5:return c=e.sent.content,l=ew.C2.generate(),d=(0,ek.hx)((0,ek.VA)(t)),u=(0,eO.S)({bodyContent:c.toJSON(),index:1,docFormatKey:d.key,theme:r.editorContext.theme,cardId:l}),p={label:"New card",modification:f=new eT({description:"New Card",content:{type:"json",json:[u]},cardId:l,afterCardId:r.editorContext.card.cardId}),jsonContentPreview:f.getPreviewJson(t)},x={label:"Remove card",modification:h=new eR({description:"Remove card",cardId:l}),jsonContentPreview:h.getPreviewJson(t)},m={from:"Designer",type:"suggestContent",resp:a,message:s||"How about this?",suggestions:[p,x],interactionId:r.interactionId},console.debug("[addCard]",{insert:p,remove:x,message:s,html:o,cardLayout:u,content:c}),e.abrupt("return",{messages:[m],suggestionToApply:p});case 17:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})}]),i}(e_.w6),eL=new ei.V({systemPromptOperation:eo.Run.AddCardSystem,userPromptOperation:eo.Run.AddCardUser,variables:["html","message","outline"],params:{temperature:.7,maxTokens:1e3}}),ez=new eM({key:"ADD_CARD",description:"Add a new card after the current one",classifyExamples:["add a new slide","add a card describing our mission","i want a new section for leadership development","make another card","on a new card compare the two options in a table"],classifyReply:"Ok, I'll start writing a new card...",prompt:eL}),eN=t(46695),eZ=function(){function e(n){(0,es.Z)(this,e),(0,o.Z)(this,"type","set-card-layout"),(0,o.Z)(this,"description",void 0),(0,o.Z)(this,"cardId",void 0),(0,o.Z)(this,"layout",void 0),this.description=n.description,this.cardId=n.cardId,this.layout=n.layout}return(0,ea.Z)(e,[{key:"isApplied",value:function(e){var n=(0,eP.Bw)(e,this.cardId);return n?n.node.attrs.layout===this.layout:(console.error("[SetCardLayoutModification.apply] Could not find card to update: ".concat(this.cardId,", maybe deleted")),!1)}},{key:"getPreviewJson",value:function(e){var n=e.state.tr;this.transact(e,n);var t=eE()(n.doc.toJSON()),r=(0,eA.Y0)(t,this.cardId);return console.debug("[SetCardLayoutModification.getPreviewJson] result",r),r}},{key:"apply",value:function(e){if(this.isApplied(e)){console.debug("[SetCardLayoutModification] NOT applying modification, card already has layout=".concat(this.layout),{modification:this});return}var n=e.state.tr;this.transact(e,n),console.debug("[SetCardLayoutModification] Applying modification",{modification:this}),e.view.dispatch(n),(0,eI.YS)({editor:e,cardId:this.cardId})}},{key:"transact",value:function(e,n){var t=(0,eP.Bw)(e,this.cardId);if(!t){console.error("[SetCardLayoutModification.apply] Could not find card to update: ".concat(this.cardId,", maybe deleted"));return}(0,eN.G)(e,n,t.pos,this.layout)}},{key:"getContentForTracking",value:function(){return this.layout}}]),e}(),eG=function(){return Z.ag._({id:"ppX7+s"})},eF=new(function(e){(0,el.Z)(i,e);var n,t,r=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,eu.Z)(i);if(n){var r=(0,eu.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,ed.Z)(this,e)});function i(){return(0,es.Z)(this,i),r.apply(this,arguments)}return(0,ea.Z)(i,[{key:"getResponseMessages",value:(t=(0,$.Z)(en().mark(function e(n){var t,r,i,o,s,a,c,l,d,u,f;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.editor,r=n.context,n.rangeId,o=(i=n.response).suggestion,s=i.raw,a=i.message,o){e.next=3;break}throw new er.$D("No card layout returned",{resp:s,chatMessage:eG(),inputMessage:r.message,interactionId:r.interactionId});case 3:if((0,eP.ol)(o)){e.next=6;break}throw console.error("Invalid card layout:",o),new er.$D("Invalid card layout: ".concat(o),{resp:s,chatMessage:eG(),inputMessage:r.message,interactionId:r.interactionId});case 6:return c=new eZ({description:Z.ag._({id:"nyQWMb"}),cardId:r.editorContext.card.cardId,layout:o}),l={label:Z.ag._({id:"nyQWMb"}),modification:c,jsonContentPreview:c.getPreviewJson(t)},d=new eZ({description:Z.ag._({id:"HxF6Fk"}),cardId:r.editorContext.card.cardId,layout:r.editorContext.card.attrs.layout}),u={label:Z.ag._({id:"HxF6Fk"}),modification:d,jsonContentPreview:d.getPreviewJson(t)},f={from:"Designer",type:"suggestContent",resp:s,message:a||Z.ag._({id:"pMSbe+"}),interactionId:r.interactionId,suggestions:[l,u]},e.abrupt("return",{messages:[f],suggestionToApply:l});case 12:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})}]),i}(e_.w6))({key:"MOVE_ACCENT_IMAGE",description:"Move or remove the accent image of the card. Use ADD_IMAGE to add accent images.",classifyExamples:["move the sand dune to the left","remove the cover photo"],classifyReply:"Ok, I will move the accent image to the left...",getTaskTarget:function(e){return e.card},prompt:new ei.V({systemPromptOperation:eo.Run.ChangeAccentImageLayoutSystem,userPromptOperation:eo.Run.ChangeAccentImageLayoutUser,variables:["html","message"],params:{temperature:.2,maxTokens:100}}),checkEnabled:function(e){return"blank"!==e.card.attrs.layout}}),eU=new ei.V({systemPromptOperation:eo.Run.ChangeContentSystem,userPromptOperation:eo.Run.ChangeContentUser,variables:["html","message","outline"],params:{temperature:.7,maxTokens:1e3}}),eW=new e_.w6({key:"CHANGE_CONTENT",description:"Rephrase, summarize, expand, change text formatting, add content, or express ideas differently.",classifyExamples:["condense this to just the key points","say this like a pirate","make this more formal","add a box about health benefits","add more text please","make the bullets red","make the text bigger","fill in the last  column","write something about ___","add ___ to the table"],classifyReply:"Ok, I'll try making it shorter...",prompt:eU}),eH=t(71949),eV=t(21124),eB=t(67273),eq=t(73805),eK=t(81333),eY=new ei.V({systemPromptOperation:eo.Run.RateImagesSystem,userPromptOperation:eo.Run.RateImagesUser,variables:["dataset"],params:{temperature:.1,maxTokens:100}}),eJ=(r=(0,$.Z)(en().mark(function e(n,t){var r,i,o;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.map(function(e,n){var t=e.description,r=e.query;return"".concat(n+1,": ").concat(t,": ").concat(r)}).join("\n"),i=eY.prepare({variables:{dataset:r},history:[]}),e.next=4,(0,ep.I)(i,t,{timeout:eh.VH.get("aiRequestTimeouts").rateImages});case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0="";case 7:return o=e.t0,e.abrupt("return",o.split("\n").map(function(e){var n=e.split("-");return Number((0,eK.Z)(n,2)[1].trim())}));case 9:case"end":return e.stop()}},e)})),function(e,n){return r.apply(this,arguments)});function eQ(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function eX(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?eQ(Object(t),!0).forEach(function(n){(0,o.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eQ(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var e$=new(function(e){(0,el.Z)(o,e);var n,t,r,i=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,eu.Z)(o);if(n){var r=(0,eu.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,ed.Z)(this,e)});function o(){return(0,es.Z)(this,o),i.apply(this,arguments)}return(0,ea.Z)(o,[{key:"getResponseData",value:(t=(0,$.Z)(en().mark(function e(n,t){var r,i,o,s;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.replaceAll(this.key,"").split("\n").map(function(){var e=(0,$.Z)(en().mark(function e(n){var t,r;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.split(",").map(function(e){return e.trim()}).slice(0,2),e.next=3,(0,eV.J)({queries:t,count:eB.x.count,provider:"web",prefetch:!0,options:{gammaFeature:"aiChat"}});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()));case 2:return console.debug("[SuggestImagesTask][getResponseData] allResults",r=e.sent.flat()),console.debug("[SuggestImagesTask][imageRatingData]",{imagesToRate:i=r.map(function(e){var n=e.image,t=e.query,r=(0,eq.C)(n,t,"web");return{description:(0,eq.K)(r)||"",query:t}})}),e.prev=6,e.next=9,eJ(i,t);case 9:if(console.debug("[SuggestImagesTask][imageRatingValues]",{imageRatingValues:o=e.sent}),!(o.length!==r.length)){e.next=13;break}throw Error("Image rating values length does not match allResults length");case 13:return console.debug("[SuggestImagesTask][allResultsSorted]",{allResultsSorted:s=r.map(function(e,n){return eX(eX({},e),{},{rating:o[n]})}).sort(function(e,n){return n.rating-e.rating})}),e.abrupt("return",s);case 19:e.prev=19,e.t0=e.catch(6),console.warn("[SuggestImagesTask] Error rating images. Returing unsorted results.",e.t0);case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}},e,this,[[6,19]])})),function(e,n){return t.apply(this,arguments)})},{key:"getResponseMessages",value:(r=(0,$.Z)(en().mark(function e(n){var t,r,i,o,s,a;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.context,i=(r=n.response).message,o=r.raw,s=r.suggestion){e.next=3;break}throw new er.$D("No image results were returned",{resp:o,inputMessage:t.message,chatMessage:i||"I'm sorry, I wasn't able to find any images for this.",interactionId:t.interactionId});case 3:return e.next=5,this.getResponseData(s,t.interactionId);case 5:return a={from:"Designer",type:"suggestImages",suggestions:e.sent,resp:o,interactionId:t.interactionId,message:i||"Here are some suggestions:"},e.abrupt("return",{messages:[a]});case 8:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})}]),o}(e_.w6))({key:"ADD_IMAGE",description:"Add images, or replace an existing image. Do not use for moving or removing images.",classifyExamples:["add a picture of a bus","find some different images","this needs a pic","show me dolphins","find a meme of stonks","give me more images","add a background image","i need a graph of population over time"],classifyReply:"Let me look for some good bus pictures...",getTaskTarget:function(e){return e.defaultRange},prompt:new ei.V({systemPromptOperation:eo.Run.SuggestImagesSystem,userPromptOperation:eo.Run.SuggestImagesUser,variables:["html","message"],params:{temperature:.7,maxTokens:500}})}),e0=t(24888);function e1(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function e2(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?e1(Object(t),!0).forEach(function(n){(0,o.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):e1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function e5(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var e3=new(function(e){(0,el.Z)(i,e);var n,t,r=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,eu.Z)(i);if(n){var r=(0,eu.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,ed.Z)(this,e)});function i(){return(0,es.Z)(this,i),r.apply(this,arguments)}return(0,ea.Z)(i,[{key:"getResponseData",value:function(e){var n,t=[],r=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return e5(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return e5(e,n)}}(e))){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==t.return||t.return()}finally{if(a)throw o}}}}(e.matchAll(/^\/\/\s*(.*)$\n(.*)$/gm));try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i[1],s=i[2];t.push({reason:o,value:s})}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"getResponseMessages",value:(t=(0,$.Z)(en().mark(function e(n){var t,r,i,o,s,a,c,l,d,u,f,p;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.editor,r=n.context,i=n.rangeId,s=(o=n.response).suggestion,a=o.message,c=o.raw,s){e.next=3;break}throw new er.$D("No suggestions found in response",{interactionId:r.interactionId,inputMessage:r.message,chatMessage:a||Z.ag._({id:"7KKeOM"})});case 3:return l=this.getResponseData(s).map(function(e){var n=new e0.O(t,{description:e.reason,content:{type:"html",html:e.value},rangeId:i});return e2(e2({},e),{},{modification:n})}),d=this.determineTaskTarget(r.editorContext).html,u=new e0.O(t,{description:Z.ag._({id:"HxF6Fk"}),content:{type:"html",html:d},rangeId:i}),f={reason:Z.ag._({id:"HxF6Fk"}),value:d,modification:u},p={from:"Designer",type:"suggestText",message:a||Z.ag._({id:"3YHvwF"}),resp:c,suggestions:[].concat((0,eb.Z)(l),[f]),interactionId:r.interactionId},e.abrupt("return",{messages:[p]});case 10:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),i}(e_.w6))({key:"SUGGEST_TEXT",description:"Open-ended request to rephrase a sentence or paragraph",classifyExamples:["write a better headline","How else could i say this?","this feels too corporate","suggest a more engaging way to say this","give me a more interesting description"],classifyReply:"Let me think of some other headlines...",getTaskTarget:function(e){return e.selectionRange},prompt:new ei.V({systemPromptOperation:eo.Run.SuggestTextSystem,userPromptOperation:eo.Run.SuggestTextUser,variables:["html","message"],params:{temperature:.7,maxTokens:1e3}}),checkEnabled:function(e){var n=e.selection,t=n instanceof H.Bs,r=n.$from.parent.eq(n.$to.parent);return t&&!n.empty&&n.to-n.from<800&&r}}),e4=function(){function e(n,t){(0,es.Z)(this,e),(0,o.Z)(this,"type","change-theme"),(0,o.Z)(this,"description",void 0),(0,o.Z)(this,"themeId",void 0),this.description=t.description,this.themeId=t.themeId}return(0,ea.Z)(e,[{key:"apply",value:function(e,n){n.setThemeWithAccentImages(this.themeId)}},{key:"isApplied",value:function(e,n){return n.isThemeApplied(this.themeId)}},{key:"getPreviewJson",value:function(){return null}},{key:"getContentForTracking",value:function(){return this.themeId}}]),e}(),e6=function(e){(0,el.Z)(o,e);var n,t,r,i=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,eu.Z)(o);if(n){var r=(0,eu.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,ed.Z)(this,e)});function o(){return(0,es.Z)(this,o),i.apply(this,arguments)}return(0,ea.Z)(o,[{key:"getResponseMessages",value:(t=(0,$.Z)(en().mark(function e(n){var t,r,i,o,s,a,c,l,d,u,f,p,h;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.editor,r=n.context,o=(i=n.response).raw,s=i.suggestion,a=i.message,l=(c=n.themeModificationController).currentThemeId,d=c.isValidTheme,u=null==s?void 0:s.split("\n"),e.next=5,this.getFilteredSuggestions({ids:u,idToRemove:l,editor:t,isValid:d});case 5:if(0!==(f=e.sent).length){e.next=8;break}throw new er.$D("[SuggestContentTask] No themes provided in prompt response",{resp:o,chatMessage:Z.ag._({id:"GNHk+9"}),inputMessage:r.message,interactionId:r.interactionId});case 8:return p={label:Z.ag._({id:"HxF6Fk"}),themeId:l,modification:new e4(t,{description:Z.ag._({id:"HxF6Fk"}),themeId:l}),isOriginal:!0},h={from:"Designer",type:"suggestThemes",resp:o,message:a||Z.ag._({id:"pMSbe+"}),suggestions:[].concat((0,eb.Z)(f),[p]),interactionId:r.interactionId},e.abrupt("return",{messages:[h],suggestionToApply:f[0]});case 11:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"getFilteredSuggestions",value:(r=(0,$.Z)(en().mark(function e(n){var t,r,i,o,s;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.ids,r=n.idToRemove,i=n.editor,o=n.isValid,!(!t||0===t.length)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,Promise.all(t.map(function(e){return o(e).then(function(n){return n?e:null})}));case 5:return s=e.sent.filter(function(e){return null!==e}).filter(function(e){return e!==r}).map(function(e){var n=new e4(i,{description:Z.ag._({id:"nyQWMb"}),themeId:e});return{label:Z.ag._({id:"nyQWMb"}),themeId:e,modification:n}}),e.abrupt("return",s);case 8:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)})}]),o}(e_.w6),e8=new ei.V({systemPromptOperation:eo.Run.SuggestThemeSystem,userPromptOperation:eo.Run.SuggestThemeUser,variables:["html","message","outline"],params:{temperature:.7,maxTokens:100,model:"gpt-4"}}),e9=new e6({key:"SUGGEST_THEME",description:"Suggest a theme for the deck. This task will suggest themes based on the deck content or the prompt",classifyExamples:["change the theme","give me a blue theme","change the color palette","make this a dark theme","use a more colorful theme","let's change the look and the feel","change the theme to lilac and periwinkle","i'd like it to look more cheerful and welcoming"],classifyReply:"Let me find some themes...",prompt:e8}),e7=[eF,eH.a,eW,e3,e$,ez,e9],ne=function(e){return e7.find(function(n){return n.key===e})},nn=function(e){return!!e7.find(function(n){return n.key===e})},nt=function(e){(0,el.Z)(i,e);var n,t,r=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,eu.Z)(i);if(n){var r=(0,eu.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,ed.Z)(this,e)});function i(e){var n;return(0,es.Z)(this,i),n=r.call(this,e),(0,o.Z)((0,ec.Z)(n),"apology",void 0),(0,o.Z)((0,ec.Z)(n),"apologyLink",void 0),n.apology=e.apology,n.apologyLink=e.apologyLink,n}return(0,ea.Z)(i,[{key:"run",value:(t=(0,$.Z)(en().mark(function e(n){var t,r,i,o;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.classificationResult,r=n.addMessage,i=n.context,o=n.trackFns,r({from:"Designer",type:"unsupported",task:t.classification,message:this.apology,learnMoreLink:this.apologyLink,resp:t.resp,interactionId:i.interactionId}),o.trackRequestComplete({taskContext:i,outputMessage:this.apology});case 3:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),i}(ef.B),nr=new nt({key:"CHANGE_CARD_BACKGROUND",description:"Change the background of the entire section.",classifyExamples:["make the background red","put a tunnel in the background","remove the background","get rid of the image in the background"],apology:"Sorry, I can't change backgrounds yet, but you can click on a card and change the background yourself. You can also change the doc background by clicking the Theme button."}),ni=new nt({key:"CHANGE_FONT",description:"Change the font family or font style.",classifyExamples:["give me a more playful font","make the headings use arial","change the font to be more readable"],apology:"Sorry, I can't change fonts yet. But you can edit them yourself by creating a custom theme.",apologyLink:"https://gamma.app/public/o2he6ual8noal7u#card-82e40n78edir2x8"}),no=new nt({key:"RESIZE_IMAGE",description:"Change the size of an image (its dimensions), or crop an image",classifyExamples:["make the image smaller","can you make the cat bigger","crop it so it's just the face","I want the disposition of the photos for more portrait instead of landscape"],apology:"Sorry, I can't resize images yet. But you can do it yourself by clicking on the image and dragging the boxes on the corners, or pressing the crop button above the image."}),ns=new nt({key:"EXPORT",description:"Export or download the deck into a different a format.",classifyExamples:["download as ppt","make a pdf","export to google slides"],apology:"Sorry, I can't export files yet. However, you can download a PDF yourself by using the Share menu."}),na=new nt({key:"SPLIT_CARD",description:"Split a card into multiple cards, or move content between cards.",classifyExamples:["break this into two cards","split this up as multiple slides","put the gallery on the next card"],apology:"Sorry, I can't split cards or move things between them yet. However, you can split cards yourself by typing /split inside a card."}),nc=new nt({key:"NEW_DECK",description:"Create a whole new deck",classifyExamples:["i need a presentation about [topic]","write a whole document about animal","make me a landing page about this"],apology:"To make a new deck, go back to the home screen and click New with AI."}),nl=new nt({key:"CHANGE_MULTIPLE_CARDS",description:"Make changes across multiple cards at once",classifyExamples:["I want this entire deck to be summarized","combine the cards together in one","make the whole doc sound more professional","make the deck more consistent"],apology:"Sorry, I can only change one card at a time right now."}),nd=new nt({key:"ADD_VIDEO",description:"Add a video or replace an existing video",classifyExamples:["add a youtube video about scrum","find videos of cats","i need more videos"],apology:"Sorry, I can't search for videos yet. You can embed video by copying the URL and pasting it into the card directly."}),nu=new nt({key:"ADD_FOOTNOTE",description:"Add a footnote to a card, or change footnotes",classifyExamples:["add a biography for him in a footnote","put the details into footnotes"],apology:"Sorry, I haven't learned to add footnotes yet. You can make footnotes by highlighting text and clicking the footnote button in the menu."}),nf=[nr,ni,no,ns,na,new nt({key:"MOVE_CARD",description:"Move a card to a different position in the deck",classifyExamples:["shift the slide to the top","move this card to the bottom"],apology:"Sorry, I haven't learned to move cards yet. You can move them by hovering on the table of contents on the left side of the screen and dragging them around."}),nc,nl,nd,nu,new nt({key:"ADD_CHART",description:"Add a chart, diagram, or graph",classifyExamples:["put this information into a scatter plot","add a card about market share using a pie chart","i need to display this as a flow chart","create a diagram illustrating the interactions and relationships","can you change the card to have a line graph","turn this into a gantt chart","could you do this as a funnel diagram"],apology:"Sorry, Gamma doesn't support charts yet. You can paste in images of charts from other tools, or type /diagram in the editor to draw your own."}),new nt({key:"ANIMATION",description:"Add animations to a card or edit animations",classifyExamples:["animate transitions","make the text appear one by one","fade in the images","make the bullets fly in"],apology:'Sorry, Gamma doesn\'t support custom animations yet. You can animate line by line by going into Present mode and pressing S for "spotlight".'}),new nt({key:"FOLLOW_LINK",description:"Read content from an external website",classifyExamples:["go to this website and add the content to this card http://www.example.com/","here is his linkedin page now add the details https://www.linkedin.com/...","add the images from https://medium.com/posts/2022/9/6/..."],apology:"Sorry, I'm not able to open links and read the content."})],np=function(e){return nf.find(function(n){return n.key===e})},nh=new ei.V({variables:["message","taskList","ackExamples","html","cardHtml"],systemPromptOperation:eo.Run.ClassifySystem,userPromptOperation:eo.Run.ClassifyUser,params:{maxTokens:100,temperature:.2}}),nx=[].concat((0,eb.Z)(e7),(0,eb.Z)(nf),(0,eb.Z)(eg)),nm="\uD83D\uDE14 Sorry, I didn't understand your request. Could you please try asking a different way?",ng=(i=(0,$.Z)(en().mark(function e(n){var t,r,i,o,s,a,c,l,u,f,p,h,x;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.message,r=n.context,i=n.history,o=n.provider,a=(s=nb(nx,r.editorContext)).ackExamples,c=s.taskList,l=s.enabledTasks,u=ny(i),f=nh.prepare({variables:{message:t,ackExamples:a,taskList:c,html:r.editorContext.defaultRange.html,cardHtml:r.editorContext.card.html},params:{provider:o},history:u}),console.debug("[AIChat classify] Getting classification",{classifyHistory:u,input:f}),e.next=7,(0,ey.oO)(f);case 7:return p=e.sent,e.next=10,(0,ep.I)(p,r.interactionId,{timeout:d.VH.get("aiRequestTimeouts").classify});case 10:if(x=nj(h=e.sent,l)){e.next=18;break}return console.debug("Failed classification, trying again...",{resp:h,parsedResp:x}),e.next=16,(0,ep.I)(f,r.interactionId);case 16:x=nj(h=e.sent,l);case 18:if(x){e.next=20;break}return e.abrupt("return",{type:"UNKNOWN",classification:"UNKNOWN",ack:nm,resp:h||""});case 20:return console.debug("[AIChat classify] Got classification",{resp:h,parsedResp:x}),e.abrupt("return",x);case 22:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)}),nv="Ok, I'll get right on it.",nj=function(e,n){if(e){var t,r=e.split("\n"),i=null===(t=r[0])||void 0===t?void 0:t.trim().toUpperCase();if(n.find(function(e){return e.key===i})){var o=r[1];return{classification:i.trim(),ack:o.includes(i.trim())?nv:o||("UNKNOWN"!==i?nv:nm),resp:e,type:"CLASSIFICATION"}}}},nb=function(e,n){var t=e.filter(function(e){return!n||!e.checkEnabled||e.checkEnabled(n)});return{taskList:t.map(function(e){var n;return"".concat(e.key,": ").concat(e.description,"\n").concat(null===(n=e.classifyExamples)||void 0===n?void 0:n.map(function(e){return"- ".concat(e)}).join("\n"))}).join("\n\n"),ackExamples:t.filter(function(e){return e.classifyExamples&&e.classifyExamples.length>0&&e.classifyReply}).map(function(e){return"Request:\n".concat(e.classifyExamples[0],"\nResponse:\n").concat([e.key,e.classifyReply].join("\n"))}).join("\n\n"),enabledTasks:t}},ny=function(e){return e.slice(-7).map(function(e){return"User"===e.from?{role:eo.XaP.User,content:e.message}:e.isClassification?{role:eo.XaP.Assistant,content:e.resp}:null}).filter(function(e){return!!e})},nC=t(6201),nO=t(97782),nw=t(70099),nk=t(54113),nS=t(12172),nE=t(65185),nI=t(95472),nP=t(39428),nD=function(e,n){var t=e.state.doc.slice(n.from,n.to).content;return(0,nS.c)(e,t)},nA=function(e,n){var t=e.state.selection,r=(0,nI.Ru)(t.$from,eP.KH)[0],i=r&&(0,S.NE)(r.node,r.pos);if(!r||!i)throw Error("Cant find parent card for selection ".concat(t));var o={from:r.pos,to:r.pos+r.node.nodeSize},s={from:i.pos+1,to:i.pos+i.node.nodeSize-1},a=t.$from.blockRange(t.$to),c={from:a.start,to:a.end},l={range:(0,nP.bb)(e.state,s),html:nD(e,s)},d={range:(0,nP.bb)(e.state,t),html:nD(e,t)},u={range:(0,nP.bb)(e.state,c),html:nD(e,c)},f=t instanceof H.qv&&(0,eP.KH)(t.node)||t.empty||0===d.html.trim().length||t instanceof H.qv&&t.node.isAtom,p=!t.$from.parent.eq(t.$to.parent)||0===a.$from.parentOffset&&a.$to.parentOffset===a.$to.parent.content.size,h=d,m="selectionRange";f?(h=l,m="cardContent"):p&&(h=u,m="blockRange");var g=nT(n),v=(0,x.Pu)(n.getState());return{card:{cardId:r.node.attrs.id,range:(0,nP.bb)(e.state,o),html:nD(e,o),attrs:r.node.attrs},cardContent:l,blockRange:u,selectionRange:d,defaultRange:h,selection:t,outline:g,selectedDefaultRange:m,theme:v}},nT=function(e){var n=e.getState(),t=(0,x.X9)(n),r=(0,nE.mT)(n);return Object.keys(t.tree).map(function(e){var n;return null===(n=r.find(function(n){return n.id===e}))||void 0===n?void 0:n.title}).filter(function(e){return!!e}).join("\n")},nR=t(24272),n_=function(e){var n,t=e.editor,r=e.addMessage,i=e.getMessageHistory,o=(0,l.useState)("idle"),s=o[0],a=o[1],c=(0,p.qr)(),d=(0,nR.E)(),u=(0,B.q)().hasEnoughCreditsToChat,f=(0,nO.T)(),h=(0,nw.g5)();return{sendMessage:(0,l.useCallback)((n=(0,$.Z)(en().mark(function e(n){var o,s,l,p,x,m,g,v,j,b,y,C,O;return en().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.message,t){e.next=3;break}return e.abrupt("return");case 3:if(s=void 0,l=void 0,p=void 0,x=(0,nC.nZ)(),e.prev=7,s=nA(t,c),console.debug("[AIChat] starting interaction",l={interactionId:x,startTime:performance.now(),message:o,editorContext:s,docId:t.gammaDocId}),m=i(),r({from:"User",type:"text",message:o,interactionId:x}),d.trackRequestSent(l,h),u){e.next=16;break}return e.abrupt("return");case 16:return a("classifying"),e.next=19,ng({message:o,context:l,history:m,provider:h});case 19:if(g=e.sent,d.trackClassification({taskContext:l,classification:g.classification}),a("fetching"),console.debug("[AIChat] Starting task",{taskContext:l,classification:g.classification,history:m}),"UNKNOWN"!==g.type){e.next=28;break}r({from:"Designer",type:"text",message:g.ack,resp:g.resp,isClassification:!0,interactionId:x}),d.trackRequestComplete({taskContext:l,outputMessage:g.ack}),e.next=47;break;case 28:if(!ej(g.classification)){e.next=34;break}return v=ev(g.classification),e.next=32,v.run({editor:t,addMessage:r,context:l,classificationResult:g,history:m,trackFns:d,themeModificationController:f,provider:h});case 32:case 38:e.next=47;break;case 34:if(!np(g.classification)){e.next=40;break}return j=np(g.classification),e.next=38,j.run({editor:t,context:l,addMessage:r,classificationResult:g,history:m,trackFns:d,themeModificationController:f,provider:h});case 40:if(!nn(g.classification)){e.next=47;break}return r({from:"Designer",type:"text",message:g.ack||"Sure, let me see what I can do...",resp:g.resp,isClassification:!0}),b=i(),y=ne(g.classification),e.next=46,y.run({editor:t,context:l,addMessage:r,classificationResult:g,history:b,trackFns:d,themeModificationController:f,provider:h});case 46:p="chatSuggestion";case 47:e.next=54;break;case 49:e.prev=49,e.t0=e.catch(7),console.log("[AIChat.sendMessage] ERROR: ".concat(e.t0.message,"}"),{err:e.t0,taskContext:l}),C="Sorry, something unexpected happened. Please try again.",e.t0 instanceof er.Og?(r({from:"Designer",type:"text",message:O=e.t0.opts.chatMessage||C,resp:e.t0.opts.resp,interactionId:x}),d.trackRequestError({errorName:e.t0.name,interactionId:x,outputMessage:O,errorMessage:e.t0.message,resp:e.t0.opts.resp})):(et.Tb(e.t0),r({from:"Designer",type:"text",message:C,interactionId:x}),d.trackRequestError({errorName:e.t0.name,interactionId:x,outputMessage:C,errorMessage:e.t0.message,errorCode:(0,ey.uc)(e.t0)[0]}));case 54:p&&(0,nk.d)(p),a("idle");case 56:case"end":return e.stop()}},e,null,[[7,49]])})),function(e){return n.apply(this,arguments)}),[t,c,i,r,d,u,f,h]),status:s}};function nM(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var nL=function(e){var n=e.editor,t=e.scrollSelector,r=e.onClose,i=(0,l.useState)(""),s=i[0],c=i[1],u=(0,d.ye)("openAiStatus"),f=(0,p.TL)(),h=(0,w.As)("editor"),x=(0,p.qr)(),m=(0,p.CG)(X.AZ),E=(0,p.CG)(X.Q_),I=(0,l.useState)(null),P=I[0],D=I[1],A=(0,l.useCallback)(function(){return(0,X.AZ)(x.getState())},[x]),T=(0,l.useCallback)(function(e){var n=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nM(Object(t),!0).forEach(function(n){(0,o.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nM(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({timestamp:Date.now()},e);f((0,X.Hz)({message:n}))},[f]),R=(0,l.useCallback)(function(){f((0,X.mc)())},[f]),_=n_({addMessage:T,getMessageHistory:A,editor:n}),N=_.status,Z=_.sendMessage;(0,l.useEffect)(function(){var e=t&&document.querySelector(t);e&&requestAnimationFrame(function(){e.scrollTop=e.scrollHeight})},[t,m]);var G="idle"!==N;(0,l.useEffect)(function(){if(E.length&&!G){var e=E[0],n=e.task,t=e.id;!1===n.submit?c(n.message):Z({message:n.message}),f((0,X.VB)({id:t}))}},[G,Z,f,E]);var F=(0,l.useCallback)(function(){if(P&&n){var e=document.querySelector('[data-card-id="'.concat(P,'"]')),t=(0,w.v4)(e,100);null!=t&&t.yAxisInView||h.scrollElementIntoView({element:e})}},[n,h,P]),U=(0,l.useCallback)(function(e){F(),Z({message:e})},[F,Z]),W=(0,l.useCallback)(function(){U(s),c("")},[U,s]);return((0,l.useEffect)(function(){if(n){var e=function(){var e=(0,S.AQ)(n,n.state.selection.from);e&&D(e.node.attrs.id)};return e(),n.on("selectionUpdate",e),function(){n.off("selectionUpdate",e)}}},[n]),n)?"DOWN"===u?(0,M.jsx)(L,{onClose:r}):(0,M.jsxs)(a.k,{direction:"column",h:"100%",w:"100%",px:6,pb:2,children:["DEGRADED"===u&&(0,M.jsx)(z,{}),(0,M.jsx)(Q.rN,{scrollSelector:t,messages:m,editor:n,sendMessage:U,isLoading:G,onClose:r}),(0,M.jsxs)(j.K,{pos:"sticky",bottom:0,py:2,pt:4,bg:"gray.50",children:[(0,M.jsx)(J,{editor:n,value:s,onChange:c,onSubmit:W,isLoading:G,resetMessages:R}),(0,M.jsx)(O.r,{modalId:"ai-credits-modal-message-list",variant:"ghost",justify:"flex-end",segmentEvent:k.AA.GAMMA_UPSELL_CALLOUT_AI_CREDITS_CHAT})]}),(0,M.jsx)(C.kH,{label:(0,M.jsx)(v.cC,{id:"5eg0kp"}),placement:"top",children:(0,M.jsx)(b.h,{variant:"ghost",colorScheme:"blackAlpha",color:"currentColor","aria-label":"reset-chat",icon:(0,M.jsx)(y.G,{icon:g.Yc}),onClick:R,position:"absolute",left:4,top:1,isRound:!0})})]}):null},nz=t(81234),nN=t(97907),nZ=function(e){var n=e.onClose;return(0,M.jsx)(a.k,{width:"100%",px:6,py:4,justifyContent:"space-between",alignItems:"center",h:8,tabIndex:0,outline:"none",position:"absolute",top:0,children:(0,M.jsx)(nN.P,{"data-design-partner-close-button":!0,position:"absolute",top:2,right:6,zIndex:1,onClick:n})})},nG=["closePanel"];function nF(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function nU(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nF(Object(t),!0).forEach(function(n){(0,o.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nF(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var nW="design-partner-panel-wrapper",nH=function(e){var n=e.toggleDesignPartnerPanel,t=e.isDesignPartnerPanelOpen,r=e.editor,i=(0,d.ye)("aiChat"),o=(0,p.TL)();(0,l.useEffect)(function(){return function(){o((0,X.mc)())}},[]);var s=(0,p.CG)(x.hN);(0,l.useEffect)(function(){!s&&t&&n()},[s,t,n]),(0,l.useEffect)(function(){var e,n;r&&(null===(e=(n=r.commands).setSalOpen)||void 0===e||e.call(n,t))},[r,t]),(0,l.useEffect)(function(){if(i)return nz.T.on("toggle",function(e){n(e.config)})},[n,i]),(0,l.useEffect)(function(){if(i)return h.pw.on("queueDesignPartnerTask",function(e){o((0,X.Lj)({task:e})),n({disableTransition:!1,override:"open"}),console.log("queueDesignPartnerTask",e)})},[o,i,n]),(0,l.useEffect)(function(){if(i&&s){var e=(0,c.ZP)("mod+shift+S");return u.F7.on("keydown","DESIGN_PARTNER_PANEL",function(t){return!!e(t)&&(n(),!0)})}},[n,i,s])},nV=function(e){var n=e.closePanel,t=(0,s.Z)(e,nG),r=(0,m._)().editor;return(0,l.useEffect)(function(){return u.F7.on("keydown","DESIGN_PARTNER_PANEL",function(e){return!!document.activeElement.closest('[data-panelid="design-partner-panel"]')&&"Escape"===e.key&&(n(),!0)})},[n]),(0,M.jsx)(f.s,nU(nU({},t),{},{bgColor:"gray.50","data-panelid":"design-partner-panel",borderLeftWidth:"1px",children:(0,M.jsxs)(a.k,{direction:"column",h:"100%",overflowY:"auto",overflowX:"hidden",className:nW,w:"100%",children:[(0,M.jsx)(nZ,{onClose:n}),(0,M.jsx)(nL,{editor:r,scrollSelector:".".concat(nW),onClose:n})]})}))};nV.panelPosition="right"},75033:function(e,n,t){t.d(n,{m:function(){return b}});var r=t(95235),i=t(55452),o=t(11919),s=t(45650),a=t(84103),c=t(36895),l=t(55966),d=t(2784),u=t(75085),f=t(74586),p=t(32333),h=t(32736),x=t(59734),m=t(9734),g=t(52322);function v(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function j(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?v(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var b=function(e){var n=(0,x._i)().docId,t=(0,h.Yy)(),r=(0,p.z$)(),v=(0,d.useCallback)(function(){null==r||r.track(p.AA.MADE_WITH_GAMMA_CLICKED,{doc_id:n})},[r,n]),b=(0,f.dU)();return void 0===b||b?null:(0,g.jsx)(o.k,j(j(j({},(0,m.s2)()?{display:"flex",justifyContent:"center",m:6,position:"relative"}:{position:"fixed",right:[1,6],bottom:[1,4]}),e),{},{children:(0,g.jsx)(l.Wk,{isDark:t,children:(0,g.jsx)(s.z,{as:a.r,onClick:v,variant:"plain",target:"_blank",href:"https://gamma.app",textDecoration:"none !important",leftIcon:(0,g.jsx)(c.E,{src:"/_next/static/media/GammaLogoGradient.43edb67f.svg",h:"1em"}),size:"sm",children:(0,g.jsx)(i.cC,{id:"vo61Ld",values:{GAMMA_PROPER_NOUN:u.N6}})})})}))}},96302:function(e,n,t){t.d(n,{VN:function(){return f},rJ:function(){return d},us:function(){return u}});var r=t(2784),i=t(98875),o=t(46358),s=t(41261),a=t(62141),c=t(14115),l="disable-card-size-animations",d=function(){var e=(0,i.ye)("autoZoomToFit"),n=(0,o.CG)(a.Kk);return null!=n?n:e},u=function(){var e=(0,o.CG)(a.i2),n=(0,r.useRef)(),t=d(),i=!c.Pv&&t;(0,r.useEffect)(function(){var t=!n.current;n.current=e;var r=t?s.nY:s.id/4;e&&i&&setTimeout(function(){document.body.classList.add(l),f(),setTimeout(function(){document.body.classList.remove(l)},s.id/2)},r)},[e,i])},f=function(){var e=(0,o.bh)(),n=document.documentElement.clientHeight,t=document.querySelector('[data-animate-value="presentCurrent"][data-card-scroll-element]');t&&(e.dispatch((0,a.Ic)({zoomLevel:1})),setTimeout(function(){var r=t.scrollHeight,i=n/r;if(c.QX)i=Math.max(n/r,.7);else{if(i<.7)return;i=Math.floor(10*i)/10}e.dispatch((0,a.Ic)({zoomLevel:i})),console.debug("[zoomPresentModeToFit] zooming",JSON.stringify({viewportHeight:n,cardHeight:r,targetZoom:i}))}))}},50376:function(e,n,t){t.d(n,{Z:function(){return en}});var r=t(81333),i=t(55452),o=t(87254),s=t(81927),a=t(8848),c=t(24798),l=t(11919),d=t(91012),u=t(4036),f=t(53738),p=t(73848),h=t(45650),x=t(55479),m=t(78116),g=t(56915),v=t(16796),j=t(64827),b=t(92619),y=t(2167),C=t(89190),O=t(80353),w=t(76648),k=t(55966),S=t(65742),E=t(31807),I=t(65903),P=t.n(I),D=t(2784),A=t(24021),T=t(23313),R=t(75085),_=t(8388),M=t(51331),L=t(49922),z=t(32333),N=t(36738),Z=t(41261),G=t(1153);function F(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var U=function(e,n){var t=[];return!function e(r){if(n(r)&&t.push(r),r.content){var i,o=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return F(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return F(e,n)}}(e))){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==t.return||t.return()}finally{if(a)throw o}}}}(r.content);try{for(o.s();!(i=o.n()).done;){var s=i.value;e(s)}}catch(e){o.e(e)}finally{o.f()}}}(e),t},W=t(59734),H=t(81188),V=t(67453),B=t(52322),q=function(){return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(s.O,{w:"350px",h:12}),(0,B.jsx)(a.N,{mt:3,w:64,noOfLines:1})]})},K=function(e){var n=e.createdTime,t=e.editors,r=e.isLatest,o=e.onClick,s=e.showPaywall,a=e.paywallCount;if(!t||!t.length)return(0,B.jsx)(B.Fragment,{});var p=s?"linear-gradient(rgb(0, 0, 0) 15%, transparent 100%)":"",h=(0,B.jsxs)(c.O,{flexDirection:"row",borderRadius:"base",style:{WebkitMaskImage:p,maskImage:p},border:"none",isDisabled:s,opacity:"1 !important",onClick:o,alignItems:"flex-start",width:"100%",textAlign:"left",children:[(0,B.jsxs)(l.k,{w:"100%",direction:"column",children:[(0,B.jsx)(d.x,{fontSize:"sm",children:P()((0,H.P9)(n))}),(0,B.jsx)(d.x,{fontSize:"xs",flex:1,children:t[0].displayName})]}),r&&(0,B.jsx)(u.C,{colorScheme:"green",py:"0.5",fontSize:"0.65em",children:(0,B.jsx)(i.cC,{id:"wL3cK8"})})]});return s?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(k.kH,{placement:"top",isDisabled:!s,label:s?(0,B.jsx)(i.cC,{id:"PYTBm5",values:{paywallCount:a}}):void 0,children:(0,B.jsx)(f.xu,{mb:4,children:h})}),(0,B.jsx)(L.m,{isNarrow:!0,segmentEvent:z.AA.GAMMA_PRO_UPSELL_CALLOUT_CHANGE_HISTORY,description:(0,B.jsx)(i.cC,{id:"mVKYtH"})})]}):h},Y=function(e){var n,t=(0,M.Yt)(),r=(0,D.useMemo)(function(){if("unlimited"===t)return{items:e,paywalledItems:[]};var n=parseInt(t),r=e.filter(function(e,t){return 0===t||(0,E.Z)(e.createdTime)>=new Date(Date.now()-864e5*n)}),i=e.slice(r.length,e.length),o=i.length?i[0]:null;return{items:r.concat(o?[o]:[]),paywalledItems:i}},[t,e]),i=r.items,o=r.paywalledItems;return{groupedSnapshots:(0,D.useMemo)(function(){return(0,H.yd)({items:i,sortBy:"createdTime"})},[i]),paywalledSnapshotId:null===(n=o[0])||void 0===n?void 0:n.id,paywallCount:o.length}},J=function(e){var n=e.groupedSnapshots,t=e.paywalledSnapshotId,s=e.paywallCount,a=e.onClick,c=e.showFetchMore,l=e.onFetchMoreClick,d=e.isFetchingMore;return(0,B.jsxs)(p.t,{w:"100%",children:[Object.entries(n).filter(function(e){return(0,r.Z)(e,2)[1].length}).map(function(e){var n=(0,r.Z)(e,2),i=n[0],c=n[1];return(0,B.jsxs)(D.Fragment,{children:[(0,B.jsx)(k.NZ,{px:4,py:2,mx:0,mt:2,children:{today:o.ag._({id:"ecUA8p"}),thisWeek:o.ag._({id:"yByRxz"}),earlier:o.ag._({id:"HGg4T/"})}[i]}),c.map(function(e,n){var r=e.createdTime,i=e.editors,o=e.id;return(0,B.jsx)(K,{onClick:function(){return a(o)},isLatest:0===n,createdTime:r,editors:i,showPaywall:t===o,paywallCount:s},o)})]},i)}),c&&(0,B.jsx)(h.z,{isLoading:d,onClick:l,children:(0,B.jsx)(i.cC,{id:"yQ2kGp"})})]})},Q=function(){return(0,B.jsxs)(p.t,{w:"100%",children:[(0,B.jsx)(s.O,{h:16}),(0,B.jsx)(s.O,{h:16,mt:2}),(0,B.jsx)(s.O,{h:16,mt:2}),(0,B.jsx)(s.O,{h:16,mt:2}),(0,B.jsx)(s.O,{h:16,mt:2}),(0,B.jsx)(s.O,{h:16,mt:2}),(0,B.jsx)(s.O,{h:16,mt:2}),(0,B.jsx)(s.O,{h:16,mt:2})]})},X=function(e){var n=e.title,t=e.createdBy,r=e.createdTime,o=e.numSnapshots;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(d.x,{mt:1,children:(0,B.jsx)(i.cC,{id:"yf//Op",values:{0:(0,_.Dw)(r),1:(0,_.Dw)(r),numSnapshots:o}})}),(0,B.jsx)(d.x,{color:"gray.500",fontSize:"sm",fontWeight:"normal",letterSpacing:"normal",children:(0,B.jsx)(i.cC,{id:"JVHTIo",values:{0:null!=t&&t.displayName?null==t?void 0:t.displayName:"Unknown",1:(0,_.p6)(r,"PPp"),title:n}})})]})},$="snapshot-editor-root",ee=function(e){var n=e.id,t=e.doc,r=e.content,i=(0,D.useMemo)(function(){if(r)return U(r,function(e){return e.type===Z.W4}).map(function(e){var n;return{__typename:"Card",id:(null===(n=e.attrs)||void 0===n?void 0:n.id)||"",docId:t.id,title:(0,S.getCardTitle)(e),createdTime:t.createdTime,updatedTime:t.updatedTime,archived:!1}})},[r,t]);return(0,B.jsx)(N.fb,{reduxData:{cards:i},initialContent:r,doc:t,docId:t.id,scrollingParentSelector:".".concat($),isInsideDrawer:!0},n)},en=function(e){var n=e.isOpen,t=e.onClose,o=e.doc,s=(0,x.p)(),a=(0,W._i)().getCollaborativeEditorInstance,c=(0,D.useState)(!1),d=c[0],u=c[1],p=(0,T.pfN)({variables:{docId:o.id,first:25},skip:!o||!n,fetchPolicy:"network-only",nextFetchPolicy:"network-only"}),S=p.loading,E=p.data,I=p.called,P=p.fetchMore,M=(0,T.opq)({nextFetchPolicy:"cache-only"}),L=(0,r.Z)(M,2),z=L[0],N=L[1],Z=N.loading,F=N.data,U=(null==E?void 0:E.snapshots.edges.map(function(e){return e.node}))||[],H=Y(U),K=H.groupedSnapshots,en=H.paywalledSnapshotId,et=H.paywallCount,er=null==E?void 0:E.snapshots.pageInfo,ei=!!(!en&&I&&(null==er?void 0:er.hasNextPage)&&(null==er?void 0:er.endCursor)),eo=(0,D.useCallback)(function(){null!=er&&er.hasNextPage&&null!=er&&er.endCursor&&(u(!0),P({variables:{after:er.endCursor}}).finally(function(){u(!1)}))},[P,null==er?void 0:er.endCursor,null==er?void 0:er.hasNextPage]),es=U[0];(0,D.useEffect)(function(){null!=es&&es.id&&z({variables:{snapshotId:es.id,docId:o.id}})},[o.id,z,null==es?void 0:es.id]);var ea=(0,V.$)(null==o?void 0:o.title),ec=null==o?void 0:o.createdBy,el=null==o?void 0:o.createdTime,ed=null==F?void 0:F.snapshot,eu=ed&&ed.id===o.currentSnapshotId;return(0,B.jsx)(k.Wk,{isDark:!1,children:(0,B.jsxs)(m.d,{placement:"bottom",onClose:t,isOpen:n,trapFocus:!0,isFullHeight:!0,blockScrollOnMount:!1,children:[(0,B.jsx)(g.Z,{}),(0,B.jsxs)(v.s,{borderTopRadius:"xl",h:"calc(var(--100vh) - 24px)",transform:"none !important",children:[(0,B.jsx)(j.o,{}),(0,B.jsxs)(b.x,{borderBottom:"1px solid #000",borderColor:"gray.200",children:[S&&(0,B.jsx)(q,{}),o&&U&&(0,B.jsx)(X,{numSnapshots:(null==U?void 0:U.length)||0,createdBy:ec,createdTime:el,title:ea})]}),(0,B.jsx)(y.f,{p:0,h:"100%",children:(0,B.jsxs)(l.k,{direction:"row",h:"100%",children:[(0,B.jsx)(f.xu,{p:2,w:"17rem",overflowY:"auto",bg:"gray.50",children:(0,B.jsxs)(C.m,{variant:"soft-rounded",orientation:"vertical",size:"md",children:[S&&(0,B.jsx)(Q,{}),!S&&U&&(0,B.jsx)(J,{onClick:function(e){z({variables:{snapshotId:e,docId:o.id}})},groupedSnapshots:K,paywalledSnapshotId:en,paywallCount:et,showFetchMore:ei,onFetchMoreClick:eo,isFetchingMore:d})]})}),(0,B.jsx)(l.k,{flex:1,bg:"gray.100",overflowY:"scroll",justifyContent:"center",alignContent:"center",alignItems:"flex-start",width:"100%",height:"100%",className:$,css:{"--editor-width":"100%"},children:(0,B.jsxs)(l.k,{direction:"column",position:"relative",width:"100%",height:"100%",children:[(0,B.jsx)(G.Y,{}),(!ed||Z)&&(0,B.jsx)(A.AA,{}),ed&&!Z&&(0,B.jsx)(ee,{id:ed.id,doc:o,content:null==ed?void 0:ed.content.default})]})})]})}),(0,B.jsx)(O.m,{borderTop:"1px solid #000",borderColor:"gray.200",children:(0,B.jsxs)(w.h,{spacing:4,children:[(0,B.jsx)(h.z,{variant:"ghost",onClick:t,children:(0,B.jsx)(i.cC,{id:"dEgA5A"})}),(0,B.jsx)(k.kH,{label:eu?(0,B.jsx)(i.cC,{id:"HJo72u"}):(0,B.jsx)(i.cC,{id:"sonTm1"}),shouldWrapChildren:!0,children:(0,B.jsx)(h.z,{variant:"solid",isDisabled:!ed||eu,onClick:function(){if(ed){var e,n=null==U?void 0:null===(e=U.find(function(e){return e.id===ed.id}))||void 0===e?void 0:e.createdTime,r=a();if(r){r.commands.setContent(ed.content.default,!0);var o=ed.content.annotationsAbsolute;o?r.commands.restoreAnnotations(o):r.commands.clearAnnotations(),t(),s({title:(0,B.jsx)(i.cC,{id:"7ovf4C"}),description:(0,B.jsx)(i.cC,{id:"DTim6X",values:{0:n?(0,_.p6)(n,"PPp"):"selected snapshot",GAMMA_ARTIFACT_PROPER_NOUN:R.Yc}}),status:"success",duration:5e3,isClosable:!0})}}},children:(0,B.jsx)(i.cC,{id:"yKu/3Y"})})})]})})]})]})})}},33902:function(e,n,t){t.d(n,{D:function(){return _}});var r,i,o=t(76547),s=t(55452),a=t(87254),c=t(82642),l=t(55479),d=t(11919),u=t(12221),f=t(91012),p=t(76648),h=t(45650),x=t(67887),m=t(8283),g=t(30807),v=t(80040),j=t(95258),b=t(53738),y=t(49929),C=t(55966),O=t(28957),w=t(2784),k=t(43997),S=t(98621),E=t.n(S),I=t(62141),P=t(10710),D=t(59734),A=t(13720),T=t(10939),R=t(52322),_=function(){var e=(0,P.SE)(),n=e.user,t=e.anonymousUser,r=(0,k.I0)(),o=(0,l.p)(),v=(0,D._i)().editor,j=(0,k.v9)((0,I._h)((null==n?void 0:n.id)||t.id)),b=j.collaborators,y=j.followers;(0,T.rU)({editor:v,collaborators:b,user:n});var O=(0,k.v9)(I.Ok),S=(0,k.v9)(I.e0),_=(0,k.v9)(I.yn),L=(0,k.v9)(I.gs),z=(0,k.v9)(I.JA);(0,w.useEffect)(function(){O.forEach(function(e){o({duration:2e3,position:"bottom",render:function(){return(0,R.jsxs)(d.k,{bg:"gray.50",p:3,px:6,align:"center",borderRadius:"md",shadow:"md",children:[(0,R.jsx)(u.q,{size:"sm",src:e.profileImageUrl,border:"solid 2px ".concat(e.color),color:E()(e.color).isDark()?"white":"black",bg:e.color,ignoreFallback:!0}),(0,R.jsx)(f.x,{ml:2,children:(0,R.jsx)(s.cC,{id:"DSaSKH",values:{0:e.name}})})]})}})})},[O,o]),(0,w.useEffect)(function(){var e=!_&&L&&!z;if(v&&e){o.closeAll();var n=o({id:"detached-toast",render:function(){return(0,R.jsxs)(d.k,{bg:"gray.50",p:3,px:6,m:4,justify:"flex-end",align:"center",borderRadius:"md",shadow:"md",children:[(0,R.jsx)(f.x,{size:"sm",mr:6,children:(0,R.jsx)(s.cC,{id:"PjodLp"})}),(0,R.jsxs)(p.h,{size:"sm",alignItems:"center",children:[(0,R.jsx)(h.z,{onClick:function(){r((0,I.Qx)({attached:!0}))},variant:"solid",children:(0,R.jsx)(s.cC,{id:"f/C2ic"})}),(0,R.jsx)(C.kH,{label:(0,R.jsx)(s.cC,{id:"5JWVnj"}),children:(0,R.jsx)(x.h,{isRound:!0,variant:"ghost",size:"xs","aria-label":a.ag._({id:"5JWVnj"}),icon:(0,R.jsx)(c.T,{}),onClick:function(){r((0,I.Qx)({attached:!1,following:null}))}})})]})]})},position:"bottom",duration:null});return function(){o.close(n)}}},[v,_,L,z,o,r]),(0,w.useEffect)(function(){L||!v||v.isDestroyed||r((0,I.Qx)({following:null}))},[v,L,r]);var N=(0,A.i)({base:4,md:6,xl:8})||6,Z=N/(y.length?2:1),G=N/(b.length?2:1);return(0,R.jsx)(d.k,{children:(0,R.jsxs)(m.U,{divider:(0,R.jsx)(g.c,{borderColor:"gray.200"}),children:[y.length&&(0,R.jsx)(M,{type:i.FOLLOWERS,collaborators:y,max:G,isEveryone:0===b.length,localCollaborator:S,localIsAttached:_}),b.length&&(0,R.jsx)(M,{type:i.COLLABORATORS,collaborators:b,max:Z,isEveryone:0===y.length,localCollaborator:S,localIsAttached:_})]})})};(r=i||(i={})).FOLLOWERS="FOLLOWERS",r.COLLABORATORS="COLLABORATORS";var M=function(e){var n=e.collaborators,t=e.localCollaborator,r=e.localIsAttached,o=e.type,c=e.max,l=e.isEveryone,u=(0,T.OM)(),p=o===i.FOLLOWERS,h=n.length>c,x=h?n.slice(0,c-1):n,m=h?n.length-c+1:0,g=function(e){var n=e.localIsFollowing,t=e.collaborator;p||u({localIsFollowing:n,localIsAttached:r,collaborator:t})};return(0,R.jsx)(O.S,{children:(0,R.jsxs)(v.H,{size:"sm",spacing:p?-2:0,children:[p&&(0,R.jsx)(L,{isEveryone:l}),x.map(function(e,n){var i,o=(null==t?void 0:null===(i=t.memoState)||void 0===i?void 0:i.following)===e.sessionId,a=!!e.idleSince,c=!p&&(h||x.length-1!==n);return(0,R.jsx)(C.Vw,{ignoreFallback:!0,name:e.name,label:(0,R.jsxs)(d.k,{direction:"column",justify:"center",align:"center",children:[(0,R.jsx)(f.x,{children:e.name}),(0,R.jsx)(f.x,{fontSize:"xs",children:p?(0,R.jsx)(s.cC,{id:"iRohzP"}):o&&r?(0,R.jsx)(s.cC,{id:"1QTvS5"}):(0,R.jsx)(s.cC,{id:"2Ldadb"})})]}),pointerEvents:a?"none":"auto",opacity:a?.4:1,transitionProperty:"common",transitionDuration:"normal",src:e.profileImageUrl,border:"solid 2px ".concat(e.color),nubbin:o&&r,bg:e.color,shadow:"base",color:E()(e.color).isDark()?"white":"black",cursor:p?"":"pointer",boxProps:c?{marginEnd:-2}:{},onClick:function(){return g({localIsFollowing:o,collaborator:e})}},e.sessionId)}),m>0&&(0,R.jsxs)(C.Z9,{tooltipLabel:a.ag._({id:"25VyZX"}),onClick:function(e){var r,i=n.find(function(n){return n.id===e.id});g({localIsFollowing:!!(i&&(null==t?void 0:null===(r=t.memoState)||void 0===r?void 0:r.following)===i.sessionId),collaborator:i})},avatars:n,count:m,disabled:p,children:[(0,R.jsx)(f.x,{px:2,children:p?(0,R.jsx)(s.cC,{id:"vliZud",values:{0:n.length}}):(0,R.jsx)(s.cC,{id:"sC4bhw",values:{0:n.length}})}),!p&&(0,R.jsx)(f.x,{px:2,fontSize:"sm",color:"gray.500",children:(0,R.jsx)(s.cC,{id:"miJbY4"})}),(0,R.jsx)(j.R,{})]})]})})},L=function(e){var n=e.isEveryone,t=(0,w.useState)(!1),r=t[0],i=t[1],a=(0,w.useState)(!1),c=a[0],l=a[1],d=(0,w.useState)(!1),u=d[0],f=d[1];return((0,w.useEffect)(function(){!r&&n&&(l(!0),i(!0),setTimeout(function(){l(!1)},3e3))},[n,r]),n)?(0,R.jsx)(b.xu,{fontSize:"sm",color:"",px:2,mr:2,children:(0,R.jsx)(C.kH,{label:(0,R.jsx)(s.cC,{id:"w7dTyp"}),isOpen:u||c,children:(0,R.jsx)(b.xu,{mr:2,px:1,bg:"green.300",color:"green.900",borderRadius:"full",onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)},children:(0,R.jsx)(y.G,{icon:o.Md})})})}):(0,R.jsx)(b.xu,{fontSize:"sm",color:"gray.700",pr:4,children:(0,R.jsx)(y.G,{icon:o.Md})})}},74624:function(e,n,t){t.d(n,{U:function(){return z}});var r=t(81333),i=t(60670),o=t(54728),s=t(51434),a=t(94301),c=t(91333),l=t(10344),d=t(49929),u=t(2784),f=t(23313),p=t(26087),h=t(2875),x=t(10710),m=t(60923),g=t(23015),v=t(34860),j=t(51823),b=t(25298),y=t(53738),C=t(71354),O=t(98841),w=t(25925),k=t(6563),S=t(52322),E=(0,O.E)(y.xu),I=function(e){var n=e.commentFeedItems,t=e.editor,r=e.doc,i=e.user;return t&&i?(0,S.jsx)(C.K,{p:2,children:(0,S.jsx)(w.M,{initial:!1,children:n.map(function(e){return(0,S.jsx)(E,{layout:!0,initial:{opacity:0,scale:.85},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.85},bg:"gray.100",borderColor:"gray.200",borderWidth:"1px",borderRadius:"md",shadow:"sm",children:(0,S.jsx)(k.q,{comment:e,editor:t,selfUser:i,docId:r.id,userCanComment:!1,instanceType:"notification"},e.id)},e.id)})})}):null},P=t(95235),D=t(55479),A=t(38140),T=t(37914);function R(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?R(Object(t),!0).forEach(function(n){(0,P.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var M=function(e){return!!e.comment&&null!==e.timeout},L=function(e){var n=e.user,t=e.docId,i=e.docComments,o=void 0===i?[]:i,s=e.pauseExiration,a=void 0!==s&&s,c=e.duration,l=void 0===c?5e3:c,d=(0,D.p)(),p=null==n?void 0:n.id,h=(0,u.useMemo)(function(){if(!p)return null;var e=new A.default(T.v.KNOCK_PUBLIC_KEY);return e.authenticate(p),e},[p]),x=(0,u.useState)({}),m=x[0],g=x[1],v=(0,u.useRef)(!0),j=(0,u.useRef)(a);j.current=a,(0,u.useEffect)(function(){return function(){v.current=!1}},[]);var b=(0,u.useCallback)(function(){return g({})},[]),y=(0,u.useCallback)(function(e){g(function(n){return Object.entries(n).reduce(function(n,t){var i=(0,r.Z)(t,2),o=i[0],s=i[1];return(!0===e?-1===s.timeout:o===e)||(n[o]=s),n},{})})},[]);return(0,u.useEffect)(function(){a||y(!0)},[y,a]),(0,u.useEffect)(function(){Object.entries(m).forEach(function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1],s=i.entry;if(null===i.timeout){var a=s.data.commentId,c=null==o?void 0:o.find(function(e){return e.id===a});if(c){var d=setTimeout(function(){v.current&&(j.current?g(function(e){var n=_({},e);return n[t].timeout=-1,n}):y(t))},l);g(function(e){return _(_({},e),{},(0,P.Z)({},t,{entry:s,comment:c,timeout:d}))})}}})},[m,o,l,y]),(0,u.useEffect)(function(){if(h&&t){var e=h.feeds.initialize(T.v.KNOCK_FEED_ID,{source:"new-comment",status:"unseen"}),n=e.listenForUpdates();e.on("messages.new",function(n){var i=n.entries,o=(0,r.Z)(i,1)[0];o.data.docId===t&&(g(function(e){return _(_({},e),{},(0,P.Z)({},o.id,{entry:o,timeout:null}))}),e.markAsSeen(o).then(function(){console.debug("New notification marked as seen")}).catch(function(e){console.error("Unable to mark notification as seen",e)}))});var i=f.C9N.on("status",function(e){var n=e.isConnected,t=h.client();n?t.connectSocket():t.disconnectSocket()});return function(){i(),n()}}},[t,d,h]),{reset:b,comments:Object.values(m).filter(M).map(function(e){return e.comment})}},z=function(e){var n,t=e.toggleCommentsPanel,y=e.isCommentsPanelOpen,C=e.doc,O=e.mode,w=(0,x.SE)().user,k=(0,m._i)().editor,E=(0,v.XI)(),P=(0,r.Z)(E,2),D=P[0],A=P[1],T=L({user:w,docId:null==C?void 0:C.id,docComments:null==C?void 0:C.comments,pauseExiration:A}),R=T.comments,_=T.reset,M=!!(k&&C&&C.comments);(0,u.useEffect)(function(){if(M){var e=(0,j.sY)().commentId;e&&h.pw.emit(h.TI.OPEN_POPUP_COMMENT,{commentId:e,highlightComment:!0})}},[M]),(0,u.useEffect)(function(){(y||O===p.q.SLIDE_VIEW)&&_()},[y,_,O]);var z=!!R.length&&!y&&O!==p.q.SLIDE_VIEW,N=(null==C?void 0:null===(n=C.comments)||void 0===n?void 0:n.filter(function(e){return e.status===f.Ux9.Open}).length)||0;return(0,S.jsxs)(o.J,{isLazy:!0,lazyBehavior:"keepMounted",returnFocusOnClose:!1,isOpen:z,placement:"bottom",children:[(0,S.jsx)(s.x,{children:(0,S.jsx)(b.h,{onMouseDown:g.br,onClick:t,icon:(0,S.jsx)(d.G,{icon:i.Mz}),isActive:y,"aria-label":y?"Hide comments":"Show comments",borderRadius:5,children:N})}),(0,S.jsx)(a.h,{children:C&&(0,S.jsxs)(c.y,{bg:"white",shadow:"lg",border:"none",ref:D,children:[(0,S.jsx)(l.Q,{bg:"white"}),(0,S.jsx)(I,{editor:k,user:w,commentFeedItems:R,doc:C})]})})]})}},5735:function(e,n,t){t.d(n,{u:function(){return u}});var r=t(75695),i=t(55452),o=t(11919),s=t(49929),a=t(55966),c=t(81234),l=t(25298),d=t(52322),u=function(){return(0,d.jsx)(o.k,{children:(0,d.jsx)(a.kH,{closeOnMouseDown:!1,closeOnClick:!1,label:(0,d.jsx)(i.cC,{id:"EVnzPs"}),children:(0,d.jsx)(l.r,{"data-guider-highlight":"design-partner-button","aria-label":"Edit with AI",colorScheme:"trueblue",variant:"plain",onClick:function(){c.T.emit("toggle",{})},icon:(0,d.jsx)(s.G,{icon:r.KC})})})})}},45390:function(e,n,t){t.d(n,{a:function(){return d}});var r=t(53738),i=t(98841),o=t(25925),s=t(46358),a=t(62141),c=t(52322),l=(0,i.E)(r.xu),d=function(){var e=(0,s.CG)(a.WI),n=(0,s.CG)(a.yn);return(0,c.jsx)(o.M,{initial:!1,children:e&&n&&(0,c.jsx)(l,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},position:"absolute",pointerEvents:"none",borderTop:"solid ".concat(4,"px ").concat(e.color),top:0,left:0,bottom:0,right:0,height:"var(--100vh)"})})}},47090:function(e,n,t){t.d(n,{T:function(){return eW}});var r=t(95235),i=t(60697),o=t(2885),s=t(47557),a=t(55452),c=t(78116),l=t(56915),d=t(16796),u=t(64827),f=t(92619),p=t(2167),h=t(89190),x=t(73848),m=t(24798),g=t(53738),v=t(84520),j=t(95085),b=t(49929),y=t(55966),C=t(2784),O=t(30118),w=t(46358),k=t(2875),S=t(21529),E=t(62141),I=t(6985),P=t(81333),D=t(8097),A=t(60831),T=t(69943),R=t(97968),_=t(34302),M=t(87254),L=t(71354),z=t(40110),N=t(9088),Z=t(30893),G=t(45650),F=t(40771),U=t(63849),W=t(2575),H=t(91012),V=t(4036),B=t(8283),q=t(50390),K=t(71193),Y=t(54336),J=t(11919),Q=t(81170),X=t(52322);function $(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function ee(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var en=function(e){var n=e.updateDocSetting,t=(0,w.CG)(E.US),r=t.defaultFullBleed,i=t.defaultContentWidth,s=t.presentBackdrop,c=t.cardDimensions,l=(0,Q.l)(c);return(0,X.jsxs)(L.K,{spacing:5,mt:4,divider:(0,X.jsx)(z.i,{}),children:[(0,X.jsx)(et,{title:M.ag._({id:"jBvtuq"}),description:M.ag._({id:"Q3Qdcd"}),icon:_.qn,control:(0,X.jsxs)(N.v,{isLazy:!0,children:[(0,X.jsx)(Z.j,{minW:28,as:G.z,size:"sm",variant:"plain",leftIcon:(0,X.jsx)(b.G,{icon:l.icon,fixedWidth:!0}),rightIcon:(0,X.jsx)(b.G,{icon:D.pt}),style:{marginLeft:"1rem"},children:l.label()}),(0,X.jsx)(F.q,{maxW:"400px",children:(0,X.jsx)(U._,{value:c,type:"radio",onChange:function(e){n("cardDimensions",e)},children:Object.entries(Q.b).map(function(e){var n=(0,P.Z)(e,2),t=n[0],r=n[1],i=r.label,o=r.description;return(0,X.jsxs)(W.i,{value:t,children:[(0,X.jsxs)(H.x,{children:[i(),"fluid"===t&&(0,X.jsxs)(X.Fragment,{children:[" ",(0,X.jsx)(V.C,{colorScheme:"gray",ml:1,children:(0,X.jsx)(a.cC,{id:"ovBPCi"})})]})]}),(0,X.jsx)(H.x,{fontSize:"xs",color:"gray.500",children:o()})]},t)})})})]})}),(0,X.jsx)(et,{title:M.ag._({id:"lklIf1"}),description:M.ag._({id:"aJ+ISV"}),icon:R.dH,value:"lg"===i,onChange:function(e){return n("defaultContentWidth",e?"lg":void 0)}}),(0,X.jsx)(et,{title:M.ag._({id:"lsVq2Z"}),description:M.ag._({id:"u/0NJZ"}),icon:T.r9,value:"full"===r,onChange:function(e){return n("defaultFullBleed",e?"full":void 0)}}),(0,X.jsx)(et,{title:M.ag._({id:"7VfbQM"}),description:M.ag._({id:"XZHPlI"}),icon:o.UH,value:s,onChange:function(e){return n("presentBackdrop",e)}}),(0,X.jsxs)(L.K,{children:[(0,X.jsx)(H.x,{fontSize:"xs",color:"gray.600",children:(0,X.jsx)(a.cC,{id:"ymPKi7"})}),(0,X.jsxs)(B.U,{alignItems:"flex-start",spacing:"4",children:[(0,X.jsx)(ei,{label:M.ag._({id:"wl99H6"}),cardDimensions:l,isWide:"lg"===i,showBackdrop:"full"!==r,scaleCardUp:!1}),(0,X.jsx)(ei,{label:M.ag._({id:"GWjDlt"}),cardDimensions:l,isWide:"lg"===i,showBackdrop:s&&"full"!==r,scaleCardUp:!s||"full"===r})]})]})]})},et=function(e){var n=e.title,t=e.description,r=e.icon,i=e.children,o=e.helpDescription,s=e.value,a=e.onChange,c=e.control;return(0,X.jsxs)(B.U,{alignItems:"flex-start",spacing:2,children:[r&&(0,X.jsx)(H.x,{fontSize:"lg",width:8,maxW:8,children:(0,X.jsx)(b.G,{icon:r,fixedWidth:!0})}),(0,X.jsxs)(L.K,{spacing:4,flex:1,children:[(0,X.jsxs)(L.K,{spacing:1,children:[(0,X.jsxs)(q.X,{size:"sm",fontWeight:"semibold",children:[n," ",o?(0,X.jsx)(y.Yq,{label:o,ml:1}):null]}),(0,X.jsx)(H.x,{fontSize:"xs",color:"gray.600",children:t})]}),i]}),a&&(0,X.jsx)(K.r,{isChecked:s,onChange:function(e){return a(e.target.checked)}}),c]})},er=function(e){var n=e.hideExtraLines;return(0,X.jsxs)(L.K,{w:"100%",py:2,px:2.5,children:[(0,X.jsx)(g.xu,{w:20,h:1.5,bg:"gray.200"}),(0,X.jsxs)(B.U,{flex:"1",alignItems:"flex-start",children:[(0,X.jsx)(Y.o,{ratio:4/3,color:"gray.600",w:12,bg:"gray.200",children:(0,X.jsx)(g.xu,{fontSize:"lg",children:(0,X.jsx)(b.G,{icon:A.Vm})})}),(0,X.jsxs)(L.K,{flex:"1",spacing:"1",children:[(0,X.jsx)(g.xu,{h:1,bg:"gray.200"}),(0,X.jsx)(g.xu,{h:1,bg:"gray.200"}),(0,X.jsx)(g.xu,{h:1,bg:"gray.200"}),(0,X.jsx)(g.xu,{w:n?"80%":"100%",h:1,bg:"gray.200"}),!n&&(0,X.jsx)(g.xu,{w:"80%",h:1,bg:"gray.200"})]})]})]})},ei=function(e){var n=e.cardDimensions,t=e.showBackdrop,r=e.isWide,i=e.label,o=e.scaleCardUp,s={boxShadow:"".concat(t?"sm":""),w:"".concat(r?"85%":"65%"),mx:"auto",borderRadius:"sm",bg:"white",transform:"".concat(o?"scale(1.15)":"none")};return(0,X.jsxs)(L.K,{flex:"1",alignItems:"center",sx:{"*":{transition:"all 0.2s ease"}},spacing:1.5,maxW:"50%",mx:"auto",children:[(0,X.jsx)(J.k,{bg:t?"gray.200":"white",borderWidth:"1px",borderColor:"gray.200",width:"100%",minH:32,borderRadius:"sm",alignItems:"center",py:2,overflow:"hidden",children:n.aspectRatio?(0,X.jsx)(Y.o,ee(ee({},s),{},{ratio:n.aspectRatio,children:(0,X.jsx)(g.xu,{children:(0,X.jsx)(er,{hideExtraLines:r})})})):(0,X.jsx)(L.K,ee(ee({},s),{},{children:(0,X.jsx)(er,{hideExtraLines:r})}))}),(0,X.jsx)(H.x,{fontSize:"xs",color:"gray.700",children:i})]})},eo=t(72360),es=t(48322),ea=t(35634),ec=t(74928),el=t(35258),ed=function(e){var n=e.editor,t=(0,w.CG)(E.Pu),r=(0,w.CG)(E.XV),i=(0,C.useCallback)(function(e){null==n||n.commands.updateNestedAttributesAtPos(0,e)},[n]);return(0,X.jsx)(el.o,{editor:n,background:r,updateNestedAttributes:i,defaultMessage:(0,X.jsxs)(eo.b,{children:[(0,X.jsx)(es.z,{}),(0,X.jsx)(a.cC,{id:"dyXYfJ"})]}),isDark:(0,ea.wj)(t),isValidSource:ec.Rr})},eu=t(2046),ef=t(70287),ep=t(27777),eh=t(25793),ex=t(69232),em=t(23313),eg=t(65185),ev=t(98875),ej=t(87796),eb=t(51331),ey=t(78308),eC=t(52596),eO=t(85041),ew=t(55479),ek=t(93319),eS=t(21891),eE=t(92936),eI=t(79821),eP=t(76648),eD=t(60807),eA=t(84103),eT=t(42879),eR=t(68197),e_=t(47827),eM=t(21357),eL=function(e,n){var t;return null==e?void 0:null===(t=e.routes.find(function(e){return e.docId===n}))||void 0===t?void 0:t.path},ez=function(){var e=(0,ew.p)(),n=(0,e_.AA)().openPageSetup,t=(0,ev.ye)("sites"),r=(0,w.CG)(eR.yx),i=(0,w.CG)(eM.lH),o=(0,em.qbt)(),s=(0,P.Z)(o,2),c=s[0],l=s[1].loading,d=eL(i,null==r?void 0:r.id),u=(0,C.useState)(function(){return(0,eT.es)(d||"")}),f=u[0],p=u[1],h=(0,C.useState)(function(){return(0,eT.es)(d||"")}),x=h[0],m=h[1],v=(0,eT.gT)({routes:(null==i?void 0:i.routes)||[],path:(0,eT.fJ)(f),docId:null==r?void 0:r.id}),j=!!v,b=x!==f&&!j,y=(0,C.useCallback)(function(){p(x)},[x]),O=(0,C.useCallback)(function(){if(b){if(!(null!=i&&i.id)||!(null!=r&&r.id)){console.error("Missing site or doc");return}var n=(0,eT.fJ)(f);c({variables:{input:{siteId:i.id,docId:r.id,path:n}},refetchQueries:["GetSite"]}).then(function(){m(f),p(f)}).catch(function(n){e({status:"error",title:(0,X.jsx)(a.cC,{id:"dl5vwx"}),description:n.message}),console.error("[UrlSlugForm] Error setting route",n.message)})}},[b,null==r?void 0:r.id,f,c,null==i?void 0:i.id,e]);return t?(0,X.jsxs)(L.K,{pb:6,children:[(0,X.jsx)(L.K,{direction:"row",children:(0,X.jsxs)(H.x,{children:[(0,X.jsx)(a.cC,{id:"dq8+qI"})," "]})}),(0,X.jsx)(ek.L,{}),(0,X.jsx)(L.K,{spacing:2,children:(0,X.jsx)(B.U,{spacing:1,children:(0,X.jsxs)(eu.NI,{as:"fieldset",isInvalid:j,children:[(0,X.jsx)(B.U,{children:(0,X.jsxs)(eS.B,{children:[(0,X.jsx)(eE.Ui,{children:"/"}),(0,X.jsx)(ep.I,{isDisabled:l,bg:"white",flex:2,value:f,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),O())},onChange:function(e){p((0,eT.pi)(e.currentTarget.value))}}),(0,X.jsx)(eI.R,{in:b,unmountOnExit:!0,children:(0,X.jsx)(g.xu,{ml:2,children:(0,X.jsxs)(eP.h,{w:"100%",children:[(0,X.jsx)(G.z,{variant:"solid",isLoading:l,isDisabled:j,onClick:O,children:(0,X.jsx)(a.cC,{id:"tfDRzk"})}),(0,X.jsx)(G.z,{onClick:y,children:(0,X.jsx)(a.cC,{id:"dEgA5A"})})]})})})]})}),v?(0,X.jsx)(eD.J1,{justifyContent:"flex-end",alignItems:"flex-start",children:(0,X.jsx)(H.x,{fontSize:"xs",children:(0,X.jsx)(a.cC,{id:"DQaTdC",components:{0:(0,X.jsx)(eA.r,{textDecoration:"underline",onClick:function(){return n(v.docId,"preview")}})}})})}):(0,X.jsx)(eu.Q6,{fontSize:"sm",children:(0,X.jsx)(L.K,{alignContent:"flex-start",justifyContent:"space-between",direction:"row",w:"100%",children:(0,X.jsx)(L.K,{spacing:1,children:(0,X.jsx)(H.x,{color:"gray.500",children:(0,X.jsx)(a.cC,{id:"ZMlbHK"})})})})})]})})})]}):(0,X.jsx)(X.Fragment,{})},eN=t(34860),eZ=function(e){var n=e.updateDocSetting,t=(0,w.CG)(E.US).metaDescription,r=(0,ev.ye)("sites"),i=(0,w.CG)(E.yx),o=(0,w.CG)(eg.cn),s=(0,w.CG)(eg.$4),c=(0,C.useState)(function(){return(null==i?void 0:i.title)||""}),l=c[0],d=c[1],u=(0,C.useState)(function(){return t||""}),f=u[0],p=u[1],h=(0,em.D1_)(),x=(0,P.Z)(h,1)[0],m=(0,C.useCallback)(function(e){i&&x({variables:{id:i.id,title:e},refetchQueries:r?["GetSite"]:void 0})},[i,r,x]),v=(0,eN.Kt)(m,300),j=(0,C.useCallback)(function(e){d(e.target.value.substring(0,eO.S8)),v(e.target.value.substring(0,eO.S8))},[v]),b=(0,C.useCallback)(function(e){n("metaDescription",e)},[n]),y=(0,eN.Kt)(b,300),O=(0,w.CG)(eg.NN),k=null==O?void 0:O.previewUrl,S=(0,eb.dU)(null==i?void 0:i.organization),I=(0,ej.U)(l||o,S),D=(0,ej.V)(f||s,S);return(0,X.jsxs)(L.K,{spacing:4,children:[(0,X.jsxs)(eu.NI,{children:[(0,X.jsxs)(B.U,{justifyContent:"center",children:[(0,X.jsx)(ef.l,{flex:"1",children:(0,X.jsx)(a.cC,{id:"MHrjPM"})}),(0,X.jsx)(ex.W,{length:l.length||0,idealLength:eO.si,maxLength:eO.S8})]}),(0,X.jsx)(ep.I,{value:l,placeholder:o||M.ag._({id:"bTzMt5"}),_placeholder:{opacity:1,color:"gray.500"},onKeyDown:function(e){"Enter"===e.key&&m(l)},onChange:j,"data-title-input":!0})]}),(0,X.jsx)(ez,{}),(0,X.jsxs)(eu.NI,{children:[(0,X.jsxs)(B.U,{justifyContent:"center",children:[(0,X.jsx)(ef.l,{flex:"1",children:(0,X.jsx)(a.cC,{id:"Nu4oKW"})}),(0,X.jsx)(ex.W,{length:f.length||0,idealLength:eO.cl,maxLength:eO.Us})]}),(0,X.jsx)(eh.g,{bg:"white",rows:4,value:f,placeholder:s||M.ag._({id:"2VBqT4"}),onChange:function(e){p(e.target.value.substring(0,eO.Us)),y(e.target.value.substring(0,eO.Us))}})]}),(0,X.jsxs)(g.xu,{p:4,pt:3,bg:"gray.100",borderRadius:"md",children:[(0,X.jsxs)(L.K,{spacing:2,mb:4,children:[(0,X.jsx)(H.x,{size:"sm",children:(0,X.jsx)(a.cC,{id:"h8sMnd"})}),(0,X.jsx)(eG,{title:I,description:D,screenshotUrl:k})]}),(0,X.jsxs)(L.K,{spacing:2,children:[(0,X.jsx)(H.x,{size:"sm",children:(0,X.jsx)(a.cC,{id:"d3xOlk"})}),(0,X.jsx)(eF,{title:I,description:D,screenshotUrl:k}),(0,X.jsx)(H.x,{fontSize:"sm",color:"gray.500",children:(0,X.jsx)(a.cC,{id:"gkahtG"})})]})]}),(0,X.jsx)(eC.V,{label:(0,X.jsx)(a.cC,{id:"SDyz5I"}),segmentEvent:ey.AA.GAMMA_PRO_UPSELL_PAGE_SETUP_REMOVE_WATERMARK,doc:i})]})},eG=function(e){var n=e.title,t=e.description,r=e.screenshotUrl;return(0,X.jsxs)(g.xu,{cursor:"not-allowed",bg:"white",border:"1px solid",borderColor:"gray.200",borderRadius:"md",overflow:"hidden",children:[(0,X.jsx)(Y.o,{ratio:1200/630,bg:"gray.300",borderBottom:"1px solid",borderColor:"gray.200",children:(0,X.jsx)(g.xu,{bgColor:"gray.200",bgImage:"url(".concat(r,")"),backgroundSize:"cover",position:"relative"})}),(0,X.jsxs)(L.K,{px:4,py:3,spacing:1,children:[(0,X.jsx)(H.x,{fontSize:"md",fontWeight:"bold",noOfLines:2,children:n}),(0,X.jsx)(H.x,{fontSize:"xs",noOfLines:2,children:t})]})]})},eF=function(e){var n=e.title,t=e.description;return(0,X.jsxs)(L.K,{cursor:"not-allowed",bg:"white",border:"1px solid",borderColor:"gray.200",borderRadius:"md",overflow:"hidden",px:4,py:3,spacing:1,pos:"relative",children:[(0,X.jsx)(H.x,{color:"blue.600",fontSize:"lg",lineHeight:1.3,noOfLines:2,children:n}),(0,X.jsx)(H.x,{color:"gray.700",fontSize:"sm",noOfLines:3,children:t})]})},eU=["cards","background","preview"],eW=function(e){var n=e.editor,t=(0,w.CG)(E.ke),P=(0,O.M)({id:"pageSetupDisclosure"}),D=P.isOpen,A=P.onClose,T=P.onOpen,R=(0,C.useState)(0),_=R[0],M=R[1];(0,C.useEffect)(function(){var e=function(e){M(eU.indexOf(e)),T()},n=I.T.on("openPageSetup",e),t=k.pw.on(k.TI.OPEN_PAGE_SETUP,e);return function(){n(),t()}},[T,A]);var L=(0,S.A)(n),z=(0,C.useCallback)(function(e,t){null==n||n.commands.updateNestedAttributesAtPos(0,{settings:(0,r.Z)({},e,t)})},[n]);return(0,X.jsx)(y.Wk,{isDark:!1,children:(0,X.jsxs)(c.d,{returnFocusOnClose:!1,isOpen:D,placement:"right",onClose:A,size:"md",blockScrollOnMount:!1,children:[(0,X.jsx)(l.Z,{background:"none"}),(0,X.jsxs)(d.s,{"data-testid":"page-setup-drawer",onKeyDown:L,motionProps:{variants:{enter:{x:"0%",transition:{duration:.2}},exit:{x:"100%",transition:{duration:.1}}}},children:[(0,X.jsx)(u.o,{}),(0,X.jsx)(f.x,{children:(0,X.jsx)(a.cC,{id:"fvaOtb"})}),(0,X.jsx)(p.f,{overflowX:"hidden",children:(0,X.jsxs)(h.m,{variant:"soft-rounded",size:"sm",isFitted:!0,isLazy:!0,index:_,onChange:M,children:[(0,X.jsxs)(x.t,{children:[(0,X.jsxs)(m.O,{children:[(0,X.jsx)(g.xu,{mr:2,children:(0,X.jsx)(b.G,{icon:s.s2})}),(0,X.jsx)(a.cC,{id:"Ccpbzh"})]}),(0,X.jsxs)(m.O,{children:[(0,X.jsx)(g.xu,{mr:2,children:(0,X.jsx)(b.G,{icon:o.UH})}),(0,X.jsx)(a.cC,{id:"GtJbUa"})]}),(0,X.jsxs)(m.O,{children:[(0,X.jsx)(g.xu,{mr:2,children:(0,X.jsx)(b.G,{icon:i.g4})}),(0,X.jsx)(a.cC,{id:"rdUucN"})]})]}),(0,X.jsxs)(v.n,{children:[(0,X.jsx)(j.x,{p:2,mt:4,children:(0,X.jsx)(en,{editor:n,updateDocSetting:z},t)}),(0,X.jsx)(j.x,{p:2,mt:4,children:(0,X.jsx)(ed,{editor:n,updateDocSetting:z},t)}),(0,X.jsx)(j.x,{p:2,mt:4,children:(0,X.jsx)(eZ,{editor:n,updateDocSetting:z},t)})]})]})})]})]})})}},46231:function(e,n,t){t.d(n,{S:function(){return eh}});var r=t(12741),i=t(60697),o=t(26673),s=t(55452),a=t(9088),c=t(91012),l=t(30893),d=t(53738),u=t(94301),f=t(40771),p=t(82904),h=t(95258),x=t(8283),m=t(93319),g=t(4036),v=t(49929),j=t(55966),b=t(2784),y=t(56317),C=t(98875),O=t(75085),w=t(30118),k=t(32333),S=t(18748),E=t(35330),I=t(16092),P=t(92779),D=t(27901),A=t(10710),T=t(59734),R=t(95235),_=t(81333),M=t(49626),L=t(46973),z=t(55479),N=t(20010),Z=t(56915),G=t(48273),F=t(92619),U=t(64827),W=t(2167),H=t(11919),V=t(72360),B=t(48322),q=t(71354),K=t(76360),Y=t(75342),J=t(36895),Q=t(40110),X=t(80353),$=t(5632),ee=t(24021),en=t(23313),et=t(42879),er=t(93589),ei=t(52322);function eo(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function es(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?eo(Object(t),!0).forEach(function(n){(0,R.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eo(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ea=function(e){var n,t=e.title,r=e.site,i=e.docId,o="/".concat((0,er.IR)(t||"untitled"));return null!=r&&null!==(n=r.routes)&&void 0!==n&&n.find(function(e){return e.path===o})&&(o="".concat(o,"-").concat(i.slice(0,4))),o},ec={variant:"outline",transitionProperty:"all",transitionDuration:"normal",cursor:"pointer",boxShadow:"none",tabIndex:0,_hover:{shadow:"lg",borderColor:"trueblue.300",bg:"trueblue.50"},_focusVisible:{boxShadow:"none",outline:"none"},_focus:{boxShadow:"outline"}},el=function(e){var n=e.isOpen,t=e.onClose,r=e.doc,i=e.onCreateSiteClick,o=(0,A.SE)().currentWorkspace,a=(0,en.qbt)(),l=(0,_.Z)(a,1)[0],d=(0,b.useState)(!1),u=d[0],f=d[1],p=(0,en.VP0)(),h=(0,_.Z)(p,1)[0],g=(0,en.bBo)({variables:{workspaceId:null==o?void 0:o.id},skip:!(null!=o&&o.id)}),y=g.data,C=g.loading,w=(0,z.p)(),k=(0,$.useRouter)().push,S=null==y?void 0:y.sites,E=r&&r.orgAccess!==en.y3$.Manage,I=(0,b.useCallback)(function(e){f(!0);var n=null==S?void 0:S.find(function(n){return n.id===e}),t=r.id,i=ea({title:r.title,site:n,docId:t});h({variables:{id:t,orgAccess:en.y3$.Manage,themeId:null}}).then(function(){l({variables:{input:{siteId:e,docId:t,path:i}},refetchQueries:["GetSite"]}).then(function(){var n=(0,et.as)(e,t);console.debug("[PublishToWebModal] Doc added to site. Adding route then navigating to editor",t),w({position:"top",title:(0,ei.jsx)(s.cC,{id:"oMgC5V"}),description:(0,ei.jsx)(s.cC,{id:"/qBkEJ"}),status:"success",duration:5e3}),k(n)}).catch(function(e){w({position:"top",title:"Error",description:e.message,status:"error",duration:5e3}),f(!1)}).finally(function(){f(!1)})}).catch(function(e){w({position:"top",title:"Error",description:e.message,status:"error",duration:5e3}),f(!1)})},[r.id,r.title,k,l,S,w,h]),P=C||u;return(0,ei.jsx)(j.Wk,{isDark:!1,children:(0,ei.jsxs)(N.u_,{isOpen:n,onClose:t,size:"2xl",children:[(0,ei.jsx)(Z.Z,{}),(0,ei.jsxs)(G.h,{children:[(0,ei.jsx)(F.x,{children:(0,ei.jsx)(s.cC,{id:"TMYPtj"})}),(0,ei.jsx)(U.o,{}),(0,ei.jsxs)(W.f,{position:"relative",children:[P&&(0,ei.jsx)(H.k,{w:"100",h:"400px",maxH:"30vh",children:(0,ei.jsx)(ee.AA,{})}),E&&(0,ei.jsxs)(V.b,{status:"warning",mb:4,children:[(0,ei.jsx)(B.z,{}),(0,ei.jsx)(s.cC,{id:"FOQwny",values:{GAMMA_ARTIFACT_PROPER_NOUN:O.Yc}})]}),!P&&(0,ei.jsxs)(q.K,{spacing:4,children:[S&&S.length>0&&(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)(c.x,{fontSize:"lg",fontWeight:600,children:(0,ei.jsx)(s.cC,{id:"/yFyyN"})}),null==S?void 0:S.map(function(e){return(0,ei.jsx)(K.Z,es(es({onClick:function(){return I(e.id)},onKeyPress:function(n){"Enter"===n.key&&I(e.id)}},ec),{},{children:(0,ei.jsx)(Y.e,{children:(0,ei.jsxs)(x.U,{children:[(0,ei.jsxs)(q.K,{spacing:0,children:[(0,ei.jsxs)(x.U,{children:[e.faviconUrl&&(0,ei.jsx)(J.E,{w:"4",src:e.faviconUrl}),(0,ei.jsx)(c.x,{fontWeight:"600",children:e.name})]}),(0,ei.jsx)(c.x,{fontSize:"sm",color:"gray.500",children:(0,ei.jsx)(s.cC,{id:"MoI916",values:{GAMMA_ARTIFACT_PROPER_NOUN:O.Yc}})})]}),(0,ei.jsx)(m.L,{}),(0,ei.jsx)(v.G,{icon:L.eF})]})})}),e.id)}),(0,ei.jsxs)(x.U,{children:[(0,ei.jsx)(Q.i,{}),(0,ei.jsx)(c.x,{fontSize:"sm",color:"gray.500",children:(0,ei.jsx)(s.cC,{id:"ZAVklK"})}),(0,ei.jsx)(Q.i,{})]})]}),(0,ei.jsx)(K.Z,es(es({onClick:function(){i()},onKeyPress:function(e){"Enter"===e.key&&i()}},ec),{},{children:(0,ei.jsx)(Y.e,{children:(0,ei.jsxs)(x.U,{children:[(0,ei.jsxs)(q.K,{spacing:0,children:[(0,ei.jsx)(c.x,{fontWeight:"600",children:(0,ei.jsx)(s.cC,{id:"xaUIb2"})}),(0,ei.jsx)(x.U,{children:(0,ei.jsx)(c.x,{fontSize:"sm",color:"gray.500",children:(0,ei.jsx)(s.cC,{id:"pdnqNS",values:{GAMMA_ARTIFACT_PROPER_NOUN:O.Yc}})})})]}),(0,ei.jsx)(m.L,{}),(0,ei.jsx)(v.G,{icon:M.r8})]})})}))]})]}),(0,ei.jsx)(X.m,{})]})]})})},ed=t(31912),eu=t(23015),ef=t(25298),ep=t(6985),eh=function(e){var n,t,R=e.doc,_=e.showAnalytics,M=e.showSharePublic,L=void 0===M||M,z=e.showEmbed,N=void 0===z||z,Z=(0,w.M)({id:"titleModalDisclosure"});Z.isOpen,Z.onOpen,Z.onClose;var G=(0,w.M)({id:"analyticsModalDisclosure"}),F=G.isOpen,U=G.onClose,W=G.onOpen,H=(0,E.y)(),V=H.isSharePanelOpen,B=H.onSharePanelOpen,q=H.onSharePanelClose,K=H.view,Y=H.setView,J=(0,w.M)({id:"publishToWeb"}),Q=J.isOpen,X=J.onClose,$=J.onOpen,ee=(0,w.M)({id:"create-site-modal"}),en=ee.isOpen,et=ee.onOpen,er=ee.onClose,eo=(0,C.ye)("sites"),es=(0,A.SE)(),ea=es.user,ec=es.currentWorkspace,eh=(0,T._i)().editor,ex=(0,A.py)("view",R),em=(0,A.py)("edit",R),eg=(0,A.py)("manage",R),ev=(0,k.z$)(),ej=(0,I.ei)({showSharePublic:L,showEmbed:N});(0,b.useEffect)(function(){return ep.T.on("openSharePanel",function(e){var n=e.view;B(),Y(n)})},[B,Y]);var eb=(0,b.useCallback)(function(){null==ev||ev.track(k.AA.DOC_ANALYTICS_VIEWED,{docId:null==R?void 0:R.id,source:"share_panel",type:eg?"full":"personal"}),W()},[ev,eg,null==R?void 0:R.id,W]);if(!ex||!ea||!R)return null;var ey=R.collaborators||[],eC=R.channels||[],eO=(0,ed.Hs)((0,r.Z)(ey).sort(function(e,n){return e.user.id===ea.id?-1:n.user.id===ea.id?1:0}).map(function(e){return e.user.id===ea.id?"You":e.user.displayName||""}).concat(R.orgAccess?eC.map(function(e){return e.name||""}):[])),ew=(0,P.h_)(R,ea),ek=ew?(0,P.Xp)()[ew]:null,eS=(0,P.Gi)(R,ec),eE=eo&&!R.site&&eg;return null===ek?(console.error("[SharePanel] Unknown VisibilityValue for doc",R),null):(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsxs)(a.v,{children:[(0,ei.jsx)(j.kH,{label:(0,ei.jsxs)(ei.Fragment,{children:[eS&&(0,ei.jsx)(c.x,{fontWeight:"bold",children:(0,ei.jsx)(s.cC,{id:"OS9x6e",values:{GAMMA_ARTIFACT_PROPER_NOUN:O.Yc}})}),ek.title(null==R?void 0:null===(n=R.organization)||void 0===n?void 0:n.name)?(0,ei.jsx)(c.x,{children:ek.title(null==R?void 0:null===(t=R.organization)||void 0===t?void 0:t.name)}):null,(0,ei.jsx)(c.x,{fontSize:"xs",children:ek.subtitle?ek.subtitle(eO||""):""})]}),children:(0,ei.jsx)(l.j,{onFocus:function(e){return e.preventDefault()},as:ef.h,"data-guider-highlight":"share-button",onMouseDown:eu.br,icon:(0,ei.jsx)(d.xu,{children:(0,ei.jsx)(S.aA,{visibility:ek,isFromOtherOrg:eS})}),rightIcon:(0,ei.jsx)(v.G,{"aria-label":"",icon:o.pt}),isDisabled:!em,children:(0,ei.jsx)(s.cC,{id:"Z8lGw6"})})}),(0,ei.jsx)(u.h,{children:(0,ei.jsxs)(f.q,{zIndex:"popover",maxH:"100vh",minW:"280px",overflow:"auto",children:[ej.map(function(e){return(0,ei.jsx)(p.s,{onClick:function(){ep.T.emit("openSharePanel",{view:e.viewKey})},icon:(0,ei.jsx)(v.G,{icon:e.icon,fixedWidth:!0}),children:e.label},e.viewKey)}),eE&&(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)(h.R,{}),(0,ei.jsx)(p.s,{icon:(0,ei.jsx)(v.G,{icon:i.g4}),onClick:$,children:(0,ei.jsxs)(x.U,{children:[(0,ei.jsx)(s.cC,{id:"TMYPtj"}),(0,ei.jsx)(m.L,{}),(0,ei.jsx)(g.C,{colorScheme:"green",children:"Beta"})]})})]})]})})]}),eE&&Q&&(0,ei.jsx)(el,{isOpen:Q,onClose:X,doc:R,onCreateSiteClick:et}),(0,ei.jsx)(S.WQ,{doc:R,editor:eh,isSharePanelOpen:V,onSharePanelOpen:B,onSharePanelClose:q,onAnalyticsPanelOpen:eb,view:K,setView:Y,showAnalytics:void 0===_||_,showSharePublic:L,showEmbed:N}),F&&(0,ei.jsx)(y.r,{doc:R,onSharePanelOpen:B,onAnalyticsPanelClose:U,isAnalyticsPanelOpen:F,mode:eg?"full":"personal"}),eE&&en&&(0,ei.jsx)(D.M,{isOpen:en,onClose:er,existingDocId:R.id})]})}},10939:function(e,n,t){t.d(n,{OM:function(){return w},Zd:function(){return O},rU:function(){return k}});var r=t(55452),i=t(55479),o=t(11919),s=t(12221),a=t(91012),c=t(54073),l=t.n(c),d=t(18149),u=t.n(d),f=t(2784),p=t(98621),h=t.n(p),x=t(53923),m=t(46358),g=t(30341),v=t(62141),j=t(95472),b=t(59131),y=t(17477),C=t(52322),O=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body",t=(0,m.TL)(),r=(0,g.As)("editor"),i=(0,x.nO)(),o=(0,m.CG)(v.yn,u()),s=(0,m.CG)(v.k8,u()),a=!!(null==s?void 0:s.pos);(0,f.useEffect)(function(){if(e){var n=l()(function(){o&&t((0,v.Qx)({attached:!1}))},500,{leading:!0}),r=(0,y.B$)({topOffset:100,requiredCookie:"spotlightScrollDebug=true"});return document.addEventListener("wheel",n,!0),function(){r(),n.cancel(),document.removeEventListener("wheel",n,!0)}}},[e,t,o,a,n]);var c=(0,m.CG)(v.ks,u());(0,f.useEffect)(function(){if(e&&!c){var n=l()(function(){if(!r.inProgress){var n=(0,j.lI)(e,100,i);if(!n){console.debug("[useHandleScrollAndSelectionChange][handleScroll] Unable to find topPosPct.");return}t((0,v.Us)(n))}},250,{trailing:!0,maxWait:500}),o=l()(function(){if(!(e.state.selection instanceof b.c)){var n=document.querySelector(r.scrollSelector||""),i=null==n?void 0:n.getBoundingClientRect(),o=e.state.selection.from,s=(0,j.Sh)(e,o);if(!n||!i||!s){console.debug("[useHandleScrollAndSelectionChange][handleSelectionChange] missing data",{domNodeToUse:s});return}var a=s.getBoundingClientRect(),c=parseFloat(((e.view.coordsAtPos(o).top-a.y)/a.height).toFixed(2));t((0,v.Us)({pos:o,pct:c}))}},250,{trailing:!0,maxWait:500});return n(),e.on("selectionUpdate",o),window.addEventListener("scroll",n,!0),function(){e.off("selectionUpdate",o),window.removeEventListener("scroll",n,!0)}}},[e,t,r,c,i])},w=function(){var e=(0,i.p)(),n=(0,m.TL)();return(0,f.useCallback)(function(t){var i=t.collaborator,c=t.localIsFollowing,l=t.localIsAttached,d={attached:!0};c?l?d.following=null:e.closeAll():(d.following=i.sessionId,e.closeAll(),e({duration:2e3,position:"bottom",render:function(){return(0,C.jsxs)(o.k,{bg:"gray.50",p:3,px:6,align:"center",borderRadius:"md",shadow:"md",children:[(0,C.jsx)(s.q,{size:"sm",src:i.profileImageUrl,border:"solid 2px ".concat(i.color),color:h()(i.color).isDark()?"white":"black",bg:i.color}),(0,C.jsx)(a.x,{ml:2,children:(0,C.jsx)(r.cC,{id:"lULvWe",values:{0:i.name}})})]})}})),console.debug("[CollaboratorsPanel] Clicked on collaborator ".concat(i.name,". Setting following to ").concat(d)),n((0,v.Qx)(d))},[e,n])},k=function(e){var n=e.editor,t=e.collaborators,r=e.user,i=(0,f.useRef)(!1),o=w(),s=new URLSearchParams(window.location.search),a=s.get("following_id"),c=s.get("follow_on_start");(0,f.useEffect)(function(){if(!i.current&&c&&(null==r?void 0:r.id)!==a&&n){var e=t.find(function(e){return e.id===a});e&&(o({collaborator:e,localIsAttached:!1,localIsFollowing:!1}),i.current=!0)}},[a,c,n,t,r,o])}},34684:function(e,n,t){t.d(n,{J:function(){return y},P:function(){return b}});var r=t(55452),i=t(55479),o=t(87202),s=t(2784),a=t(46358),c=t(30341),l=t(47592),d=t(34264),u=t(42734),f=t(47191),p=t(62141),h=t(95472),x=t(60923),m=t(17477),g=t(52322),v=(0,o.ZP)("mod+S"),j=(0,o.ZP)("mod+shift+O"),b=function(){var e=(0,i.p)();(0,s.useEffect)(function(){var n=function(n){v(n)&&(n.preventDefault(),e.isActive("save_toast")||e({id:"save_toast",title:(0,g.jsx)(r.cC,{id:"4ebE67"}),status:"success",duration:5e3,isClosable:!0}))},t=(0,m.B$)({requiredCookie:"cardCollapseDebug=true"});return window.addEventListener("keydown",n),function(){null==t||t(),window.removeEventListener("keydown",n)}},[e])},y=function(){var e=(0,a.qr)(),n=(0,a.TL)(),t=(0,x._i)().editor;(0,s.useEffect)(function(){if(t){var r=function(r){if(j(r)){r.preventDefault();var i=e.getState(),o=i.TipTap,s=o.cardIdMap,a=o.cardIds,c=o.memoState.expandedCards,d=(0,p.i2)(i),u=a.reduce(function(e,n){var t=!0===c[n],r=s.parents[n]||[],i=r.length>0,o=!d||r.includes(d);return i&&o&&(e.cardIds.push(n),e.total++,e.expanded+=t?1:0),e},{total:0,expanded:0,cardIds:[]}),f=u.total,h=u.expanded,x=u.cardIds;n((0,p.bj)({disable:!0})),setTimeout(function(){n((0,p.bj)({disable:!1}))},100);var m=f===h;C(t,100,!m),(0,l.Nn)(x,m)}};return window.addEventListener("keydown",r),function(){window.removeEventListener("keydown",r)}}},[n,e,t])},C=function(e,n,t){for(var r=(0,c.cC)("editor"),i=void 0,o=200;o>0;o-=25){var s,a=(0,h.Je)(e,r.scrollSelector,o);if(null!==(s=a.pos)&&void 0!==s&&s.pos){var l=void 0;e.state.doc.nodeAt(a.pos.pos)?l=a.pos.pos:e.state.doc.nodeAt(a.pos.inside)&&(l=a.pos.inside),l&&(!i||l>i)&&(i=l)}}if(!i){console.warn("[pinPageDuringAnimation] No result for getTopCenterIshNode");return}var d=O(e,i,t);if(!d){console.warn("[pinPageDuringAnimation] No element for getElementToPin");return}(0,m.wO)({element:d,requiredCookie:"cardCollapseDebug=true"});var u=+new Date,f=r.scroller.scrollTop,p=(0,m.LY)(d,r.scrollSelector),x=f-p,g=x<0?0:Math.max(x+200,0);!function e(){if(d){var t=(0,m.LY)(d,r.scrollSelector);r.scroller.scroll({top:f+(t-p-g)}),+new Date-u<n&&requestAnimationFrame(e)}}()},O=function(e,n,t){var r,i=e.state.doc.resolve(n),o=e.state.doc.nodeAt(n),s=(0,h.Sh)(e,n);if(!o){console.warn("[getElementToPin] nodeAt null for $pos",i);return}var a=(0,h.nv)(i,function(){return!0}).reverse();for(a.push({start:i.start(i.depth+1),pos:n,depth:i.depth,node:o});a.length;){var c=a.shift();if(c){var l=(0,d.KH)(c.node),p=(0,u.SA)(c.node),x=(0,f.CU)(c.node),m=l||c.node.isAtom?c.pos:c.start;if(s=(0,h.Sh)(e,m),!t&&l&&c.depth>2||p||x)break}}for(;(null===(r=s)||void 0===r?void 0:r.offsetParent)===null&&s.parentElement;)s=s.parentElement;return s}},28615:function(e,n,t){t.d(n,{j:function(){return h}});var r=t(5632),i=t(2784),o=t(1368),s=t(46358),a=t(41261),c=t(28463),l=t(62141),d=t(26087),u=t(43227),f=t(59734),p=t(51823),h=function(){var e=(0,f._i)().editor,n=(0,r.useRouter)(),t=(0,s.qr)();(0,i.useEffect)(function(){if(e){n.beforePopState(function(e){return!e.as.startsWith("/docs/")});var r=o.fI.on("changed",function(n){var r,i=(0,p.sY)(n.url).cardId,o=t.getState(),s=(0,l.gh)(o);if(console.debug("[useHandleCardHash][handleURLChange]",{payload:n,cardId:i}),s===d.q.DOC_VIEW&&null!==(r=n.state)&&void 0!==r&&r.fromPos&&"pop"===n.method){var u=n.state,f=u.fromPos,h=u.fromPct;e.chain().scrollToPositionInCard(f,h||void 0).command(function(e){var n=e.tr;return(0,c.B0)(f)(n),!0}).run()}else{var x=(0,l.xb)(o)[0];(0,a.YS)({cardId:i||x,editor:e})}});return function(){n.beforePopState(function(){return!0}),r()}}},[e,n,t]),(0,i.useEffect)(function(){if(e){var n=(0,p.sY)(window.location.href).cardId;n&&(0,u.D)({cardId:n,method:"replace"})}},[e])}},60923:function(e,n,t){t.d(n,{dM:function(){return cB},Ur:function(){return cE},nz:function(){return c3},_i:function(){return nV._i}});var r,i,o,s,a=t(95235),c=t(93812),l=t(55452),d=t(87254),u=t(11919),f=t(91012),p=t(53738),h=t(34676),x=t(49929),m=t(55966),g=t(97729),v=t.n(g),j=t(2784),b=t(43997),y=t(23313),C=t(43602),O=t(64288),w=t(87796),k=t(11197),S=t(81333),E=t(29106),I=t(75944),P=t(54728),D=t(51434),A=t(67887),T=t(91333),R=t(83897),_=t(96412),M=t(13089),L=t(41701),z=t(90129),N=t(29017),Z=t(48200),G=t(30733),F=t.n(G),U=t(12436),W=t.n(U),H=function(e){(0,z.Z)(r,e);var n,t=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,Z.Z)(r);if(n){var i=(0,Z.Z)(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return(0,N.Z)(this,e)});function r(){var e;return(0,_.Z)(this,r),e=t.call(this),(0,a.Z)((0,L.Z)(e),"throttled",void 0),e.throttled=W()(function(n){e.emit("move",n)},200,{leading:!0}),document.addEventListener("mousemove",e.throttled),e}return(0,M.Z)(r,[{key:"cleanup",value:function(){document.removeEventListener("mousemove",this.throttled)}}]),r}(t(98555).v),V=F()(function(){return new H}),B=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=V(),r=(0,j.useState)(!1),i=r[0],o=r[1],s=(0,j.useRef)(n);return(0,j.useEffect)(function(){s.current=n},[n]),(0,j.useEffect)(function(){return t.on("move",function(n){s.current||o(e(n))})},[t,e]),i},q=t(46358),K=t(62141),Y=t(93858),J=t(49392),Q=t(8812),X=t(17815),$=t(35232),ee=t(63613),en=t(80891),et=t(61374),er=t(8283),ei=t(96530),eo=t(71354),es=t(50390),ea=t(5766),ec=t(40110),el=t(45650),ed=t(52322),eu=function(e){var n=e.label,t=e.shortcuts;return(0,ed.jsxs)(er.U,{children:[t.map(function(e,n){return(0,ed.jsx)(ei.T,{padding:1,children:e},n)}),(0,ed.jsx)(f.x,{fontSize:"sm",fontWeight:"medium",whiteSpace:"nowrap",children:n})]})},ef=function(e){var n=e.onClose;return(0,ed.jsx)(p.xu,{children:(0,ed.jsxs)(eo.K,{spacing:6,children:[(0,ed.jsxs)(eo.K,{spacing:1,children:[(0,ed.jsxs)(er.U,{color:"gray.500",children:[(0,ed.jsx)(x.G,{icon:E.UF})," ",(0,ed.jsx)(es.X,{size:"xs",fontWeight:"normal",children:(0,ed.jsx)(l.cC,{id:"h7MgpO"})})]}),(0,ed.jsx)(es.X,{size:"md",children:(0,ed.jsx)(l.cC,{id:"UodEcE"})})]}),(0,ed.jsxs)(ea.M,{spacing:3,columns:1,children:[(0,ed.jsx)(eu,{label:(0,ed.jsx)(l.cC,{id:"9xCxY6"}),shortcuts:[(0,ed.jsx)(x.G,{icon:et.ac},"left"),(0,ed.jsx)(x.G,{icon:en.eF},"right")]}),(0,ed.jsx)(eu,{label:(0,ed.jsx)(l.cC,{id:"IkakN2"}),shortcuts:["Esc"]}),(0,ed.jsx)(eu,{label:(0,ed.jsx)(l.cC,{id:"K0Oq/D"}),shortcuts:["R"]}),(0,ed.jsx)(ec.i,{borderColor:"gray.300"}),(0,ed.jsx)(eu,{label:(0,ed.jsx)(l.cC,{id:"CgmvBu"}),shortcuts:["S"]}),(0,ed.jsx)(eu,{label:(0,ed.jsx)(l.cC,{id:"/5i2oX"}),shortcuts:[(0,ed.jsx)(x.G,{icon:ee.FP},"up"),(0,ed.jsx)(x.G,{icon:$.r5},"down")]}),(0,ed.jsx)(eu,{label:(0,ed.jsx)(l.cC,{id:"rEj/lx"}),shortcuts:["Enter"]})]}),(0,ed.jsx)(el.z,{size:"sm",variant:"solid",onClick:n,children:(0,ed.jsx)(l.cC,{id:"76gPWk"})})]})},"coach-bar")};function ep(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function eh(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ep(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ep(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ex=(0,j.memo)(function(){var e=(0,I.q)(),n=e.isOpen,t=e.onToggle,r=e.onClose,i=(0,Y._)(J.H.hasSeenCoachBar,!1),o=(0,S.Z)(i,2),s=o[0],a=o[1],c=(0,q.CG)(K.Tf),l=(0,j.useCallback)(function(){s||a(!0),r()},[s,r,a]),d=!s||n,u=B((0,j.useCallback)(function(e){return e.clientX>window.innerWidth-150&&e.clientY>window.innerHeight-150},[]));return(0,ed.jsx)(X.H,{mr:c&&s&&!d&&!u?"-100%":"0px",transitionProperty:"margin-right",transitionDuration:"ultra-slow",transitionTimingFunction:"ease-in-out",children:(0,ed.jsxs)(P.J,{returnFocusOnClose:!1,isOpen:d,onClose:l,closeOnBlur:!0,children:[(0,ed.jsx)(D.x,{children:(0,ed.jsx)(A.h,{onClick:function(){n&&a(!0),t()},"aria-label":"Help",isRound:!0,size:"md",icon:(0,ed.jsx)(x.G,{icon:E.UF})})}),(0,ed.jsx)(T.y,eh(eh({},Q.Ro),{},{children:(0,ed.jsx)(R.b,{children:(0,ed.jsx)(ef,{onClose:l})})}))]})})});ex.displayName="PresentModeHelpWidget";var em=t(75085),eg=t(51331),ev=t(53923),ej=t(21061),eb=t(72043),ey=t(59115),eC=t(15087),eO=t(32736),ew=t(36738),ek=t(74637),eS=t(94301),eE=t(35741),eI=t(82269),eP=t(20299),eD=t(46974),eA=t(48798),eT=t(85249),eR=t(20176),e_=t(36471),eM=t(1410),eL=t(46510),ez=t(80304),eN=t(55479),eZ=t(84103),eG=t(49294),eF=t(34638),eU=t(56143),eW=t(65742),eH=t(50381),eV=t.n(eH),eB=t(97705),eq=t(93506),eK=t(98841),eY=t(25925),eJ=["children","style"];function eQ(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function eX(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?eQ(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eQ(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var e$={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},e0="custom"in eK.E?eK.E.custom(eB.m.div):(0,eK.E)(eB.m.div),e1=(0,j.forwardRef)(function(e,n){var t,r,i=e.children,o=e.style,s=(0,eI.Z)(e,eJ),a=(0,eq.jC)("Menu",s);return(0,ed.jsx)(eB.m.div,eX(eX({ref:n,__css:{zIndex:null!==(t=e.zIndex)&&void 0!==t?t:null===(r=a.list)||void 0===r?void 0:r.zIndex},style:eX({},o)},s),{},{children:(0,ed.jsx)(eY.M,{children:(0,ed.jsx)(e0,{className:(0,h.cx)("chakra-menu__menu-list"),variants:e$,style:{transformOrigin:"top left"},initial:e$.exit,animate:e$.enter,exit:e$.exit,__css:eX({outline:0},a.list),children:i})})}))}),e2=t(17107),e5=["type"],e3=["icon","iconSpacing","command","commandSpacing","children"],e4=["className","children"],e6=["className"];function e8(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function e9(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?e8(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):e8(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var e7=(0,e2.G)(function(e,n){var t=e.type,r=(0,eI.Z)(e,e5),i=(0,eq.jC)("Menu",r),o=r.as?null!=t?t:void 0:"button",s=e9({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0},i.item);return(0,ed.jsx)(eB.m.button,e9(e9({ref:n,type:o},r),{},{__css:s,_hover:i.item._focus}))}),ne=(0,e2.G)(function(e,n){var t=e.icon,r=e.iconSpacing,i=e.command,o=e.commandSpacing,s=e.children,a=(0,eI.Z)(e,e3),c=t||i?(0,ed.jsx)("span",{style:{pointerEvents:"none",flex:1},children:s}):s;return(0,ed.jsxs)(e7,e9(e9({},a),{},{className:(0,h.cx)("chakra-menu__menuitem"),children:[t&&(0,ed.jsx)(nn,{fontSize:"0.8em",marginEnd:void 0===r?"0.75rem":r,children:t}),c,i&&(0,ed.jsx)(nt,{marginStart:void 0===o?"0.75rem":o,children:i})]}))});ne.displayName="MenuItem";var nn=function(e){var n=e.className,t=e.children,r=(0,eI.Z)(e,e4),i=j.Children.only(t),o=j.isValidElement(i)?j.cloneElement(i,{focusable:"false","aria-hidden":!0,className:(0,h.cx)("chakra-menu__icon",i.props.className)}):null,s=(0,h.cx)("chakra-menu__icon-wrapper",n);return(0,ed.jsx)(eB.m.span,e9(e9({className:s},r),{},{__css:{flexShrink:0},children:o}))};nn.displayName="MenuIcon";var nt=(0,e2.G)(function(e,n){var t=(0,eq.jC)("Menu",e);return(0,ed.jsx)(eB.m.span,e9(e9({ref:n},e),{},{__css:t.command,className:"chakra-menu__command"}))});nt.displayName="MenuCommand";var nr=function(e){var n=e.className,t=(0,eI.Z)(e,e6),r=(0,eq.jC)("Menu",e);return(0,ed.jsx)(eB.m.hr,e9(e9({role:"separator","aria-orientation":"horizontal",className:(0,h.cx)("chakra-menu__divider",n)},t),{},{__css:r.divider}))};nr.displayName="MenuDivider";var ni=t(23015),no=t(583),ns=t(81212),na=t(29787),nc=["editor","openStyleDrawer","cardUrl","getPos","isNested","isFirstCard","isCollapsed","hasCardBackground","onClose","updateAttributes","previewContent"];function nl(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function nd(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nl(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nl(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var nu=(0,ed.jsx)(x.G,{icon:ez.TX,fixedWidth:!0}),nf=(0,ed.jsx)(x.G,{icon:eL.WM,fixedWidth:!0}),np=(0,ed.jsx)(x.G,{icon:eM.O4,fixedWidth:!0}),nh=(0,ed.jsx)(x.G,{icon:e_.$,fixedWidth:!0}),nx=(0,ed.jsx)(x.G,{icon:eR.FP,fixedWidth:!0}),nm=(0,ed.jsx)(x.G,{icon:eT.oK,fixedWidth:!0}),ng=(0,ed.jsx)(x.G,{icon:eA.re,fixedWidth:!0}),nv=(0,ed.jsx)(x.G,{icon:eD.z1,fixedWidth:!0}),nj=(0,ed.jsx)(x.G,{icon:eP.UP,fixedWidth:!0}),nb=(0,j.forwardRef)(function(e,n){var t=e.editor,r=e.openStyleDrawer,i=e.cardUrl,o=e.getPos,s=e.isNested,a=e.isFirstCard,c=e.isCollapsed,p=e.hasCardBackground,h=e.onClose,x=e.updateAttributes,m=e.previewContent,g=(0,eI.Z)(e,nc);console.debug("%c [<ManageCardMenu />] RENDER","background-color: limegreen");var v=(0,eN.p)(),b=(0,na.K)(),y=(0,j.useCallback)(function(){x&&x({previewContent:null===m?"":null})},[x,m]),C=(0,j.useCallback)(function(){var e=o();if(e&&t){var n=t.state.doc.nodeAt(e),r=n&&(0,eW.getCardTitle)(n.toJSON());t.chain().deleteCard(e).focus().run();var i=d.ag._({id:"0MWv65",values:{displayTitle:r?'"'.concat(r,'"'):"card"}}),s=d.ag._({id:"9uI/rE"}),a=v({title:(0,ed.jsxs)(er.U,{children:[(0,ed.jsx)(f.x,{noOfLines:1,children:i}),(0,ed.jsx)(eZ.r,{textDecoration:"underline",onClick:function(){(0,eU.Yw)(t.state),v.close(a)},children:s})]}),status:"info",duration:3e3,position:"top"})}},[t,o,v]),O=(0,j.useCallback)(function(){var e=o();e&&(null==t||t.commands.duplicateCard(e))},[t,o]),w=(0,j.useCallback)(function(){var e=o();e&&(null==t||t.commands.unnestCard(e))},[t,o]),k=(0,j.useCallback)(function(){var e=o();e&&(null==t||t.chain().mergeCardsAtPos(e).focus().run())},[t,o]),S=(0,j.useCallback)(function(){r(0)},[r]),E=(0,j.useCallback)(function(){r(1)},[r]),I=(0,q.CG)(K.hN),P=(0,eG.V)(i).onCopy,D=(0,eF.ff)("red.500","red.300"),A=(0,j.useCallback)(function(e){var n;if(e.target&&null!==(n=e.target)&&void 0!==n&&n.closest('[data-testid="open-share"]')){e.preventDefault();return}P(),v({title:d.ag._({id:"h5GS+N"}),status:"success",duration:3e3,position:"top"})},[P,v]),T=(0,j.useCallback)(function(){var e=o();if(e&&t){var n=(0,no.PZ)(t,e);if(!n){v({title:d.ag._({id:"FntfNT"}),status:"error",duration:3e3,position:"top"});return}eV()(n,{format:"text/html"}),v({title:d.ag._({id:"LHDpRL"}),status:"success",duration:3e3,position:"top"})}},[t,o,v]);return(0,ed.jsxs)(e1,nd(nd({},g),{},{zIndex:"popover",ref:n,onClick:h,"data-testid":"manage-card-menu",children:[(0,ed.jsx)(ne,{icon:(0,ed.jsx)(ns.x,{isLocked:!b}),onClick:A,"data-testid":"copy-card-link",children:(0,ed.jsx)(l.cC,{id:"F0YmUY"})}),(0,ed.jsx)(ne,{icon:np,onClick:T,children:(0,ed.jsx)(l.cC,{id:"Bq0HJ4"})}),(0,ed.jsxs)(u.k,{direction:"column",display:I?"flex":"none",children:[(0,ed.jsx)(nr,{}),(0,ed.jsx)(ne,{icon:nf,onClick:O,"data-testid":"duplicate-card",children:(0,ed.jsx)(l.cC,{id:"euc6Ns"})}),x&&s&&c&&(0,ed.jsx)(ne,{icon:""===m?nv:nj,onClick:y,"data-testid":"hide-preview",children:""===m?(0,ed.jsx)(l.cC,{id:"dK2evu"}):(0,ed.jsx)(l.cC,{id:"691flv"})}),r&&void 0!==p&&!c&&(0,ed.jsx)(ne,{icon:ng,onClick:S,onMouseDown:ni.br,"data-testid":"card-background",children:p?(0,ed.jsx)(l.cC,{id:"sIpTuZ"}):(0,ed.jsx)(l.cC,{id:"T6eZ9z"})}),r&&!c&&(0,ed.jsx)(ne,{icon:nu,onClick:E,onMouseDown:ni.br,"data-testid":"card-style",children:(0,ed.jsx)(l.cC,{id:"k7zVgS"})}),s?(0,ed.jsx)(ne,{icon:nm,onClick:w,"data-testid":"merge-into-parent-card",children:(0,ed.jsx)(l.cC,{id:"b+J8Wt"})}):!1!=s||a?null:(0,ed.jsx)(ne,{icon:nx,onClick:k,"data-testid":"merge-into-card-above",children:(0,ed.jsx)(l.cC,{id:"kV34zB"})}),(0,ed.jsx)(nr,{}),(0,ed.jsx)(ne,{icon:nh,color:D,onClick:C,"data-testid":"delete-card",children:(0,ed.jsx)(l.cC,{id:"cnGeoo"})})]})]}))}),ny=t(62490);function nC(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function nO(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nC(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var nw=(0,j.memo)(function(e){var n=e.editor,t=(0,q.CG)(ny.tk),r=t.isOpen,i=t.ref,o=t.options,s=(0,j.useState)(null),a=s[0],c=s[1],l=(0,eE.D)(i,a,{placement:"bottom-start",modifiers:[{name:"preventOverflow",enabled:!0,options:{boundary:"clippingParents"}},{name:"offset",options:{offset:[0,8]}}],strategy:"absolute"}).styles,d=(0,b.I0)(),u=(0,j.useCallback)(function(){d((0,ny.kG)({saveRef:!0}))},[d]),f=(0,j.useCallback)(function(){d((0,ny.kG)({saveRef:!1}))},[d]);return(0,ek.O)({ref:{current:a},handler:function(){r&&(u(),setTimeout(function(){d((0,ny.gQ)())},0))}}),(0,j.useEffect)(function(){return function(){return f()}},[]),(0,ed.jsx)(eS.h,{children:r&&o&&(0,ed.jsx)(nb,nO(nO({},o),{},{style:nO({},l.popper),onClose:f,ref:c,editor:n}))})}),nk=t(25756),nS=t(40618),nE=t(32333),nI=t(67769),nP=t(84636),nD=t.n(nP),nA=t(54073),nT=t.n(nA),nR=t(72338),n_=t(30341),nM=t(34264),nL=t(17477),nz=t(26087),nN=function(e,n,t,r,i){var o=r-t,s=Math.max(o-Math.max(e-t,0)-Math.max(r-n,0),0),a=s/o,c=a>0&&s==n-e;return{overlap:a,viewing:i&&(c||a>.5||s>400),only:c}};function nZ(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var nG=function(e,n){var t=(0,n_.As)("editor"),r=(0,j.useState)(null),i=r[0],o=r[1],s=(0,j.useRef)({presentingCardId:null,scrollTop:0,containerHeight:0,expandedCards:{}}),c=(0,q.CG)(K.gh),l=(0,q.CG)(K.i2);(0,j.useEffect)(function(){s.current.presentingCardId=null!=l?l:null},[l]);var d=(0,q.CG)(K.Q5);(0,j.useEffect)(function(){s.current.expandedCards=d},[d]),(0,j.useEffect)(function(){var e=document.querySelector(t.scrollSelector);if(e){o(e);var n=e.getBoundingClientRect().height;s.current.scrollTop=e.scrollTop,s.current.containerHeight=n}},[t.scrollSelector,s]),(0,j.useEffect)(function(){var e=nT()(function(){i&&(s.current.scrollTop=i.scrollTop)},250,{trailing:!0,maxWait:500});return window.addEventListener("scroll",e,!0),function(){return window.removeEventListener("scroll",e,!0)}},[i]),(0,j.useEffect)(function(){var e=nT()(function(){i&&(s.current.containerHeight=i.getBoundingClientRect().height)},250,{trailing:!0,maxWait:500});return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[i]),(0,j.useEffect)(function(){if(e){if(c===nz.q.SLIDE_VIEW){var r=setInterval(function(){n.emit("cardViewed",{cardId:s.current.presentingCardId,interval:1e3})},1e3);return function(){return clearInterval(r)}}var i=setInterval(function(){if(!document.hidden){var r=s.current,i=r.scrollTop,o=r.containerHeight,c=r.expandedCards,l=i+o;nD()((0,nR.N2)(e.state.doc,nM.KH),function(e){return e.node.attrs.id}).map(function(n){var r,o=n.node.attrs.id,s=c[o];if(!s)return null;try{r=e.view.nodeDOM(n.pos)}catch(e){return null}if(r instanceof HTMLElement){var d=(0,nL.LY)(r,t.scrollSelector),u=r.offsetHeight+d;return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nZ(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nZ(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({id:o},nN(i,l,d,u,s))}return null}).filter(function(e){return!!(null!=e&&e.viewing)}).forEach(function(e){n.emit("cardViewed",{cardId:e.id,interval:1e3})})}},1e3);return function(){return clearInterval(i)}}},[c,e,s,n,t.scrollSelector])},nF=function(e){var n=e.editor,t=e.backoffFactor,r=void 0===t?1:t,i=(0,nE.z$)(),o=(0,j.useState)(15e3),s=o[0],a=o[1];nG(n,nI.f);var c=(0,j.useCallback)(function(){nI.f.flush(),a(Math.min(s*r,12e4))},[r,s]);return(0,j.useEffect)(function(){if(i){nI.f.initialize(),nI.f.on("flush",function(e){for(var n=e.viewed,t=0,r=Object.entries(n);t<r.length;t++){var o=(0,S.Z)(r[t],2),s=o[0],a=o[1];i.trackDocEvent(nE.AA.CARD_VIEWED,{card_id:s,duration:a})}});var e=setInterval(function(){return c()},s);return function(){clearInterval(e),nI.f.destroy()}}},[i,s,c]),null},nU=t(10710),nW=t(28916),nH=t(62517),nV=t(59734),nB=t(68197),nq=t(20406),nK=t(28526),nY=t.n(nK),nJ=t(78116),nQ=t(56915),nX=t(16796),n$=t(64827),n0=t(2167),n1=t(80353),n2=t(76648),n5=t(58125),n3=t(30764),n4=t(24021),n6=t(66825),n8=t(53865),n9=t(35634),n7=t(95876),te=t(4707),tn=t(91465),tt=t(1153),tr=t(35231),ti=t(34860);function to(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var ts=j.createContext({enabled:!1,registerEditor:function(e,n){},getAllCards:function(){return[]},userMessage:"",setUserMessage:function(e){}});function ta(){return(0,j.useContext)(ts)}var tc=function(e){var n=e.children,t=(0,j.useRef)(new Map),r=(0,j.useRef)(""),i=(0,j.useRef)(function(e,n){t.current.set(e,n)}),o=(0,j.useRef)(function(){return Array.from(t.current.values()).map(function(e){var n,t;return null===(n=e.state.doc.firstChild)||void 0===n?void 0:null===(t=n.content.toJSON())||void 0===t?void 0:t[0]}).filter(Boolean)}),s=(0,j.useCallback)(function(e){r.current=e},[]);return(0,ed.jsx)(ts.Provider,{value:{enabled:!0,registerEditor:i.current,getAllCards:o.current,userMessage:r.current,setUserMessage:s},children:n})},tl=t(82511),td=t(69936),tu=t(56581),tf=t(27302),tp=t(420),th=t(86297),tx=function(e){var n=e.cardId,t=e.onClick,r=(0,q.CG)((0,tl.NB)(n)),i=(0,q.CG)(K.Pu);return r?(0,ed.jsxs)(eo.K,{zIndex:1,mt:"4.5em",width:"180px",bg:"whiteAlpha.500",border:"1px solid",borderColor:"blackAlpha.300",borderRadius:"lg",p:4,sx:{"*":{"backdrop-filter":"none !important","-webkit-backdrop-filter":"none !important"}},children:[r.variants.map(function(e){if(!e)return null;var o=e.label,s=e.card,a=e.id;return(0,ed.jsx)(tm,{theme:i,isSelected:r.selected===a,label:o,card:s,onClick:function(){t({cardId:n,variationId:a})}},a)}),r.variants.length<2&&(0,ed.jsx)(tf.M,{children:(0,ed.jsx)(tp.$,{})})]}):null},tm=function(e){var n=e.label,t=e.card,r=e.theme,i=e.isSelected,o=void 0!==i&&i,s=e.onClick,a=(0,j.useMemo)(function(){return(0,th.vL)({docFlags:{cardLayoutsEnabled:!0}},[t])},[t]);return(0,ed.jsxs)(eo.K,{align:"start",children:[(0,ed.jsx)(u.k,{borderRadius:"md",bg:"white",shadow:o?"outline":"md",overflow:"hidden",cursor:"pointer",_hover:{bg:"trueblue.50"},transitionProperty:"common",transitionDuration:"fast",onClick:void 0===s?function(){}:s,children:(0,ed.jsx)(u.k,{sx:tn.n,css:{"--editor-font-size":"0.15rem","--editor-width":"150px"},justifyContent:"center",alignItems:"top",pointerEvents:"none",children:(0,ed.jsx)(tn.m,{content:a,theme:r,isThumbnail:!0})})}),(0,ed.jsxs)(f.x,{fontSize:"sm",children:[o&&(0,ed.jsx)(tu.n,{boxSize:3,mr:2}),n]})]})};function tg(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function tv(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?tg(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var tj="ai-wizard-editor-root",tb=function(e){var n=e.doc,t=e.cards,r=e.theme,i=void 0===r?n8.mU:r,o=(0,tr.R5)(i),s=(0,n9.wj)(i),a=(0,tr.wh)(o,s),c=(0,q.TL)(),l=ta().registerEditor;return((0,j.useEffect)(function(){return function(){c((0,tl.mc)())}},[c]),n)?(0,ed.jsxs)(u.k,tv(tv({bg:"gray.100",overflowY:"auto",overflowX:"hidden",justifyContent:"flex-start",alignContent:"center",alignItems:"center",alignSelf:"stretch",direction:"column",width:"100%",height:"100%",position:"relative",className:tj},a),{},{children:[(0,ed.jsx)(tt.Y,{}),t.map(function(e,t){var r,i=null===(r=e.attrs)||void 0===r?void 0:r.id;return i?(0,ed.jsx)(ty,{doc:n,cardId:i,cardIndex:t,cardJSON:e,onCreate:function(e){l(i,e)}},i):null})]})):null},ty=function(e){var n=e.cardId,t=e.cardIndex,r=e.cardJSON,i=e.doc,o=e.onCreate,s=(0,q.TL)(),a=(0,j.useState)(null),c=a[0],l=a[1],d=ta().userMessage,f=(0,td.b)({editor:c});(0,j.useEffect)(function(){c&&f({doc:c.state.doc,cardId:n,message:d})},[f,c,n,t,d]);var p=(0,j.useMemo)(function(){return(0,n7.vL)({docFlags:{cardLayoutsEnabled:!0}},[r])},[r]),h=(0,q.CG)((0,tl.a4)(n));(0,ti.vm)(function(){if(c&&h){var e=(0,nM.Bw)(c,n);e&&c.commands.command(function(n){var t=n.tr,r=n3.NB.fromJSON(c.schema,h.card);return t.replaceWith(e.pos,e.pos+e.node.nodeSize,r),!0})}},[c,h,n],[h]);var x=(0,j.useCallback)(function(e){var t=e.cardId,r=e.variationId;c&&t===n&&s((0,tl.dx)({cardId:n,variantId:r}))},[s,c,n]);return null!=i&&i.id?(0,ed.jsxs)(u.k,{className:"ai-variation-editor-".concat(n),alignItems:"flex-start",sx:tn.n,my:-8,children:[(0,ed.jsx)(tx,{cardId:n,onClick:x}),(0,ed.jsx)(te.y,{initialContent:p,onCreate:function(e){var n=e.editor;l(n),o(n)},doc:i,docId:i.id,scrollingParentSelector:".".concat(tj),readOnly:!0,isStatic:!0,animationsEnabled:!1,extensions:[],shouldSupportMenus:!1})]}):null},tC=t(30118);function tO(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function tw(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?tO(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tO(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var tk=function(e){var n=(0,tC.M)({id:"cardSuggestionDrawer"}),t=n.isOpen,r=n.onClose,i=n.onOpen,o=(0,q.CG)(K.Pu),s=(0,j.useState)(function(){return(0,n5.xC)({reducer:q.Ct})})[0];return(0,ed.jsx)(b.zt,{store:s,children:(0,ed.jsx)(tS,tw(tw({},e),{},{isOpen:t,onClose:r,onOpen:i,theme:o}))})},tS=(r=function(e){var n,t=e.doc,r=e.editor,i=e.theme,o=e.isOpen,s=e.onClose,a=e.onOpen,c=(0,j.useState)([]),d=c[0],u=c[1],f=(0,j.useState)(null),p=f[0],h=f[1],x=ta(),m=x.getAllCards,g=x.setUserMessage,v=(0,j.useCallback)(function(){s(),u([]),h(null)},[s]),b=(0,j.useCallback)(function(){if(v(),r){var e={type:"document",content:m()};console.log("[handleConfirm] contentToUse",e);var n=1,t=r.state.doc.nodeSize-2,i=(0,nM.Bw)(r,p);if(i){t=(n=i.pos)+i.node.nodeSize;var o=e.content.find(function(e){var n;return(null===(n=e.attrs)||void 0===n?void 0:n.id)===p});if(!o){console.warn("[handleConfirm] Count not find card to use");return}e=o}r.commands.command(function(i){return i.tr.replaceRangeWith(n,t,n3.NB.fromJSON(r.schema,e)),!0})}},[v,r,p,m]),y=(0,j.useCallback)((n=(0,nq.Z)(nY().mark(function e(n,t,r){return nY().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a(),h(t),u(n.toJSON().content[0].content.filter(function(e){var n;return null===t||(null===(n=e.attrs)||void 0===n?void 0:n.id)===t})),g(r);case 5:case"end":return e.stop()}},e)})),function(e,t,r){return n.apply(this,arguments)}),[a,g]);return(0,j.useEffect)(function(){if(r)return n6.T.on("openSuggestionEditor",function(e){var n=e.cardId,t=e.userMessage;y(r.view.state.doc,n,t)})},[r,y]),(0,ed.jsxs)(nJ.d,{placement:"bottom",onClose:s,isOpen:o,trapFocus:!0,isFullHeight:!0,children:[(0,ed.jsx)(nQ.Z,{}),(0,ed.jsxs)(nX.s,{borderTopRadius:"xl",h:"calc(var(--100vh) - 24px)",transform:"none !important",children:[(0,ed.jsx)(n$.o,{zIndex:"10",backgroundColor:"white",mr:2,shadow:"md"}),(0,ed.jsx)(n0.f,{p:0,h:"100%",children:d.length>0&&t?(0,ed.jsx)(tb,{doc:t,cards:d,theme:i}):(0,ed.jsx)(n4.AA,{})}),(0,ed.jsx)(n1.m,{borderTop:"1px solid #000",borderColor:"gray.200",children:(0,ed.jsxs)(n2.h,{spacing:4,children:[(0,ed.jsx)(el.z,{variant:"ghost",onClick:s,children:(0,ed.jsx)(l.cC,{id:"dEgA5A"})}),(0,ed.jsx)(el.z,{variant:"solid",onClick:b,children:(0,ed.jsx)(l.cC,{id:"7VpPHA"})})]})})]})]})},(0,j.memo)(function(e){return(0,ed.jsx)(tc,{children:(0,ed.jsx)(r,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?to(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):to(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},e))})})),tE=t(80405),tI=t(28677),tP=t(31145),tD=t(49626),tA=t(61751),tT=t(49747),tR=t(56133),t_=t(39097),tM=t.n(t_),tL=t(46988),tz=t(8661),tN=t(20252),tZ=t(38876),tG=t(9734),tF=t(51823),tU=t(76035),tW=t(50281),tH=t(54119),tV=t(77779),tB=t(2046),tq=t(70287),tK=t(25793),tY=t(14304),tJ=t.n(tY),tQ=t(6201),tX=[{key:"bad",label:(0,ed.jsx)(l.cC,{id:"XSfVsn"}),ariaLabel:function(){return d.ag._({id:"XSfVsn"})},icon:tV.Kf,color:"red"},{key:"meh",label:(0,ed.jsx)(l.cC,{id:"0ASQJH"}),ariaLabel:function(){return d.ag._({id:"0ASQJH"})},icon:tH.C4,color:"yellow"},{key:"good",label:(0,ed.jsx)(l.cC,{id:"9ZYnL5"}),ariaLabel:function(){return d.ag._({id:"9ZYnL5"})},icon:tW.I3,color:"green"}],t$=function(e){var n=e.docId,t=e.isDark,r=e.interactionId,i=(0,j.useState)(null),o=i[0],s=i[1],a=(0,j.useState)(!1),c=a[0],d=a[1],u=(0,j.useState)(""),h=u[0],m=u[1],g=(0,j.useRef)(null),v=(0,eN.p)(),b=(0,j.useCallback)(function(e){s(e),(0,tQ.fM)({rating:e,doc_id:n,interactionId:r}),v({title:(0,ed.jsx)(l.cC,{id:"2gZOCV"}),status:"success",position:"top",duration:1e3}),setTimeout(function(){var e;null==g||null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},200)},[n,r,v]),y=(0,j.useCallback)(function(e){e||((0,tQ.XH)({feedback:tJ().sanitize(h),doc_id:n,interactionId:r}),v({title:(0,ed.jsx)(l.cC,{id:"+Rq0s/"}),status:"success",position:"top",duration:2e3,isClosable:!0})),d(!0)},[n,h,r,v]);return(0,ed.jsx)(p.xu,{p:4,borderRadius:"lg",border:"1px solid",borderColor:t?"whiteAlpha.100":"gray.200",position:"relative",children:c?(0,ed.jsxs)(f.x,{color:t?"green.400":"green.600",textAlign:"center",children:[(0,ed.jsx)(x.G,{icon:tU.faCircleCheck})," ",(0,ed.jsx)(l.cC,{id:"SOk0EB"})]}):(0,ed.jsxs)(eo.K,{spacing:4,children:[(0,ed.jsxs)(eo.K,{alignItems:"center",spacing:"1",children:[(0,ed.jsx)(f.x,{fontSize:"sm",color:t?"whiteAlpha.800":"gray.500",children:(0,ed.jsx)(l.cC,{id:"TxHdBh"})}),o?(0,ed.jsxs)(f.x,{textAlign:"center",color:t?"green.400":"green.600",children:[(0,ed.jsx)(x.G,{icon:tU.faCircleCheck})," ",(0,ed.jsx)(l.cC,{id:"SOk0EB"})]}):(0,ed.jsx)(f.x,{children:(0,ed.jsx)(l.cC,{id:"cNzndx"})})]}),(0,ed.jsx)(er.U,{fontSize:"xl",width:"100%",children:tX.map(function(e){var n=e.key,r=e.ariaLabel,i=e.label,s=e.icon,a=e.color,c=o===n;return(0,ed.jsx)(t0,{ariaLabel:r,label:i,icon:s,color:a,onClick:function(){return b(n)},isSelected:c,isDisabled:!!(o&&!c),isDark:t},n)})}),o&&(0,ed.jsxs)(tB.NI,{textAlign:"center",children:[(0,ed.jsx)(tq.l,{fontSize:"sm",color:t?"whiteAlpha.800":"gray.500",children:"good"===o?(0,ed.jsx)(l.cC,{id:"AmM8eQ"}):(0,ed.jsx)(l.cC,{id:"8+bwIa"})}),(0,ed.jsx)(tK.g,{value:h,onChange:function(e){m(e.target.value)},placeholder:"",size:"sm",mb:"4"}),(0,ed.jsxs)(n2.h,{spacing:"4",ref:g,children:[(0,ed.jsx)(el.z,{variant:"text",onClick:function(){y(!0)},children:(0,ed.jsx)(l.cC,{id:"6Uau97"})}),(0,ed.jsx)(el.z,{variant:"solid",isDisabled:""===h,onClick:function(){return y(!1)},children:(0,ed.jsx)(l.cC,{id:"hQRttt"})})]})]})]})})},t0=function(e){var n=e.label,t=e.ariaLabel,r=e.icon,i=e.color,o=e.isSelected,s=e.onClick,a=e.isDisabled,c=e.isDark;return(0,ed.jsx)(m.kH,{label:n,placement:"top",children:(0,ed.jsx)(A.h,{"aria-label":t(),boxShadow:"none",bg:o?c?"".concat(i,".200"):"".concat(i,".100"):c?"whiteAlpha.300":"gray.50",_disabled:{opacity:"".concat(o?1:.5),cursor:"not-allowed"},color:o?c?"".concat(i,".600"):"".concat(i,".500"):c?"whiteAlpha.800":"gray.500",_hover:{backgroundColor:"".concat(i,".100"),color:"".concat(i,".500")},flex:1,icon:(0,ed.jsx)(f.x,{fontSize:"2xl",children:(0,ed.jsx)(x.G,{icon:r})}),isDisabled:a,variant:"plain",onClick:s})})},t1=t(1368),t2=t(97907),t5=["90%","360px"],t3=function(e){var n=e.onClose,t=e.eyebrowText,r=e.mainText,i=e.callsToAction;return(0,ed.jsxs)(p.xu,{bg:"white",border:"0.5px solid var(--chakra-colors-gray-100)",borderRadius:"md",shadow:"md",p:4,w:t5,maxW:t5,position:"relative",children:[(0,ed.jsx)(t2.P,{size:"sm",onClick:n,position:"absolute",insetEnd:1,top:1}),(0,ed.jsxs)(eo.K,{spacing:4,children:[(0,ed.jsxs)(eo.K,{spacing:1,paddingEnd:3,children:[!(0,tG.s2)()&&(0,ed.jsx)(f.x,{fontSize:"sm",color:"gray.600",children:t}),(0,ed.jsx)(f.x,{fontSize:"md",children:r})]}),(0,ed.jsx)(p.xu,{w:"100%",children:i})]})]})},t4=function(e){var n=e.onClose,t=e.startTour;return(0,ed.jsx)(t3,{eyebrowText:(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)("span",{"aria-label":"Wave",role:"img",children:"\uD83D\uDC4B"})," ",(0,ed.jsx)(l.cC,{id:"IiwaCT",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc}})]}),mainText:(0,ed.jsx)(l.cC,{id:"ntWFEH"}),onClose:n,callsToAction:(0,ed.jsx)(el.z,{size:"md",w:"100%",variant:"solid",onClick:function(){t(0),n()},children:(0,ed.jsx)(l.cC,{id:"VzFYDl"})})})},t6=t(77245),t8=["90%","360px"],t9=function(e){var n=e.onClose,t=(0,j.useState)(!0),r=t[0],i=t[1];return(0,j.useEffect)(function(){setTimeout(function(){i(!1)},3e3)},[]),(0,ed.jsxs)(p.xu,{bg:"white",border:"0.5px solid var(--chakra-colors-gray-100)",borderRadius:"md",shadow:"md",p:4,w:t8,maxW:t8,position:"relative",children:[(0,ed.jsx)(t2.P,{size:"md",onClick:n,position:"absolute",insetEnd:1,top:1}),(0,ed.jsxs)(eo.K,{direction:"row",spacing:3,justify:"center",w:"100%",alignItems:"center",children:[(0,ed.jsx)(p.xu,{color:"trueblue.300",children:(0,ed.jsx)(x.G,{icon:t6.tc,size:"2x",className:r?"fa-bounce":void 0})}),(0,ed.jsxs)(eo.K,{spacing:0,direction:"column",flex:1,textAlign:"left",children:[(0,ed.jsx)(f.x,{fontSize:"sm",color:"gray.600",children:(0,ed.jsx)(l.cC,{id:"eoDgVo"})}),(0,ed.jsx)(f.x,{fontSize:"md",children:(0,ed.jsx)(l.cC,{id:"p7dFyi"})})]})]})]})};function t7(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function re(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?t7(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):t7(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var rn="source",rt="desktop-tour-toast",rr="switch-from-mobile-to-desktop-toast",ri=function(e){var n,t=e.editor,r=(0,eN.p)(),i=(0,q.CG)(nB.yx),o=(0,O.c8)().startTour,s=(0,nU.SE)(),c=s.user,l=s.setSettings,d=(0,j.useState)(!1),u=d[0],f=d[1],p=(0,j.useRef)(!1),h=!!(null!=c&&null!==(n=c.settings)&&void 0!==n&&n.needsEditorOnboarding),x=(0,q.CG)((0,tL.oH)(null==t?void 0:t.gammaDocId)),m=!!x&&"running"===x.status,g=!!x&&("complete"===x.status||"error"===x.status),v=(0,n_.As)("editor"),b=(0,j.useState)(null),y=b[0],C=b[1],w=(0,j.useState)(function(){return(0,tF.SJ)()[rn]===tz.VY})[0],k=(0,j.useState)(function(){return w&&(0,tG.s2)()})[0],S=w&&g;return(0,j.useEffect)(function(){t&&f(!m&&!(0,tG.s2)()&&w&&h)},[t,w,m,h]),(0,j.useEffect)(function(){setTimeout(function(){(0,t1.lO)({query:re(re({},(0,tF.SJ)()),{},(0,a.Z)({},rn,void 0)),emitChange:!1})})},[]),(0,j.useEffect)(function(){return u&&!r.isActive(rt)&&setTimeout(function(){r({id:rt,position:"bottom-left",render:function(e){var n=e.onClose;return t4({onClose:function(){null==l||l({remove:["needsEditorOnboarding"]}),n()},startTour:o})},isClosable:!0,duration:null})},2e3),function(){r.isActive(rt)&&r.close(rt)}},[l,u,o,r]),(0,j.useEffect)(function(){if((0,tG.s2)()){var e=document.querySelector(v.scrollSelector);if(e){C(e);var n=function(){y&&(0,tG.s2)()&&(null==y?void 0:y.scrollTop)>=(null==y?void 0:y.scrollHeight)/4&&k&&!r.isActive(rr)&&!p.current&&(p.current=!0,r({id:rr,position:"top",render:function(e){return t9({onClose:e.onClose})},isClosable:!0,duration:null,containerStyle:{minWidth:"100%",display:"flex",justifyContent:"center"}}))};return window.addEventListener("scroll",n,!0),function(){window.removeEventListener("scroll",n,!0),r.isActive(rr)&&r.close(rr)}}}},[i,y,v.scrollSelector,k,r]),{showDocWizardFooter:S}};function ro(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function rs(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ro(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ro(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ra=(0,j.memo)(function(e){var n,t=e.interactionId,r=(0,q.CG)(nB.yx),i=null!=r&&!!r.theme&&(0,n8.wj)(null==r?void 0:r.theme),o=(0,j.useState)(!1),s=o[0],a=o[1],c=(0,eN.p)(),d=null==r?void 0:null===(n=r.accessLinks)||void 0===n?void 0:n[0],f=(0,j.useMemo)(function(){return(0,tF.Gn)({docTitle:null==r?void 0:r.title,docId:null==r?void 0:r.id,token:null==d?void 0:d.token,absolute:!0})},[r,null==d?void 0:d.token]),p=(0,eG.V)(f).onCopy,h=(0,j.useCallback)(function(){(0,tN.J)({docId:null==r?void 0:r.id,source:"docWizardFooter",type:"tokenUrl"}),p(),c({title:(0,ed.jsx)(l.cC,{id:"pQjjYo"}),status:"success",position:"top",duration:1e3,isClosable:!1})},[null==r?void 0:r.id,p,c]),g=(0,j.useCallback)(function(){a(!0)},[]);return r?(0,ed.jsx)(m.Wk,{isDark:i,children:(0,ed.jsx)(u.k,{className:"chakra-dont-set-collapse","data-doc-wizard-footer":!0,w:"100%",mt:(0,tG.s2)()?void 0:"-".concat(tZ.m),children:(0,ed.jsx)(tT.U,{in:!s,style:{width:"100%"},unmountOnExit:!0,children:(0,ed.jsx)(u.k,rs(rs({pt:[10,10,20],pb:[4,4,8],w:"100%",position:"relative"},i?{background:"gray.900",color:"white",borderTop:"2px solid var(--chakra-colors-whiteAlpha-200)"}:{background:"white",color:void 0,borderTop:"2px solid var(--chakra-colors-blackAlpha-200)"}),{},{children:(0,ed.jsx)(tR.W,{maxW:"420px",children:(0,ed.jsxs)(eo.K,{spacing:8,children:[(0,ed.jsxs)(eo.K,{spacing:4,textAlign:"center",children:[(0,ed.jsx)(es.X,{size:"md",children:(0,ed.jsx)(l.cC,{id:"bB+DHs"})}),(0,ed.jsx)(el.z,{leftIcon:(0,ed.jsx)(x.G,{icon:tA.nN}),variant:"solid",onClick:h,children:(0,ed.jsx)(l.cC,{id:"RGCCrg"})}),(0,ed.jsx)(el.z,{as:tM(),target:(0,tG.Q5)()?"_self":"_blank",variant:"plain",colorScheme:i?"blackAlpha":"whiteAlpha",leftIcon:(0,ed.jsx)(x.G,{icon:tD.r8}),rightIcon:(0,tG.Q5)()?void 0:(0,ed.jsx)(x.G,{icon:tP.faArrowUpRightFromSquare,size:"xs"}),href:tz.ET,children:(0,ed.jsx)(l.cC,{id:"xFxi2V"})})]}),(0,ed.jsx)(t$,{docId:r.id,isDark:i,interactionId:t}),(0,ed.jsx)(tf.M,{pt:[0,0,4],w:"100%",children:(0,ed.jsx)(el.z,{size:"sm",onClick:g,variant:"text",colorScheme:"blackAlpha",children:(0,ed.jsx)(l.cC,{id:"vLyv1R"})})})]})})}))})})}):null});ra.displayName="DocWizardFooterInner";var rc=function(e){var n=e.editor,t=ri({editor:n}).showDocWizardFooter,r=(0,q.CG)((0,tL.oH)(null==n?void 0:n.gammaDocId)),i=null==r?void 0:r.id;return t&&i?(0,ed.jsx)(ra,{interactionId:i}):(0,ed.jsx)(ed.Fragment,{})},rl=t(98537),rd=t.n(rl),ru=t(87063),rf=function(e){var n=e.onCloneClick,t=e.onSignupClick,r=e.isLoggedIn;return(0,ed.jsx)(p.xu,{bg:"white",border:"0.5px solid var(--chakra-colors-gray-100)",borderRadius:"md",shadow:"md",display:"column",p:4,position:"relative",children:r?(0,ed.jsxs)(er.U,{children:[(0,ed.jsxs)(f.x,{mr:1,children:[(0,ed.jsx)(l.cC,{id:"HMsJrS",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc},components:{0:(0,ed.jsx)("strong",{})}})," ","\uD83D\uDE0D"]}),(0,ed.jsx)(el.z,{variant:"solid",onClick:n,children:(0,ed.jsx)(l.cC,{id:"he3ygx"})})]}):(0,ed.jsxs)(er.U,{children:[(0,ed.jsxs)(f.x,{mr:1,children:[(0,ed.jsx)(l.cC,{id:"FEyEJk",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc,GAMMA_PROPER_NOUN:em.N6},components:{0:(0,ed.jsx)("strong",{})}})," ","\uD83D\uDE0D"]}),(0,ed.jsx)(tM(),{href:"/signup",passHref:!0,legacyBehavior:!0,children:(0,ed.jsx)(el.z,{as:eZ.r,onClick:t,variant:"solid",textDecoration:"none !important",children:(0,ed.jsx)(l.cC,{id:"e+RpCP"})})})]})})},rp=function(e){var n=!(0,tG.s2)(),t=(0,nU.SE)().user,r=(0,eN.p)(),i=(0,j.useRef)(),o=(0,ru.e)(),s=(0,j.useCallback)(function(){e&&(null===nE.co||void 0===nE.co||nE.co.track(nE.AA.EXAMPLE_SIGNUP_CLICKED,{doc_id:e.id,title:e.title}))},[e]),a=(0,j.useCallback)(function(){o({docId:null==e?void 0:e.id,docTitle:null==e?void 0:e.title,source:"example_deck_clone_toast"})},[e,o]);(0,j.useEffect)(function(){return function(){i.current&&r.close(i.current)}},[r]);var c=n&&e,l=!!t;(0,ti.vm)(function(){i.current&&r.close(i.current),c&&(i.current=r({position:"bottom",render:function(){return rf({onCloneClick:a,isLoggedIn:l,onSignupClick:s})},isClosable:!0,duration:null}))},[e,n,a,s,c,t,r,l],[c,l])},rh=t(99703),rx=t(91718),rm=t(75033),rg="sessionId1",rv=nR.hj.create({addStorage:function(){return{user:{}}},addCommands:function(){var e=this;return{user:function(n){return function(){var t=(0,q.bh)();return e.storage.user=rd()({},e.storage.user,n),t.dispatch((0,K.MU)({sessionId:rg})),t.dispatch((0,K.Tx)({collaborators:[e.storage.user]})),!0}}}}}),rj=function(e){var n,t=e.docId,r=e.snapshotId,i=e.scrollingParentSelector,o=e.onCreate,s=(0,q.CG)(nB.yx);rp(s);var a=(0,j.useState)(function(){return[rx.$1.configure({scrollerSelector:i}),rv,rh._g]})[0],c=(0,nU.SE)(),l=c.user,d=c.anonymousUser,f=c.isUserLoading,h=c.color,x=(0,j.useState)(),m=x[0],g=x[1],v=(0,y.EDv)({variables:{docId:t,snapshotId:r},skip:!r}),b=v.data,C=v.loading,O=v.error;(0,j.useEffect)(function(){!f&&m&&m.commands.user({id:(null==l?void 0:l.id)||d.id,color:h.value,sessionId:rg,idleSince:null,name:(null==l?void 0:l.displayName)||d.displayName||"",profileImageUrl:(null==l?void 0:l.profileImageUrl)||"",isReady:!f})},[m,l,h,f,d]);var w=b&&void 0!==b.snapshot&&!C&&s;return(0,ed.jsxs)(p.xu,{"data-testid":"example-static-editor-wrapper",flex:"1",height:"100%",children:[!w||O?(0,ed.jsxs)(u.k,{direction:"column",height:"100%",flex:"1",bg:"gray.100",alignItems:"center",justifyContent:"center",children:[!w&&(0,ed.jsx)(tp.$,{}),O&&(0,ed.jsxs)(tf.M,{h:"100%",children:["There was an error loading this ",em.Yc,":"," ",O.message]})]}):(0,ed.jsx)(p.xu,{"data-testid":"example-static-editor-wrapper-inner",transitionProperty:"common",transitionDuration:"750ms",transitionTimingFunction:"ease-out",opacity:w?1:0,children:(0,ed.jsx)(ew.yE,{doc:s,editorId:"main",docId:t,extensions:a,onCreate:function(e){var n=e.editor;g(n),setTimeout(function(){o&&o(n)},10)},readOnly:!0,initialContent:null===(n=b.snapshot)||void 0===n?void 0:n.content.default,scrollingParentSelector:i})}),(0,ed.jsx)(rm.m,{})]})},rb=t(10939),ry="sessionId1",rC=nR.hj.create({addStorage:function(){return{user:{}}},addCommands:function(){var e=this;return{user:function(n){return function(){var t=(0,q.bh)();return e.storage.user=rd()({},e.storage.user,n),t.dispatch((0,K.MU)({sessionId:ry})),t.dispatch((0,K.Tx)({collaborators:[e.storage.user]})),!0}}}}}),rO=function(e){var n,t=e.docId,r=e.snapshotId,i=e.scrollingParentSelector,o=e.onCreate,s=e.theme,a=e.showMadeWithGammaBadge,c=(0,j.useState)(function(){return[rx.$1.configure({scrollerSelector:i}),rC,rh._g]})[0],l=(0,nU.SE)(),d=l.user,f=l.isUserLoading,h=l.anonymousUser,x=l.color,m=(0,j.useState)(),g=m[0],v=m[1],b=(0,y.EDv)({variables:{docId:t,snapshotId:r},skip:!r}),C=b.data,O=b.loading,w=b.error,k=(0,q.CG)(nB.yx);(0,j.useEffect)(function(){!f&&g&&g.commands.user({id:(null==d?void 0:d.id)||h.id,color:x.value,sessionId:ry,idleSince:null,name:(null==d?void 0:d.displayName)||h.displayName||"",profileImageUrl:(null==d?void 0:d.profileImageUrl)||"",isReady:!f})},[g,d,x,f,h]);var S=C&&void 0!==C.snapshot&&!O&&k;return(0,ed.jsxs)(p.xu,{"data-testid":"public-static-editor-wrapper",flex:"1",height:"100%",children:[!S||w?(0,ed.jsxs)(u.k,{direction:"column",height:"100%",flex:"1",bg:"gray.100",alignItems:"center",justifyContent:"center",children:[!S&&(0,ed.jsx)(tp.$,{}),w&&(0,ed.jsxs)(tf.M,{h:"100%",children:["There was an error loading this ",em.Yc,":"," ",w.message]})]}):(0,ed.jsx)(p.xu,{"data-testid":"public-static-editor-wrapper-inner",transitionProperty:"common",transitionDuration:"750ms",transitionTimingFunction:"ease-out",opacity:S?1:0,children:(0,ed.jsx)(ew.yE,{doc:k,editorId:"main",docId:t,theme:s||void 0,extensions:c,onCreate:function(e){var n=e.editor;v(n),setTimeout(function(){o&&o(n)},10)},readOnly:!0,initialContent:null===(n=C.snapshot)||void 0===n?void 0:n.content.default,scrollingParentSelector:i})}),g&&(0,ed.jsx)(nF,{editor:g,backoffFactor:2}),(void 0===a||a)&&(0,ed.jsx)(rm.m,{})]})},rw=t(16019);function rk(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function rS(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?rk(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rk(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var rE=(o={},(0,a.Z)(o,nz.q.DOC_VIEW,"doc"),(0,a.Z)(o,nz.q.SLIDE_VIEW,"present"),o),rI=function(e){var n=(0,b.I0)(),t=(0,tF.SJ)().mode,r=(0,q.CG)(K.gh),i=(0,j.useCallback)(function(e){var n=e||r,t=(0,tF.SJ)().mode,i=rE[n];t!==i&&(0,t1.lO)({query:rS(rS({},(0,tF.SJ)()),{},{mode:i}),emitChange:!1})},[r]);(0,rw.r)(i,[r]),(0,j.useEffect)(function(){return t1.fI.on("changed",function(){return i()})},[i]),(0,ti.vm)(function(){if(e){var r=t===rE.SLIDE_VIEW?nz.q.SLIDE_VIEW:nz.q.DOC_VIEW,o=(0,tF.sY)().cardId;r===nz.q.SLIDE_VIEW&&(o?(console.debug("[useQuerySync] initializeModeFromQuery - Entering slide view -> spotlightCardById:",o),e.commands.spotlightCardById(o)):(console.debug("[useQuerySync] initializeModeFromQuery - Entering slide view -> spotlightCurrentCard"),e.commands.spotlightCurrentCard())),n((0,K.PM)({mode:r})),i(r)}},[e,n,t,i],[e])},rP=t(87202),rD=t(56692),rA=t(96302),rT=t(10469),rR=t(27440),r_=t(71170),rM=t(56241),rL=t(99336),rz=t(92527),rN=t(89814),rZ=t(56261),rG=(0,rP.ZP)("mod+Escape"),rF=new Set(["h","j","k","l","s","PageUp","PageDown","ArrowRight","ArrowLeft","ArrowDown","ArrowUp","Enter","Escape"]),rU=function(e,n){var t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=(0,n_.cC)("editor"),i=r.scroller;if(i){e.commands.turnOffSpotlight();var o=i.scrollHeight-i.offsetHeight;if("down"===n){if(!(r.isAtBottom(90)&&t&&e.commands.spotlightNextCard(!1,"top"))){var s=i.scrollTop+.5*i.offsetHeight;s>o-150&&(s=o),r.scrollTo({top:s})}}else if(!(r.isAtTop(90)&&t&&e.commands.spotlightNextCard(!0,"bottom"))){var a=i.scrollTop-.5*i.offsetHeight;a<150&&(a=0),r.scrollTo({top:a})}}},rW=function(e){var n=e.enabled,t=e.setActiveKey,r=(0,nE.z$)(),i=(0,q.TL)(),o=(0,nV._i)().editor,s=(0,q.CG)(rL.C),a=(0,rN.g)(o),c=a.enabled,l=a.pos,d=(0,j.useCallback)(function(){c?null==o||o.commands.turnOffSpotlight():null==o||o.commands.spotlightNextBlock()},[null==o?void 0:o.commands,c]);return(0,j.useEffect)(function(){if(n)return rD.F7.on("keydown","NAVIGATION_CONTROLS",function(e){var n,i,a=(0,q.bh)(),u=e.target,f=Object.keys((0,K.X9)(a.getState()).tree);if(!o||null!=u&&null!==(n=u.closest)&&void 0!==n&&n.call(u,"[data-gamma-child-tiptap-editor]")||null!=u&&null!==(i=u.closest)&&void 0!==i&&i.call(u,"input")||e.metaKey||s)return!1;switch(rF.has(e.key)&&("s"!==e.key&&(t(e.key),setTimeout(function(){t(null)},100)),e.preventDefault()),e.key){case"s":return d(),!0;case"l":case"ArrowRight":return(0,rz.p7)(),a.dispatch((0,K.Qx)({attached:!1})),null==r||r.trackDocEvent(nE.AA.PRESENT_MODE_NAVIGATED,{direction:nE.xQ.CARD_NEXT,method:nE.SY.KEYBOARD,key:e.key}),o.commands.spotlightNextCard();case"h":case"ArrowLeft":return(0,rz.p7)(),a.dispatch((0,K.Qx)({attached:!1})),null==r||r.trackDocEvent(nE.AA.PRESENT_MODE_NAVIGATED,{direction:nE.xQ.CARD_PREV,method:nE.SY.KEYBOARD,key:e.key}),o.commands.spotlightNextCard(!0);case"j":case"ArrowDown":case"PageDown":if((0,rz.p7)(),a.dispatch((0,K.Qx)({attached:!1})),!c){var p=(0,rh.ei)(o.state.selection);return o.commands.goToNextExpandableNode()||rU(o,"down",!p),!0}return null==r||r.trackDocEvent(nE.AA.PRESENT_MODE_NAVIGATED,{direction:nE.xQ.TELEPROMPTER_DOWN,method:nE.SY.KEYBOARD,key:e.key}),o.commands.spotlightNextBlock();case"k":case"ArrowUp":case"PageUp":if((0,rz.p7)(),a.dispatch((0,K.Qx)({attached:!1})),!c){var h=(0,rh.ei)(o.state.selection);return o.commands.goToNextExpandableNode(!0)||rU(o,"up",!h),!0}return null==r||r.trackDocEvent(nE.AA.PRESENT_MODE_NAVIGATED,{direction:nE.xQ.TELEPROMPTER_UP,method:nE.SY.KEYBOARD,key:e.key}),o.commands.spotlightNextBlock(!0);case"r":if(f[0])return(0,rz.p7)(),o.commands.spotlightCardById(f[0]),a.dispatch((0,K.Qx)({attached:!1})),!0;return!1;case"Escape":if(rG(e))return!1;var x=c&&l;if(o.commands.spotlightCollapseNearestExpandableNode(x?l:null))return o.commands.reHighlightExpandableNode(),!0;if(c)return o.commands.turnOffSpotlight(),!0;return a.dispatch((0,K.Qx)({attached:!1})),null==r||r.track(nE.AA.CARD_COLLAPSED,{is_present_mode:!0,method:"escape_key"}),o.commands.ascendUpToParentCard(!1);case"Enter":var m=c&&l;if(o.commands.expandOrCollapseExpandableNode(m?l:null))return!0;if(m){var g=o.state.doc.resolve(l).parent;if(g&&(0,rZ.AH)(g))return(0,rZ.xB)(g.attrs.id,!1),o.commands.spotlightNextBlock(!0),!0;return o.commands.spotlightCollapseNearestExpandableNode(l)}return!1;default:return!1}})},[o,i,r,n,d,c,l,s,t]),c},rH=function(e){var n=new KeyboardEvent("keydown",{key:e});t.g.dispatchEvent(n)},rV={ArrowUp:{icon:ee.FP,label:(0,ed.jsx)(l.cC,{id:"VbggDE"}),ariaLabel:function(){return d.ag._({id:"VbggDE"})},shortcuts:["","K"],key:"ArrowUp",onClick:function(){rH("ArrowUp")},gridPos:[1,2]},ArrowLeft:{icon:et.ac,label:(0,ed.jsx)(l.cC,{id:"4jciC3"}),ariaLabel:function(){return d.ag._({id:"4jciC3"})},shortcuts:["","H"],key:"ArrowLeft",onClick:function(){rH("ArrowLeft")},gridPos:[2,1]},ArrowDown:{icon:$.r5,label:(0,ed.jsx)(l.cC,{id:"e3GOIZ"}),ariaLabel:function(){return d.ag._({id:"e3GOIZ"})},shortcuts:["","J"],key:"ArrowDown",onClick:function(){rH("ArrowDown")},gridPos:[2,2]},ArrowRight:{icon:en.eF,label:(0,ed.jsx)(l.cC,{id:"ZjQRVw"}),ariaLabel:function(){return d.ag._({id:"ZjQRVw"})},shortcuts:["","L"],key:"ArrowRight",onClick:function(){rH("ArrowRight")},gridPos:[2,3]},Spotlight:{icon:rT.GT,label:(0,ed.jsx)(l.cC,{id:"Xon9jp"}),ariaLabel:function(){return d.ag._({id:"Xon9jp"})},shortcuts:["S"],key:"S",onClick:function(){rH("s")},gridPos:[1,3]}},rB=function(e){var n=e.shortcuts;return(0,ed.jsx)(f.x,{as:"span",color:"gray.400",ml:2,children:n.map(function(e,t){return(0,ed.jsxs)(j.Fragment,{children:[e,t===n.length-1?null:(0,ed.jsx)(f.x,{fontSize:"11px",as:"span",color:"gray.500",mx:1,children:"or"})]},e)})})},rq=function(e){var n=e.activeKey,t=e.spotlightingByBlock;return(0,ed.jsx)(eS.h,{children:(0,ed.jsxs)(p.xu,{position:"absolute",bottom:4,right:6,zIndex:"sticky",children:[(0,ed.jsx)(es.X,{children:(0,ed.jsx)(l.cC,{id:"wja8aL"})}),(0,ed.jsx)(rR.r,{gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"repeat(2, 1fr)",children:Object.values(rV).map(function(e){var r=e.gridPos,i=e.icon,o=e.label,s=e.ariaLabel,a=e.shortcuts,c=e.key,l=e.onClick,d=n===c;return(0,ed.jsx)(r_.P,{gridColumn:r[1],gridRow:r[0],children:(0,ed.jsx)(rM.u,{hasArrow:!0,placement:"top",label:(0,ed.jsxs)(f.x,{whiteSpace:"nowrap",children:[o,(0,ed.jsx)(rB,{shortcuts:a})]}),children:(0,ed.jsx)(A.h,{m:1,shadow:"base",size:"md",variant:"S"==c&&t?"solid":"plain",isActive:d||"S"===c&&t,onClick:l,onMouseDown:function(e){return e.preventDefault()},"aria-label":s(),icon:(0,ed.jsx)(x.G,{icon:i})})})},c)})})]})})},rK=t(5751),rY=t(26721),rJ=t(9088),rQ=t(30893),rX=t(40771),r$=t(8022),r0=t(95258),r1=t(63849),r2=t(2575),r5=t(17651),r3=t(72466),r4=t(6185),r6=t.n(r4),r8=t(68642),r9=t(27875),r7=t.n(r9),ie=t(18149),it=t.n(ie),ir=t(98875),ii=t(6057),io=t(74542),is={easeOutLinear:io.gA,easeOutSine:io.vh,easeOutCubic:io.w2,easeOutCirc:io.ei,easeOutQuad:io.hl,easeOutQuart:io.Y3,easeOutExpo:io.ad,bezierCustom1:r6()(.13,.97,.035,.73),bezierCustom2:r6()(.105,1.15,.15,.355)},ia={UP:"up",DOWN:"down"},ic=function(e){return e?+new Date-+new Date(e):1/0},il=function(e,n){var t=(0,j.useMemo)(function(){return new r8.Lethargy(6,120,.3,150)},[]),r=n||{},i=r.easing,o=void 0===i?"easeOutCubic":i,s=r.touchpadFactor,a=void 0===s?1.5:s,c=r.triggerThreshold,l=void 0===c?1200:c,d=(0,n_.As)("editor"),u=(0,q.CG)(K.i2),f=(0,j.useRef)(null),p=(0,j.useRef)(null),h=(0,j.useRef)(null),x=(0,j.useRef)(!1),m=(0,j.useRef)(null),g=(0,j.useRef)(null),v=(0,j.useState)(!1),b=v[0],y=v[1],C=(0,j.useState)(!1),O=C[0],w=C[1],k=(0,j.useRef)({counterTarget:0,counterCurrent:0,direction:ia.DOWN}),S=(0,j.useCallback)(function(){if(f.current){var e,n=k.current.counterTarget/l*100,t=(null!=n?n:0)*2.64,r="".concat(t," ").concat(264-t),i=null===(e=f.current.querySelector(".chakra-progress"))||void 0===e?void 0:e.lastElementChild,o=f.current.querySelector(".chakra-progress__indicator");o&&o.setAttribute("stroke-dasharray",r),i&&(i.innerHTML="".concat(n.toFixed(0),"%"))}},[l]),E=(0,j.useCallback)(function(){var e=h.current,n=p.current;if(n&&e){var t=e.querySelector(".chakra-progress__indicator"),r=n.querySelector(".chakra-progress__indicator");if(t&&r){var i=k.current.counterCurrent/l,s=(550>ic(g.current)?1:null!=i?i:0)*264,a="".concat(s," ").concat(264-s),c=Math.max(56-56*is[o](Math.min(i,1)),0);e.style.transform="translateY(".concat(c,"px)"),n.style.transform="translateY(-".concat(c,"px)"),r.setAttribute("stroke-dasharray",a),t.setAttribute("stroke-dasharray",a)}}},[o,l]),I=(0,j.useCallback)(function(){if(!x.current){var e;requestAnimationFrame(function n(t){var r=e?t-e:0;if(e=t,.1>Math.abs(k.current.counterTarget-k.current.counterCurrent)){k.current.counterCurrent=k.current.counterTarget,E(),x.current=!1;return}k.current.counterCurrent=(0,io.t7)(k.current.counterCurrent,k.current.counterTarget,r7()(.3*(60/(r?1e3/r:60)),.3,1)),E(),requestAnimationFrame(n)})}},[E]),P=(0,j.useCallback)(function(){k.current.counterTarget=0,y(!1),w(!1),S(),I()},[I,S]);return(0,j.useEffect)(function(){if(!u||!e)return P();var n,r,i=document.querySelector((0,ii.U8)(u));if(!i)return P();var o=function(n){if(!n.target.closest("[data-comments-wrapper]")){var i=t.check(n);if(null!==h.current&&null!==p.current){var o=ic(m.current);if(!(o<500)&&(!(o<1e3)||!1!==i)){var s=ic(g.current);if(!(s<500)&&(!(s<1e3)||!1!==i)){var c=0===Math.abs(n.deltaY)?k.current.direction:n.deltaY>0?ia.DOWN:ia.UP;if("down"===c?d.isAtBottom():d.isAtTop()){clearTimeout(r);var u=n.wheelDeltaY?n.wheelDeltaY===-3*n.deltaY:0===n.deltaMode,f=Math.abs(void 0!==n.deltaY?n.deltaY:40)*(u?a:1);if(c!==k.current.direction){k.current.direction=c,P();return}w(c===ia.DOWN),y(c===ia.UP),k.current.counterTarget+=f,k.current.direction=c,k.current.counterTarget/l>=1?(e.commands.spotlightNextCard(c===ia.UP,c===ia.UP?"bottom":"top"),g.current=+new Date,setTimeout(function(){P(),S()},250),setTimeout(function(){g.current=null},1e3)):r=setTimeout(P,500),I(),S()}}}}}},s=function(){m.current=+new Date,clearTimeout(n),P(),n=setTimeout(function(){m.current=null},1e3)};return i.addEventListener("scroll",s),i.addEventListener("wheel",o,{passive:!0}),S(),function(){i.removeEventListener("scroll",s),i.removeEventListener("wheel",o)}},[e,t,I,o,a,l,d,S,E,P,u]),{debugRef:f,nextCardRef:h,prevCardRef:p,showNextCard:O,showPrevCard:b}},id=function(e){var n=e.editor,t=(0,ir.ye)("debugLogging"),r=(0,j.useState)("easeOutExpo"),i=r[0],o=r[1],s=(0,j.useState)(1.5),a=s[0],c=s[1],l=(0,j.useState)(1200),d=l[0],u=l[1],f=il(n,{easing:i,touchpadFactor:a,triggerThreshold:d}),p=f.debugRef,h=f.nextCardRef,x=f.prevCardRef,m=f.showNextCard,g=f.showPrevCard,v=(0,q.CG)(function(e){var n=(0,K.i2)(e)||"",t=(0,K.X9)(e),r=Object.keys((t.parents[n]||[]).reduce(function(e,n){return e[n]},t.tree)),i=null,o=null;return r.forEach(function(e,s){if(e===n){var a=t.parents[n];0===s?a.length&&(i={cardId:a[a.length-1],isSibling:!1}):i={cardId:r[s-1],isSibling:!0},s===r.length-1?a.length&&(o={cardId:a[a.length-1],isSibling:!1}):o={cardId:r[s+1],isSibling:!0}}}),{prevCard:i,nextCard:o}},it()),b=v.prevCard,y=v.nextCard,C=null==y?void 0:y.cardId,O=null==b?void 0:b.cardId,w=(0,j.useMemo)(function(){var e=null,t=null;return n&&n.state.doc.descendants(function(n){return!(0,nM.KH)(n)||(n.attrs.id===O?e=n:n.attrs.id===C&&(t=n),!!(!e&&O)||!!(!t&&C))}),{prev:e,next:t}},[n,C,O]);return(0,ed.jsxs)(ed.Fragment,{children:[t&&(0,ed.jsx)(iu,{ref:p,setEasing:o,setTouchpadFactor:c,setTriggerThreshold:u}),(0,ed.jsx)(ip,{ref:x,direction:"up",node:w.prev,enabled:g,offset:16}),(0,ed.jsx)(ip,{ref:h,direction:"down",node:w.next,enabled:m,offset:24})]})},iu=j.forwardRef(function(e,n){var t=e.setEasing,r=e.setTouchpadFactor,i=e.setTriggerThreshold;return(0,ed.jsxs)(u.k,{position:"absolute",alignItems:"center",bg:"gray.100",left:2,bottom:16,zIndex:"overlay",borderRadius:"md",border:"solid 2px var(--chakra-colors-trueblue-300)",p:1,children:[(0,ed.jsxs)(rJ.v,{closeOnSelect:!1,children:[(0,ed.jsx)(rQ.j,{as:el.z,colorScheme:"trueblue",children:"Options"}),(0,ed.jsxs)(rX.q,{minWidth:"240px",children:[(0,ed.jsx)(m.kH,{label:"How much total scrolling work do we need to do to trigger next/prev card?",placement:"right",children:(0,ed.jsxs)(f.x,{color:"gray",fontSize:"sm",fontWeight:"600",ml:2,pb:2,children:["Scroll Threshold"," ",(0,ed.jsxs)("i",{children:["(default=",1200,")"]})]})}),(0,ed.jsxs)(r$.Y2,{defaultValue:1200,min:100,max:1e4,precision:0,step:100,onChange:function(e,n){return i(n)},children:[(0,ed.jsx)(r$.zu,{}),(0,ed.jsxs)(r$.Fi,{children:[(0,ed.jsx)(r$.WQ,{}),(0,ed.jsx)(r$.Y_,{})]})]}),(0,ed.jsx)(r0.R,{}),(0,ed.jsx)(m.kH,{label:"How much extra weight do we give to touchpad scroll events?",placement:"right",children:(0,ed.jsxs)(f.x,{color:"gray",fontSize:"sm",fontWeight:"600",ml:2,pb:2,children:["Touchpad Multiplier"," ",(0,ed.jsxs)("i",{children:["(default=",1.5,")"]})]})}),(0,ed.jsxs)(r$.Y2,{defaultValue:1.5,min:1,max:10,precision:1,step:.1,onChange:function(e,n){return r(n)},children:[(0,ed.jsx)(r$.zu,{}),(0,ed.jsxs)(r$.Fi,{children:[(0,ed.jsx)(r$.WQ,{}),(0,ed.jsx)(r$.Y_,{})]})]}),(0,ed.jsx)(r0.R,{}),(0,ed.jsxs)(r1._,{defaultValue:"easeOutExpo",title:"Easing (of peek element)",type:"radio",onChange:function(e){return t(e)},children:[(0,ed.jsx)(r2.i,{value:"easeOutLinear",children:"easeOutLinear"}),(0,ed.jsx)(r2.i,{value:"easeOutSine",children:"easeOutSine"}),(0,ed.jsx)(r2.i,{value:"easeOutCubic",children:"easeOutCubic"}),(0,ed.jsx)(r2.i,{value:"easeOutCirc",children:"easeOutCirc"}),(0,ed.jsx)(r2.i,{value:"easeOutQuad",children:"easeOutQuad"}),(0,ed.jsx)(r2.i,{value:"easeOutQuart",children:"easeOutQuart"}),(0,ed.jsx)(r2.i,{value:"easeOutExpo",children:"easeOutExpo"}),(0,ed.jsx)(r2.i,{value:"bezierCustom1",children:"bezierCustom1"}),(0,ed.jsx)(r2.i,{value:"bezierCustom2",children:"bezierCustom2"})]})]})]}),(0,ed.jsx)(u.k,{ref:n,direction:"column",alignItems:"center",width:"85px",ml:1,sx:{".chakra-progress__indicator":{transition:"none !important",opacity:1}},children:(0,ed.jsx)(r5.D,{value:40,color:"trueblue.500",children:(0,ed.jsx)(r3.i,{})})})]})});iu.displayName="PeekDebugger";var ip=j.forwardRef(function(e,n){var t=e.direction,r=e.enabled,i=e.node,o=e.offset,s=(0,j.useState)(!1),a=s[0],c=s[1],l=(0,j.useState)(i),d=l[0],p=l[1];(0,j.useEffect)(function(){c(!0);var e=setTimeout(function(){c(!1),p(i)},550);return function(){clearTimeout(e)}},[i]);var h=(0,j.useMemo)(function(){return d?(0,eW.getCardTitle)(d.toJSON()):""},[d]),m=!!d;return(0,ed.jsx)(u.k,{ref:n,pointerEvents:"none",position:"absolute",justifyContent:"center",width:"100%",zIndex:"overlay",top:"up"===t?"".concat(o,"px"):"inherit",bottom:"down"===t?"".concat(o,"px"):"inherit",children:(0,ed.jsxs)(u.k,{bg:"gray.100",borderRadius:"md",boxShadow:"md",h:"".concat(40,"px"),maxWidth:"450px",justifyContent:"center",opacity:r?1:0,transition:"opacity ".concat(300,"ms ease-out"),textAlign:"center",alignItems:"center",direction:"row",px:2,sx:{".chakra-progress__indicator":{transition:"none !important",opacity:1}},children:[(0,ed.jsx)(r5.D,{display:m?"block":"none",color:"trueblue.500",size:"20px",thickness:"16px",children:(0,ed.jsx)(r3.i,{visibility:a?"visible":"hidden",children:(0,ed.jsx)(x.G,{icon:tU.faCircleCheck,fontSize:"14px",style:{color:"var(--chakra-colors-gray-100)",backgroundColor:"var(--chakra-colors-trueblue-500)",borderRadius:"10px"}})})}),m||"up"!==t?m||"down"!==t?null:(0,ed.jsx)(x.G,{icon:rK.m5,size:"xs",color:"var(--chakra-colors-gray-600)"}):(0,ed.jsx)(x.G,{icon:rY.yt,size:"xs",color:"var(--chakra-colors-gray-600)"}),(0,ed.jsx)(u.k,{width:1}),(0,ed.jsx)(f.x,{noOfLines:1,textOverflow:"ellipsis",overflowX:"hidden",fontSize:"md",color:m?"gray.800":"gray.600",px:2,children:m?h:"down"===t?"End of presentation":"Start of presentation"})]})})});ip.displayName="PeekCardTab";var ih=t(12741),ix=function(){var e=(0,j.useState)(["",[],{}]),n=e[0],t=e[1],r=(0,q.qr)();return(0,j.useEffect)(function(){return r.subscribe(function(){var e=r.getState(),n=(0,K.X9)(e),i=(0,K.i2)(e)||"",o=n.parents[i]||[],s={};Object.keys(n.tree).forEach(function(e){var t=[];(function e(n){Object.keys(n).forEach(function(r){t.push(r),e(n[r])})})(n.tree[e]),s[e]=t}),t([i,o,s])})},[r]),n},im=function(){var e=ix(),n=(0,S.Z)(e,3),t=n[0],r=n[1],i=n[2],o=Object.keys(i);return(0,ed.jsx)(er.U,{position:"fixed",bottom:0,w:"100vw",zIndex:10,background:"blackAlpha.200",px:"6px",py:"2px",align:"end",spacing:"2px",opacity:t?1:0,transitionProperty:"opacity",transitionDuration:"normal",children:o.map(function(e,n){var s=[].concat((0,ih.Z)(r),[t])[0],a=o.indexOf(s),c=i[s],l=0,d=100;return t&&c&&-1===o.indexOf(t)&&(l=(c.indexOf(t)+1)/c.length*100,d=1/c.length*100),(0,ed.jsx)(ij,{cardId:e,state:n===a?"current":n<=a?"prev":"next",percent:l,unit:d},e)})})},ig="var(--chakra-colors-trueblue-200)",iv="var(--chakra-colors-trueblue-100)",ij=function(e){var n=e.cardId,t=e.state,r=e.percent,i=e.unit,o="linear-gradient(to right, ".concat(ig," 0% ").concat(r,"%, ").concat("var(--chakra-colors-trueblue-300)"," ").concat(r,"% ").concat(r+i,"%, ").concat(iv," ").concat(r+i,"% 100%)");return(0,ed.jsx)(u.k,{borderRadius:"2px",flex:"1",h:"6px",bg:"current"===t?o:"prev"===t?ig:iv},n)},ib=(0,rP.ZP)("Esc"),iy=function(e){var n=e.editor,t=e.showNavigationControls,r=(0,b.v9)(K.gh)===nz.q.SLIDE_VIEW,i=(0,j.useState)(null),o=i[0],s=i[1],a=(0,b.v9)(K.JA),c=(0,j.useRef)(a),d=(0,b.I0)(),p=rW({enabled:r&&!a,setActiveKey:s});return(0,j.useEffect)(function(){d((0,K.e)({isEditingInSlideView:!1}))},[r,d]),c.current=a,(0,j.useEffect)(function(){return rD.F7.on("keydown","SLIDE_VIEW",function(e){return!!(c.current&&ib(e))&&(d((0,K.e)({isEditingInSlideView:!1})),e.preventDefault(),!0)})},[d]),(0,rA.us)(),(0,ed.jsxs)(ed.Fragment,{children:[r&&(0,ed.jsx)(id,{editor:n}),r&&(0,ed.jsx)(im,{}),r&&(0,ed.jsx)(u.k,{position:"absolute",inset:0,width:"100%",height:"100%",pointerEvents:"none",justify:"flex-end",children:(0,ed.jsxs)(u.k,{bg:"gray.50",position:"fixed",bottom:6,right:6,p:3,px:6,justify:"flex-end",align:"center",opacity:a?1:0,pointerEvents:a?"auto":"none",transitionProperty:"opacity, transform",transitionDuration:"normal",transitionTimingFunction:"ease",transform:a?"translate(0,0)":"translate(0,100%)",borderRadius:"md",shadow:"md",zIndex:"overlay",children:[(0,ed.jsx)(f.x,{size:"sm",mr:3,children:(0,ed.jsx)(l.cC,{id:"DjD/sG"})}),(0,ed.jsx)(el.z,{size:"sm",variant:"solid",onClick:function(){return d((0,K.e)({isEditingInSlideView:!1}))},children:(0,ed.jsx)(l.cC,{id:"DPfwMq"})})]})}),r&&t&&(0,ed.jsx)(rq,{activeKey:o,spotlightingByBlock:p})]})},iC=t(85946),iO=t(13414),iw=t(89634),ik=t(24224),iS={duration:.25,delay:.75},iE={duration:.25},iI={initial:{x:"calc(-100% - 40px)"},animate:{x:"0",transition:iS},exit:{x:"calc(-100% - 40px)"}},iP="filmstrip-root",iD=".".concat(iP),iA=t(83484),iT=t(6110),iR=t(38815),i_=t(11895),iM=t(52949);function iL(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function iz(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?iL(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):iL(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var iN=function(e){var n=(0,i_.i)(e),t=n.content,r=n.selection,i=!!(null!=t&&t.content),o=(0,j.useMemo)(function(){if(!i)return[];var e,n=t.content,r=(null==n?void 0:n[0].content)||[],o=null===(e=t.content)||void 0===e?void 0:e[0].attrs;return r.map(function(e){var n;return o&&null!==(n=e.attrs)&&void 0!==n&&n.id?{cardId:e.attrs.id,isDragging:!1,displayBehavior:"normal",previewJson:{type:"doc",content:[{type:"document",content:[e],attrs:o}]}}:null}).filter(function(e){return null!==e})},[t,i]),s=(0,q.CG)(iM.ZD).map(function(e){var n=o.find(function(n){return n.cardId===e.cardId});return n?iz(iz({},e),{},{previewJson:n.previewJson}):null}).filter(function(e){return null!==e}),a=(0,q.CG)(iM.Ae);return{isDragging:a,cards:a?s:o,selection:r,isLoaded:i}},iZ=t(5715),iG=t(46802),iF=t(86378),iU=t(1587),iW=t(43926),iH=t(82904),iV=t(38564),iB=t(7935),iq=t(9850),iK=t.n(iq),iY=t(78308),iJ=t(16975),iQ=t(90399),iX=t(60636),i$=t(33295),i0=function(e){var n=(0,q.CG)(iR.wg),t=(0,q.CG)(iR.zq),r=(0,q.TL)(),i=(0,eN.p)(),o=(0,q.qr)(),s=(0,j.useCallback)(function(t,r){if(e){var o,s=(0,nM.Lz)(e,n);if(s.length){var a=n3.HY.from(s),c=(0,no.G8)(a,e.schema);if(!c){i({title:(0,ed.jsx)(l.cC,{id:"fFgBN7",values:{errorMessage:r}}),status:"error",duration:3e3,position:"top"});return}null===(o=document.getSelection())||void 0===o||o.removeAllRanges(),eV()(c,{format:"text/html"}),i({title:(0,ed.jsx)(l.cC,{id:"8p/xVT",values:{0:s.length,1:t.one,2:t.other}}),status:"success",duration:3e3,position:"top"})}}},[e,n,i]),a=(0,j.useCallback)(function(){s({one:"Copied card.",other:"Copied ".concat(n.length," cards.")},"Error copying card.")},[s,n]),c=(0,j.useCallback)(function(){if(e){var t=(0,iR.ym)((0,q.bh)().getState());r((0,iR.jf)()),e.commands.deleteCardsById(n);var i=iV.Gk.getState(e.state).undoManager;i.undoStack[i.undoStack.length-1].meta.set("filmstripState",t)}},[r,e,n]),u=(0,j.useCallback)(function(){if(e){var t="";if(1===n.length){var r=(0,nM.Bw)(e,n[0]);r&&(t=(0,iB.getCardTitle)(r.node.toJSON()))}c();var o=t?'"'.concat(t,'"'):d.ag._({id:"FyJPFh"}),s=i({title:(0,ed.jsxs)(er.U,{children:[(0,ed.jsx)(f.x,{noOfLines:1,children:(0,ed.jsx)(l.cC,{id:"OJTPnC",values:{0:n.length,1:n.length,displayTitle:o}})}),(0,ed.jsx)(eZ.r,{textDecoration:"underline",onClick:function(){(0,eU.Yw)(e.state),i.close(s)},children:(0,ed.jsx)(l.cC,{id:"9uI/rE"})})]}),status:"info",duration:3e3,position:"top"})}},[c,e,n,i]),p=(0,j.useCallback)(function(){s({one:"Cut card.",other:"Cut ".concat(n.length," cards")},"Error cutting card."),c()},[c,s,n]),h=(0,j.useCallback)(function(){if(e){var r=(0,nM.Lz)(e,n);if(r.length){var o=(0,nM.Bw)(e,t),s=o?o.pos+o.node.nodeSize:e.state.doc.content.size-1,a=r.map(function(e){return(0,i$.h)(iK()(e.toJSON()))}).map(function(e){return(0,iQ.Zs)(e)});e.chain().insertContentAt(s,a,{updateSelection:!1}).command(function(e){var n=e.tr,t=(0,iX.t)(n.doc.resolve(s));return t&&(n=n.setSelection(t)),!0}).scrollIntoView().run(),i({title:(0,ed.jsx)(l.cC,{id:"ClnFsQ",values:{0:r.length,1:r.length}}),status:"success",duration:3e3,position:"top"})}}},[e,t,i,n]);return{handleAddCard:(0,j.useCallback)(function(){if(e){var n=(0,iR.zq)(o.getState()),t=(0,nM.Bw)(e,n);if(t){var r=t.pos,i=e.view.state.doc.nodeAt(r);if(!i){console.error("[Filmstrip] Cannot append card. Node unknown");return}var s=r+i.nodeSize,a=iJ.e1.blankCard;(0,iJ.ZT)({key:"blankCard",nodeName:"card"},iY.fe.FILMSTRIP_CARD_MENU),e.chain().insertContentAt(s,(0,iQ.Zs)(a),{updateSelection:!1}).command(function(e){var n=e.tr,t=(0,iX.t)(n.doc.resolve(s));return t&&(n=n.setSelection(t)),!0}).scrollIntoView().run()}}},[e,o]),handleCopy:a,handleDelete:u,handleCut:p,handleDuplicate:h}},i1=["children","icon","onClick","shouldHide"];function i2(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function i5(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i2(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var i3=function(e){var n=e.children,t=e.icon,r=e.onClick,i=e.shouldHide,o=(0,eI.Z)(e,i1);return void 0!==i&&i?null:(0,ed.jsx)(iH.s,i5(i5({icon:t,onClick:r},o),{},{children:n}))},i4=(0,j.memo)(function(e){var n=e.isDark;return(0,ed.jsxs)(p.xu,{as:"span",className:"fa-layers fa-fw",children:[(0,ed.jsx)(x.G,{fixedWidth:!0,icon:iW.faRectangle}),(0,ed.jsx)(x.G,{icon:iG.di,transform:"shrink-4 right-6 down-4",color:"var(--menu-bg, white)"}),(0,ed.jsx)(x.G,{icon:iG.di,transform:"shrink-7 right-6 down-4"}),(0,ed.jsx)(x.G,{icon:iZ.r8,color:n?"var(--chakra-colors-gray-800)":"var(--chakra-colors-gray-100)",transform:"shrink-10 right-6 down-4"})]})});i4.displayName="AddCardIcon";var i6=function(e,n){if(0===e.length||!n)return null;if(1===e.length){var t=(0,nM.Bw)(n,e[0]);return t?(0,eW.getCardTitle)(t.node.toJSON())||"Untitled card":null}return"Multiple cards selected"},i8=(0,j.forwardRef)(function(e,n){var t=e.editor,r=e.isOpen,i=e.onClose,o=e.readOnly,s=e.clearPositioning,a=e.rootStyles,c=e.isDark,d=(0,q.CG)(K.yx),u=(0,eN.p)(),p=i0(t),h=p.handleCopy,g=p.handleDelete,v=p.handleCut,b=p.handleDuplicate,y=p.handleAddCard,C=(0,q.CG)(iR.wg),O=1===C.length,w=(0,j.useMemo)(function(){return O?(0,tF.gq)({cardId:C[0],docId:null==d?void 0:d.id,isPresentMode:!1}):""},[null==d?void 0:d.id,O,C]),k=(0,eG.V)(w).onCopy,S=(0,j.useCallback)(function(){k(),u({title:(0,ed.jsx)(l.cC,{id:"h5GS+N"}),status:"success",duration:3e3,position:"top"})},[k,u]),E=(0,na.K)(),I=(0,j.useMemo)(function(){return i6(C,t)},[t,C]),P=(0,j.useMemo)(function(){return c?{"--menu-bg":"var(--chakra-colors-gray-900)","&:focus":{"--menu-bg":"var(--chakra-colors-gray-800)"}}:{}},[c]);return(0,ed.jsx)(rJ.v,{isOpen:r,onClose:i,children:(0,ed.jsxs)(rX.q,{className:"filmstrip-card-menu",onContextMenu:function(e){e.preventDefault()},zIndex:"popover",ref:n,rootProps:{style:a},w:"260px",overflowY:"auto",onTransitionEnd:function(){r||s()},children:[I&&(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(f.x,{pl:3,color:c?"gray.400":"gray.600",noOfLines:1,children:I}),(0,ed.jsx)(r0.R,{})]}),(0,ed.jsx)(i3,{shouldHide:o,command:(0,m.cE)("Mod+X"),icon:(0,ed.jsx)(x.G,{fixedWidth:!0,icon:iU.XV}),onClick:v,children:(0,ed.jsx)(l.cC,{id:"cCd8Bs"})}),(0,ed.jsx)(i3,{shouldHide:o,command:(0,m.cE)("Mod+C"),icon:(0,ed.jsx)(x.G,{fixedWidth:!0,icon:iF.kZ}),onClick:h,children:(0,ed.jsx)(l.cC,{id:"he3ygx"})}),(0,ed.jsx)(i3,{shouldHide:o,command:(0,m.cE)("Mod+D"),icon:(0,ed.jsx)(x.G,{fixedWidth:!0,icon:eL.WM}),onClick:b,children:(0,ed.jsx)(l.cC,{id:"euc6Ns"})}),(0,ed.jsx)(i3,{shouldHide:o,icon:(0,ed.jsx)(i4,{isDark:c}),onClick:y,sx:P,children:(0,ed.jsx)(l.cC,{id:"90n2YU"})}),!o&&(0,ed.jsx)(r0.R,{}),O&&(0,ed.jsx)(i3,{icon:(0,ed.jsx)(ns.x,{isLocked:!E,isDark:c}),onClick:S,children:(0,ed.jsx)(l.cC,{id:"F0YmUY"})}),(0,ed.jsx)(i3,{color:c?"red.300":"red.500",icon:(0,ed.jsx)(x.G,{icon:e_.$,fixedWidth:!0}),onClick:g,shouldHide:o,children:(0,ed.jsx)(l.cC,{id:"cnGeoo"})})]})})});i8.displayName="FilmstripCardMenuComponent";var i9=(0,j.memo)(i8),i7=t(34717),oe=t(8635),on=t(43227),ot=(0,j.memo)(function(e){var n=e.docJson,t=e.theme,r=(0,q.CG)(K.yx),i=(0,j.useMemo)(function(){return{doc:r}},[r]);return(0,ed.jsx)(u.k,{sx:tn.n,css:{"--editor-font-size":"0.125rem","--editor-width":"".concat(100,"px"),"--thumbnail-min-height":"40px"},justifyContent:"center",overflow:"hidden",pointerEvents:"none",bg:"gray.100",minH:"var(--thumbnail-min-height)",w:"var(--editor-width)",children:(0,ed.jsx)(tn.m,{content:n,theme:t,isThumbnail:!0,reduxData:i})})},function(e,n){return it()(e.docJson,n.docJson)&&e.theme.updatedTime===n.theme.updatedTime&&e.theme.id===n.theme.id});function or(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function oi(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?or(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):or(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}ot.displayName="FilmstripPreviewEditor";var oo=(0,eK.E)(u.k),os=function(e){var n=e.card,t=e.index,r=e.isFirst,i=e.isEditorFocused,o=e.currentFocusedCard,s=e.isFilmstripSelected,a=e.theme,c=e.showScreenshots,l=e.screenshotsEnabled,d=e.readOnly,h=e.shouldHide,x=e.isDragInProgress,g=e.useXsFontSize,v=e.numberOfCardsDragging,b=e.onContextClick,y=n.cardId,C=n.isDragging,O=n.previewJson,w=(0,q.TL)(),k=(0,oe.c)(y),S=null==k?void 0:k.previewUrl,E=(0,j.useMemo)(function(){return{boxShadow:s?"var(--fs-item-selected-box-shadow)":i?"var(--fs-item-focused-box-shadow)":"0 0 0 1px var(--fs-item-border-color)"}},[i,s]),I=(0,j.useCallback)(function(e){if(y){var n=e.shiftKey,t=!n&&(e.metaKey||e.ctrlKey);if(n&&!d)w((0,iR.YC)({id:y,currentFocusedCard:o}));else if(t&&!d)w((0,iR.sY)({id:y}));else{if(x)return;w((0,iR.Ti)({id:y})),w((0,K.Qx)({attached:!1}));var r=(0,tF.sY)().cardId;(0,on.D)({cardId:y,method:r===y?"replace":"push"})}}},[d,o,w,y,x]);return(0,ed.jsx)(p.xu,{pos:"relative",className:"filmstrip-item",pt:1,mt:r?void 0:1,onClick:I,onContextMenu:b,cursor:"pointer",userSelect:"none",transitionProperty:"common",transitionDuration:"normal",display:h?"none":void 0,children:(0,ed.jsxs)(u.k,{justifyContent:"space-between",align:"flex-start",gap:"6px",children:[(0,ed.jsx)(f.x,{lineHeight:1,transitionProperty:"common",transitionDuration:"normal",opacity:C?0:1,textAlign:"center",color:s?"var(--fs-item-selected-text-color)":"inherit",fontSize:g?"xs":"sm",w:g?6:5,children:t}),(0,ed.jsxs)(p.xu,{position:"relative",children:[(0,ed.jsx)(p.xu,oi(oi({},E),{},{borderRadius:"md",overflow:"hidden",children:c?(0,ed.jsx)(m.qh,{src:l?S:i7.Z.src,fallbackSrc:i7.Z.src,shouldShow:!!S,w:"100px",m:1}):(0,ed.jsx)(ot,{theme:a,docJson:O})})),(0,ed.jsx)(eY.M,{children:v&&(0,ed.jsx)(u.k,{position:"absolute",bottom:0,left:0,transform:"translate(-50%, 50%)",children:(0,ed.jsx)(oo,{initial:{scale:.5,opacity:0},exit:{scale:.5,opacity:0},animate:{scale:1,opacity:1},h:5,minW:5,px:1,borderRadius:"full",bg:"trueblue.300",color:"white",fontSize:"xs",fontWeight:600,boxShadow:"sm",justify:"center",align:"center",children:(0,ed.jsx)(f.x,{children:v})},"badge-number")})})]})]})})},oa=function(e,n){if(!e||!n)return{id:null,pos:null};var t=e.$from,r=e.from,i=e.to,o=null,s=null;return t.doc.nodesBetween(r,i,function(e,n){var r=t.doc.resolve(n).depth;return!(!o&&(0,nM.KH)(e))||1!==r||(o=e.attrs.id,s=n,!1)}),{id:o,pos:s}},oc=function(){var e;return!!(null!==(e=document.activeElement)&&void 0!==e&&e.closest(iD))},ol=function(){var e=(0,j.useRef)(null),n=(0,j.useState)(!1),t=n[0],r=n[1],i=(0,j.useState)([0,0]),o=i[0],s=i[1],a=(0,j.useState)("bottom"),c=a[0],l=a[1],d=(0,q.TL)(),u=(0,j.useCallback)(function(){r(!1)},[]),f=(0,j.useCallback)(function(){s([0,0]),l("bottom")},[]),p=(0,j.useCallback)(function(e,n){r(!0),s(n)},[]),h=(0,j.useCallback)(function(n){return function(t){t.preventDefault(),d((0,iR.uu)({id:n})),p(n,[t.clientX,t.clientY]);var r,i=null===(r=e.current)||void 0===r?void 0:r.offsetHeight;if(null!=i){var o=window.innerHeight<t.clientY+i,s=t.clientY<i;o&&!s?l("top"):o&&s?l("center"):l("bottom")}}},[d,e,p]),x=(0,j.useMemo)(function(){var n,t=o[1],r=null===(n=e.current)||void 0===n?void 0:n.offsetHeight,i=r?window.innerHeight-(t+r+8):void 0,s="center"===c&&i?"translateY(".concat(i,"px)"):"top"===c?"translateY(-100%)":void 0;return{left:o[0],top:o[1],transform:s,transformOrigin:"top"}},[c,o]);return{menuRef:e,isFilmstripCardMenuOpen:t,onFilmstripCardMenuClose:u,handleContextMenu:h,menuRootStyles:x,clearPositioning:f}},od=function(e){var n=e.isFocused,t=e.readOnly,r=e.firstFocusedCardId,i=e.editor,o=e.isDragging,s=i0(i),a=s.handleCopy,c=s.handleDelete,l=s.handleCut,d=s.handleDuplicate,u=(0,q.TL)();(0,j.useEffect)(function(){return iw.F7.on("keydown","FILMSTRIP",function(e){if(!n)return!1;switch(e.key){case"Escape":if(o)return u((0,iM.vL)()),!0;return!1;case"Backspace":case"Delete":if(!t)return c(),!0;return!1;case"a":case"A":if(!t&&(e.ctrlKey||e.metaKey))return e.preventDefault(),u((0,iR.td)({currentFocusedCard:r})),!0;return!1;case"c":case"C":if(!t&&(e.ctrlKey||e.metaKey))return a(),!0;return!1;case"d":case"D":if(!t&&(e.ctrlKey||e.metaKey))return e.preventDefault(),d(),!0;return!1;case"x":case"X":if(!t&&(e.ctrlKey||e.metaKey))return l(),!0;return!1;case"ArrowDown":return u((0,iR.ut)({direction:"down",withShift:!t&&e.shiftKey,currentFocusedCard:r})),!0;case"ArrowUp":return u((0,iR.ut)({direction:"up",withShift:!t&&e.shiftKey,currentFocusedCard:r})),!0;default:return!1}})},[u,r,n,o,c,a,d,l,t])},ou=t(74993),of=t(12691),op=function(e){var n=(0,q.qr)(),t=(0,eN.p)();(0,j.useEffect)(function(){var r=function(r){var i,o=n.getState();if(e&&oc()&&(0,K.hN)(o)){var s=null===(i=r.clipboardData)||void 0===i?void 0:i.getData("text/html");if(s){var a=(0,ou.T)(s,e.schema).content.content.filter(function(e){return(0,of.KH)(e)});if(a.length){var c=(0,nM.Bw)(e,(0,iR.zq)(o)),d=c?c.pos+c.node.nodeSize:e.state.doc.content.size-1,u=a.map(function(e){return(0,i$.h)(iK()(e.toJSON()))}).map(function(e){return(0,iQ.Zs)(e)});e.chain().insertContentAt(d,u,{updateSelection:!1}).command(function(e){var n=e.tr,t=(0,iX.t)(n.doc.resolve(d));return t&&(n=n.setSelection(t)),!0}).scrollIntoView().run(),r.preventDefault(),t({title:(0,ed.jsx)(l.cC,{id:"3viq5b",values:{0:a.length,1:a.length}}),status:"success",duration:3e3,position:"top"})}}}};return document.addEventListener("paste",r),function(){document.removeEventListener("paste",r)}},[e,n,t])},oh=t(30453),ox=function(){var e=(0,oh.o)(),n=(0,j.useRef)(null),t=(0,j.useRef)(),r=(0,j.useRef)(),i=(0,j.useRef)(),o=(0,j.useCallback)(function(e){if(i.current){var n=og(i.current),o=e.target;if(n&&o&&void 0!==t.current&&void 0!==r.current){var s=o.scrollTop-t.current;n.y=r.current-s}}},[]),s=(0,j.useCallback)(function(e,t){var r,i=n.current;if(i){var o=i.getBoundingClientRect(),s=t.point.y,a=null===(r=e.target)||void 0===r?void 0:r.closest("[draggable]"),c=null==a?void 0:a.parentElement;c&&(s<o.top+25&&(a!==c.firstElementChild||i.scrollTop>0)?i.scrollTop-=5:s>o.bottom-25&&(a!==c.lastElementChild||i.scrollTop<i.scrollHeight)&&(i.scrollTop+=5))}},[]),a=(0,j.useCallback)(function(){var o=n.current,s=om(e);if(o&&s){i.current=s,t.current=o.scrollTop;var a=og(s);a&&(r.current=a.y)}},[e]);return{scrollerRef:n,onScroll:o,dragControls:e,onDrag:s,onDragStart:a,onDragEnd:(0,j.useCallback)(function(){t.current=void 0,r.current=void 0,i.current=void 0},[])}},om=function(e){try{return Array.from(e.componentControls).find(function(e){return e.isDragging})}catch(e){console.error("[caught] findDraggingElementControls",e);return}},og=function(e){try{return e.panSession.history[0]}catch(e){console.error("[caught] getDraggingElementStartPoint",e);return}};function ov(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function oj(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ov(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ov(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ob=(0,eK.E)(u.k),oy=(0,eK.E)(p.xu),oC="data-".concat(ik.dh),oO=function(e){var n=e.handleClose,t=e.editor,r=e.readOnly,i=(0,j.useState)(!1),o=i[0],s=i[1],c=(0,j.useRef)(null),d=iN(t),f=d.cards,h=d.isDragging,g=d.selection,v=d.isLoaded,b=(0,j.useMemo)(function(){return oa(g,t)},[t,g]).id,y=(0,q.TL)(),C=(0,q.CG)(iR.wg),O=(0,q.CG)(iM.pe),w=(0,q.CG)(iM.u9),k=(0,q.CG)(iM.K3),S=(0,j.useRef)(h),E=ol(),I=E.menuRef,P=E.isFilmstripCardMenuOpen,D=E.onFilmstripCardMenuClose,A=E.clearPositioning,T=E.handleContextMenu,R=E.menuRootStyles,_=(0,j.useCallback)(function(){if(D(),o){var e;null===(e=c.current)||void 0===e||e.focus()}},[o,D]),M=ox(),L=M.scrollerRef,z=M.onScroll,N=M.dragControls,Z=M.onDrag,G=M.onDragStart,F=M.onDragEnd,U=(0,j.useCallback)(function(e){return function(){if(S.current=!0,G(),c.current){var n=c.current.getBoundingClientRect().height;c.current.style.height="".concat(n,"px")}var t=C.includes(e)?C:[e];y((0,iR.WF)({selectedCardIdsToDrag:t})),y((0,iM.CA)({cardIds:f.map(function(e){return e.cardId}),leaderCardId:e,selectedCardIds:t}))}},[f,y,C,G]),W=(0,j.useCallback)(function(){t&&(y((0,iM.vL)()),t.commands.rearrangeCardsById(f.map(function(e){return e.cardId}),w),F())},[f,y,t,w,F]),H=(0,j.useCallback)(function(){c.current&&(c.current.style.height="auto"),S.current=!1},[]);op(t),od({isFocused:o,readOnly:r,firstFocusedCardId:b,editor:t,isDragging:h}),(0,ek.O)({ref:c,handler:function(e){I.current&&I.current.contains(e.target)||(P&&D(),y((0,iR.Mt)()))}});var V=(0,ir.ye)("filmstripWithScreenshots"),B=(0,ir.ye)("screenshotsEnabled"),Y=(0,q.CG)(K.Pu),J=(0,eF.ff)("whiteAlpha.600","whiteAlpha.100"),Q=(0,eF.ff)("#F9FAFBDD","gray.900"),X=(0,eF.ff)("gray.800","gray.200"),$=(0,eF.ff)("blackAlpha.400","whiteAlpha.500"),ee=(0,eF.ff)("trueblue.500","trueblue.200"),en=(0,eF.If)().colorMode,et=(0,j.useMemo)(function(){var e;return{"--fs-item-border-color":(e="dark"===en)?"var(--chakra-colors-whiteAlpha-300)":"var(--chakra-colors-gray-200)","--fs-item-focused-box-shadow":"0 0 0 2px var(--chakra-ring-color)","--fs-item-selected-box-shadow":"0 0 0 2px var(--chakra-colors-trueblue-300)","--fs-item-selected-text-color":e?"var(--chakra-colors-trueblue-200)":"var(--chakra-colors-trueblue-500)"}},[en]),er=(0,j.useMemo)(function(){return f.length>=100},[f.length]),ei=(0,j.useMemo)(function(){var e=w.length;return h&&e>1?e:null},[h,w.length]);return(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(u.k,{position:"absolute",direction:"column",left:2,top:12,bottom:2,justifyContent:"center",color:X,children:(0,j.createElement)(ob,oj(oj(oj({},(0,a.Z)({},oC,!0)),{},{className:iP,key:iP},iI),{},{zIndex:11,tabIndex:0,_focus:{outline:"none"},onFocus:function(){s(!0),null==t||t.commands.blur()},onBlur:function(e){var n,t;c.current&&null!==(n=c.current)&&void 0!==n&&n.contains(e.relatedTarget)||null!==(t=I.current)&&void 0!==t&&t.contains(e.relatedTarget)||s(!1)},borderRadius:"md",bg:Q,borderWidth:"1px",borderColor:J,shadow:"lg",backdropFilter:"blur(20px)",maxHeight:"100%",alignSelf:"flex-start",ref:c,_hover:{".filmstrip-nubbin":{opacity:1}}}),(0,ed.jsx)(oy,{layoutScroll:!0,scrollbarGutter:"stable",overflowY:"auto",position:"relative",sx:oj({"&::-webkit-scrollbar":{opacity:1,width:"5px"},"&::-webkit-scrollbar-track":{opacity:0,width:"5px"},"&::-webkit-scrollbar-thumb":{background:$,borderRadius:"full"}},et),ref:L,onScroll:z,py:2,pl:1,pr:2,children:(0,ed.jsx)(iT.t.Group,{onReorder:function(e){var n=e.map(function(e){return e.cardId});y((0,iM.k)({reorderedCardIds:n}))},values:f,axis:"y",children:t&&v&&f.map(function(e,n){var i=e.cardId,o=e.displayBehavior,s=C.includes(i),a=k===i;return(0,ed.jsx)(iT.t.Item,{drag:!r&&"y",value:e,onDragStart:U(i),onDragEnd:W,onDragTransitionEnd:H,className:"reorder-item",dragControls:N,onDrag:Z,style:{position:"relative",listStyle:"none"},children:(0,ed.jsx)(os,{readOnly:r,card:e,index:h&&void 0!==O[i]?O[i]:n+1,isFirst:0===n,useXsFontSize:er,shouldHide:"hidden"===o,theme:Y,isDragInProgress:S.current,isEditorFocused:b===i&&t.isFocused,isFilmstripSelected:!!s,currentFocusedCard:b,showScreenshots:V,screenshotsEnabled:B,numberOfCardsDragging:a?ei:null,onContextClick:T(i)})},i)})})}),(0,ed.jsx)(iO.TX,{children:(0,ed.jsx)(l.cC,{id:"C8DFL7"})}),(0,ed.jsx)(m.kH,{placement:"top",label:(0,ed.jsx)(l.cC,{id:"C8DFL7"}),shortcut:"Mod+\\",children:(0,ed.jsx)(p.xu,{as:el.z,variant:"unstyled",position:"absolute",right:0,top:"50%",transform:"translate(calc(100%), -50%)",onClick:n,h:10,fontSize:"sm",borderWidth:"1px",borderColor:J,borderLeft:"none",shadow:"lg",bg:Q,borderRightRadius:"md",borderLeftRadius:"none",opacity:0,minW:0,p:2,transitionProperty:"common",transitionDuration:"normal",transitionTimingFunction:"ease",_hover:{color:ee},className:"filmstrip-nubbin",children:(0,ed.jsx)(x.G,{icon:iA.A3})})}))}),t&&(0,ed.jsx)(i9,{ref:I,editor:t,readOnly:r,isOpen:P,onClose:_,clearPositioning:A,rootStyles:R,isDark:"dark"===en})]})},ow=t(13720),ok=function(){var e=(0,q.TL)(),n=(0,q.CG)(K.GX),t=(0,ow.i)({base:!1,lg:!0})||!1,r=(0,j.useState)(!1),i=r[0],o=r[1],s=(0,j.useState)(!1),a=s[0],c=s[1],l=(0,j.useCallback)(function(){e((0,K.dQ)({isOpen:!1})),c(!0)},[e]),d=(0,j.useCallback)(function(){t||o(!0),e((0,K.dQ)({isOpen:!0}))},[t,e]),u=!t&&i;return(0,j.useEffect)(function(){var n=!t&&!i,r=t&&!a;n?e((0,K.dQ)({isOpen:!1})):r&&e((0,K.dQ)({isOpen:!0}))},[e,t,i,a]),{onClose:l,onOpen:d,isOpen:n&&(t||!t&&u)}},oS=(0,eK.E)(el.z),oE=(0,j.memo)(function(){var e=(0,nV._i)().editor,n=ok(),t=n.isOpen,r=n.onClose,i=n.onOpen,o=(0,ik.Br)("edit"),s=(0,eO.Yy)(),a=(0,j.useState)(!1),c=a[0],d=a[1],f=(0,j.useCallback)(function(){d(!0),setTimeout(function(){i()}),setTimeout(function(){d(!1)},750)},[i]);return(0,j.useEffect)(function(){return iw.F7.on("keydown","FILMSTRIP",function(e){return!!(0,rP.ZP)("Mod+\\")(e)&&(t?r():f(),!0)})},[t,r,f]),(0,ed.jsx)(m.Wk,{isDark:s,children:(0,ed.jsx)(eY.M,{children:t?(0,ed.jsx)(oO,{handleClose:r,editor:e,readOnly:!o},"filmstrip"):(0,ed.jsx)(m.kH,{placement:"top-end",label:(0,ed.jsx)(l.cC,{id:"7ShgZt"}),isDisabled:c,shortcut:"Mod+\\",children:(0,ed.jsxs)(oS,{initial:{opacity:0},animate:{opacity:1,transition:iE},exit:{opacity:0,transition:iS},zIndex:11,css:{"--trigger-height":"var(--chakra-sizes-14)"},tabIndex:-1,position:"fixed",left:2,top:"calc(50% - (var(--trigger-height) / 2) + var(--chakra-sizes-5))",borderRadius:"xl","data-guider-highlight":"filmstrip-opener",h:"var(--trigger-height)",w:8,onClick:f,children:[(0,ed.jsx)(iO.TX,{children:(0,ed.jsx)(l.cC,{id:"7ShgZt"})}),c?(0,ed.jsx)(u.k,{children:(0,ed.jsx)(tp.$,{size:"sm"})}):(0,ed.jsx)(x.G,{icon:iC.Cj})]},"filmstrip-opener")})})})});oE.displayName="Filmstrip";var oI=t(3974),oP=t(1472),oD=t(93319),oA=t(91128),oT=t(97873),oR=t(42879),o_=function(e){var n,t=e.doc,r=(0,j.useState)(!1),i=r[0],o=r[1],s=null==t?void 0:t.id,a=null==t?void 0:null===(n=t.organization)||void 0===n?void 0:n.id,c=(0,nU.py)("manage",t),d=(0,y.bBo)({variables:{workspaceId:a},skip:!a||!c}).data,u=(0,oR.uK)({doc:t,sites:null==d?void 0:d.sites}),f=(0,oR.D5)({site:u,docId:s}),p=(0,oT.q)({doc:t,site:u,path:f}).publishAndDeploy,h=(0,j.useCallback)((0,nq.Z)(nY().mark(function e(){return nY().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,p();case 3:o(!1);case 4:case"end":return e.stop()}},e)})),[p]);return u?(0,ed.jsx)(el.z,{size:"sm",variant:"solid",fontWeight:"400",leftIcon:(0,ed.jsx)(x.G,{icon:oA.A$}),onClick:h,isLoading:i,children:(0,ed.jsx)(l.cC,{id:"EEYbdt"})}):null},oM=t(92743),oL=t(56317),oz=t(6985),oN=t(25298),oZ=t(20010),oG=t(48273),oF=t(92619),oU=t(27777),oW=t(67453),oH=function(e){var n=e.isOpen,t=e.onClose,r=e.onSaveSuccess,i=e.docId,o=(0,eN.p)(),s=(0,j.useRef)(null),a=(0,j.useState)(""),c=a[0],d=a[1],u=(0,y.D1_)(),f=(0,S.Z)(u,2),p=f[0],h=f[1].loading,x=function(){p({variables:{id:i,title:c}}).then(function(){d(function(){return""}),r()}).catch(function(e){console.error(e),o({title:(0,ed.jsx)(ed.Fragment,{children:(0,ed.jsx)(l.cC,{id:"AToAqe",values:{0:e.message}})}),position:"top",status:"error"})})};return(0,ed.jsxs)(oZ.u_,{returnFocusOnClose:!1,onClose:t,closeOnOverlayClick:!0,isOpen:n,initialFocusRef:s,children:[(0,ed.jsx)(nQ.Z,{}),(0,ed.jsxs)(oG.h,{children:[(0,ed.jsx)(oF.x,{children:(0,ed.jsx)(l.cC,{id:"kq/0Sg",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc}})}),(0,ed.jsx)(n$.o,{}),(0,ed.jsx)(n0.f,{children:(0,ed.jsx)(oU.I,{ref:s,value:c,required:!0,placeholder:(0,oW.$)(),onChange:function(e){return d(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&x()}})}),(0,ed.jsx)(n1.m,{children:(0,ed.jsx)(eo.K,{spacing:2,direction:"row",align:"center",children:(0,ed.jsx)(el.z,{isLoading:h,isDisabled:h||!c||!c.length,onClick:function(){x()},children:(0,ed.jsx)(l.cC,{id:"tfDRzk"})})})})]})]})},oV=(0,j.memo)(function(e){var n=e.doc,t=(0,j.useCallback)(function(){return oz.T.emit("openSharePanel",{view:"invite"})},[]),r=(0,tC.M)({id:"analyticsModalDisclosure"}),i=r.isOpen,o=r.onClose,s=r.onOpen,a=(0,tC.M)({id:"titleModalDisclosure"}),c=a.isOpen,f=a.onOpen,p=a.onClose,h=(0,nE.z$)(),g=(0,nU.SE)().user,v=(0,nU.py)("manage",n)&&!!g,b=(0,j.useCallback)(function(){n&&(n.title&&""!==n.title?t():f())},[n,t,f]),y=(0,j.useCallback)(function(e){return function(){null==h||h.track(nE.AA.DOC_ANALYTICS_VIEWED,{docId:null==n?void 0:n.id,source:e,type:"full"}),s()}},[h,null==n?void 0:n.id,s]);return v&&n?(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(u.k,{children:(0,ed.jsx)(m.kH,{closeOnMouseDown:!1,closeOnClick:!1,label:(0,ed.jsx)(l.cC,{id:"YaUqUV"}),children:(0,ed.jsx)(oN.r,{"data-guider-highlight":"view-analytics-button","aria-label":d.ag._({id:"YaUqUV"}),onMouseDown:ni.br,onClick:y("toolbar_analytics_block"),icon:(0,ed.jsx)(x.G,{icon:oM.M})})})}),c&&(0,ed.jsx)(oH,{onClose:p,isOpen:c,onSaveSuccess:function(){p(),t()},docId:null==n?void 0:n.id}),i&&(0,ed.jsx)(oL.r,{doc:n,onSharePanelOpen:b,onAnalyticsPanelClose:o,isAnalyticsPanelOpen:i,mode:"full"})]}):null}),oB=t(24657),oq=t(67784),oK=t(94370),oY=t(38843),oJ=t(67925),oQ=t(73716),oX=t(10920),o$=t(15756),o0=t(81410),o1=t(5632),o2=t(57973);function o5(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function o3(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o5(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o5(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var o4=(0,eK.E)(u.k),o6=function(e){var n=e.doc;return(0,ed.jsx)(o4,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},children:(0,ed.jsx)(eY.M,{initial:!1,children:(0,ed.jsx)(sn,{doc:n})})})},o8=(0,j.memo)(function(e){var n=e.doc,t=(0,nV._i)().editor,r=(0,y.$gs)().isConnected,i=(0,eN.p)(),o=(0,j.useRef)(null),s=(0,j.useRef)(null),a=(0,y.D1_)(),c=(0,S.Z)(a,2),u=c[0],f=c[1].loading,h=(0,j.useState)(null),x=h[0],g=h[1],v=(0,j.useState)(!1),b=v[0],C=v[1],O=(0,j.useState)(!1),w=O[0],k=O[1],E=(0,nU.py)("edit",n),I=(0,j.useCallback)(function(){if(!t)return"";var e=(0,nR.N2)(t.state.doc,nM.KH),n=(0,S.Z)(e,1)[0];return n&&(0,eW.getCardTitle)(n.node.toJSON())||""},[t]);(0,j.useEffect)(function(){!n||b||f||(g(n.title||""),k(!!n.titleEdited))},[n,b,f]);var P=function(){o.current.style.width=s.current.offsetWidth+0+"px"},D=(0,eF.ff)("gray.800","gray.200");return(0,ed.jsx)(m.kH,{label:E?r?(0,ed.jsx)(l.cC,{id:"2wxgft"}):(0,ed.jsx)(l.cC,{id:"Cb+Bgk"}):null,"aria-label":d.ag._({id:"2wxgft"}),children:(0,ed.jsxs)(oY.C,{value:x||"",placeholder:x||I(),isDisabled:f||!E||!r,isPreviewFocusable:E,maxW:300,width:"100%",fontWeight:"normal",onCancel:function(){P(),C(!1)},onFocus:function(){P(),n&&!f&&C(!0)},onChange:function(e){P(),b&&(g(e),k(!!e))},onSubmit:function(){if(n&&!f){C(!1);var e=x||I();u({variables:{id:n.id,title:e,titleEdited:w}}).catch(function(e){console.error(e),i({title:(0,ed.jsx)(l.cC,{id:"AToAqe",values:{0:e.message}}),position:"top",status:"error"})})}},children:[(0,ed.jsx)(oJ.w,{px:1,py:.5,display:b?"inline":"block",overflowX:"hidden",textOverflow:"ellipsis",color:w?D:"inherit"}),(0,ed.jsx)(oQ.V,{ref:o,px:1,py:.5,color:w?D:"inherit",maxW:300,_focus:{outline:"none",shadow:"0 0 0 2px rgb(66 153 225 / 60%)"}}),(0,ed.jsx)(p.xu,{ref:s,as:"span",display:"inline-block",position:"absolute",left:"-9999px",opacity:0,zIndex:-1,minW:"180px",px:1,dangerouslySetInnerHTML:{__html:tJ().sanitize((x||"").replace(/\s/g,"&nbsp;"))}})]})})});o8.displayName="EditableDocTitle";var o9=function(e){var n=e.cardId,t=e.isEllipsis,r=e.value,i=e.onClick,o=(0,oe.c)(n);if(t)return(0,ed.jsx)(x.G,{icon:oK.cN});if(!n&&!r)return null;var s=r||(null==o?void 0:o.title)||"";return(0,ed.jsx)(f.x,{noOfLines:1,onClick:i,maxW:180,fontWeight:"normal",children:s})},o7=function(e){var n=e.isPresentModeFlat;return function(e){var t=(0,K.gh)(e),r=(0,K.i2)(e)||"",i=(0,K.X9)(e).parents[r]||[];if("DOC_VIEW"===t||n)return[{isHome:!0},{isDocTitle:!0}];var o=i[0],s=i[i.length-1];return[{isHome:!0},i.length>1?{cardId:o}:null,i.length>2?{isEllipsis:!0}:null,i.length>0?{cardId:s}:null,{cardId:r}]}},se=function(){var e=(0,ir.ye)("presentModeFlat");return(0,q.CG)(o7({isPresentModeFlat:e}),function(e,n){return JSON.stringify(e)===JSON.stringify(n)})},sn=(0,j.memo)(function(e){var n=e.doc,t=se(),r=(0,o2.X)(J.H.lastHomeUrl,"/"),i=(0,S.Z)(r,1)[0],o=(0,ir.ye)("offline"),s=(0,nU.SE)().user,a=(0,y.$gs)().isConnected,h=(0,nV._i)().confirmNavigation,g=(0,o1.useRouter)().push,v=(0,ow.i)({base:"xs",sm:"sm"}),j=(0,eF.ff)("gray.500","gray.400"),b=(0,eF.ff)("gray.800","gray.100");return(0,ed.jsxs)(er.U,{spacing:0,as:el.z,textAlign:"left",px:0,_hover:{color:b},h:8,children:[(0,ed.jsx)(oX.a,{display:"flex",alignItems:"center",whiteSpace:"nowrap",size:v,spacing:["4px","8px"],variant:"plainButton",separator:(0,ed.jsx)(p.xu,{color:"gray.300",mt:["0.2rem","0.125rem"],children:(0,ed.jsx)(x.G,{icon:oq._t})}),children:t.map(function(e,r){if(!e)return null;var o=r===t.length-1,a=e.cardId,c=e.isEllipsis,l=e.isDocTitle,d=e.isHome,u=e.value,f=d?"home":c?"ellipsis":a||u||r;if(d&&!s)return null;var p={as:tM(),href:i||"/",colorScheme:"gray",fontWeight:"normal","data-testid":"toolbar-home-link"};return(0,ed.jsx)(o$.g,{children:(0,ed.jsx)(o4,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},children:(0,ed.jsx)(o0.A,o3(o3({isCurrentPage:o,pointerEvents:o&&!l?"none":"inherit",color:o?j:"inherit"},d?o3({},p):{}),{},{children:l?(0,ed.jsx)(o8,{doc:n}):d?(0,ed.jsx)(eZ.r,{href:p.href,onClick:function(e){e.preventDefault(),h().then(function(){g(p.href)})},mr:1,children:(0,ed.jsx)(x.G,{size:"1x",icon:oB.J9})}):(0,ed.jsx)(o9,{cardId:a,value:u,isEllipsis:c,onClick:function(){a&&(0,on.D)({cardId:a,method:"push"})}})}))},f)},f)})}),!a&&(0,ed.jsx)(m.kH,{label:(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(f.x,{mr:2,children:(0,ed.jsx)(l.cC,{id:"ysdDIA"})}),o&&(0,ed.jsx)(f.x,{color:"gray.300",children:(0,ed.jsx)(l.cC,{id:"+QNhGE"})})]}),"aria-label":d.ag._({id:"IcHxhR"}),children:(0,ed.jsx)(u.k,{color:"gray.300",alignItems:"center",pr:3,children:(0,ed.jsx)(x.G,{icon:c.bK})})})]})});sn.displayName="BreadcrumbGroup";var st=t(33902),sr=t(74624),si=t(5735),so=t(45390),ss=t(57895),sa=t(68871),sc=t(90282),sl=t(24799),sd=t(1672),su=t(10649),sf=t(4036),sp=t(82282),sh=t(31807),sx=t(9846),sm=t(21010),sg=t(76360),sv=t(75342),sj=function(e){var n=e.onAddDomain,t=e.isAddingDomain,r=(0,j.useState)(""),i=r[0],o=r[1],s=(0,oR.m6)(i);return(0,ed.jsx)(sg.Z,{my:2,variant:"filled",children:(0,ed.jsx)(sv.e,{fontSize:"sm",children:(0,ed.jsxs)(eo.K,{spacing:5,children:[(0,ed.jsx)(f.x,{fontSize:"xl",fontWeight:"bold",children:(0,ed.jsx)(l.cC,{id:"MPZogu",values:{GAMMA_PROPER_NOUN:em.N6}})}),(0,ed.jsxs)(tB.NI,{children:[(0,ed.jsx)(tq.l,{children:(0,ed.jsx)(l.cC,{id:"49uOXe"})}),(0,ed.jsxs)(er.U,{children:[(0,ed.jsx)(oU.I,{bg:"white",placeholder:"www.yourdomain.com",value:i,onChange:function(e){return o(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&s&&(e.preventDefault(),n(i))}}),(0,ed.jsx)(eo.K,{children:(0,ed.jsx)(m.kH,{label:(0,ed.jsx)(l.cC,{id:"aUB5ST"}),placement:"top",shouldWrapChildren:!0,isDisabled:s,children:(0,ed.jsx)(el.z,{isDisabled:!s,variant:"solid",onClick:function(){return n(i)},isLoading:t,children:(0,ed.jsx)(l.cC,{id:"SbL5Je"})})})})]})]})]})})})},sb=t(89458),sy=t(74995),sC=t(21891),sO=t(92936),sw=t(60807),sk=t(72360),sS=t(48322),sE=t(35837),sI=t(2875),sP=function(e){var n=e.path,t=e.pathError,r=e.conflictingRoute,i=e.onPathUpdate,o=e.isPathInputDisabled,s=e.onClose;return(0,ed.jsxs)(eo.K,{pb:6,children:[(0,ed.jsx)(eo.K,{direction:"row",children:(0,ed.jsxs)(f.x,{children:[(0,ed.jsx)(l.cC,{id:"dq8+qI"}),":"," "]})}),(0,ed.jsx)(oD.L,{}),(0,ed.jsx)(eo.K,{spacing:2,children:(0,ed.jsx)(er.U,{spacing:1,children:(0,ed.jsxs)(tB.NI,{as:"fieldset",isInvalid:void 0!==t&&t,children:[(0,ed.jsx)(er.U,{children:(0,ed.jsxs)(sC.B,{children:[(0,ed.jsx)(sO.Ui,{children:"/"}),(0,ed.jsx)(oU.I,{isDisabled:o,bg:"white",flex:2,value:n,onChange:function(e){i((0,oR.pi)(e.currentTarget.value))}})]})}),(0,ed.jsxs)(eo.K,{spacing:4,children:[(0,ed.jsx)(tB.Q6,{fontSize:"sm",children:(0,ed.jsxs)(eo.K,{alignContent:"flex-start",justifyContent:"space-between",direction:"row",w:"100%",children:[(0,ed.jsx)(eo.K,{spacing:1,children:(0,ed.jsx)(f.x,{color:"gray.500",children:(0,ed.jsx)(l.cC,{id:"ZMlbHK"})})}),r&&(0,ed.jsx)(sw.J1,{justifyContent:"flex-end",alignItems:"flex-start",children:(0,ed.jsx)(f.x,{fontSize:"xs",children:(0,ed.jsx)(l.cC,{id:"DQaTdC",components:{0:(0,ed.jsx)(eZ.r,{textDecoration:"underline",href:(0,tF.Gn)({docId:r.docId}),target:"_blank"})}})})})]})}),(0,ed.jsx)(f.x,{fontSize:"sm",color:"gray.500",mt:4,children:(0,ed.jsx)(l.cC,{id:"g4cZni",components:{0:(0,ed.jsx)(el.z,{variant:"link",as:"span",size:"sm",cursor:"pointer",onClick:function(){s(),sI.pw.emit(sI.TI.OPEN_PAGE_SETUP,"preview")}})}})}),(0,ed.jsxs)(sk.b,{colorScheme:"gray",bg:"blackAlpha.100",children:[(0,ed.jsx)(sS.z,{}),(0,ed.jsxs)(eo.K,{children:[(0,ed.jsx)(f.x,{fontWeight:"bold",fontSize:"sm",children:(0,ed.jsx)(l.cC,{id:"E29kJ/"})}),(0,ed.jsxs)(sE.QI,{pl:"4",spacing:"1",fontSize:"xs",children:[(0,ed.jsxs)(sE.HC,{children:[(0,ed.jsx)(l.cC,{id:"tB9qsK",values:{GAMMA_PROPER_NOUN:em.N6}})," ",(0,ed.jsx)(m.Yq,{label:d.ag._({id:"9sEGjz"})})]}),(0,ed.jsx)(sE.HC,{children:(0,ed.jsx)(l.cC,{id:"8Ijq31"})}),(0,ed.jsx)(sE.HC,{children:(0,ed.jsx)(l.cC,{id:"0rExAx"})})]})]})]})]})]})})})]})},sD=function(e){var n=e.onClose,t=e.onConfirm,r=(0,j.useCallback)(function(){n(),t()},[n,t]);return(0,ed.jsxs)(oZ.u_,{onClose:n,isOpen:!0,children:[(0,ed.jsx)(nQ.Z,{}),(0,ed.jsxs)(oG.h,{children:[(0,ed.jsx)(oF.x,{children:(0,ed.jsx)(l.cC,{id:"dqU8B8"})}),(0,ed.jsx)(n$.o,{}),(0,ed.jsx)(n0.f,{children:(0,ed.jsxs)(eo.K,{spacing:4,children:[(0,ed.jsx)(f.x,{fontWeight:"bold",children:(0,ed.jsx)(l.cC,{id:"TKppIR"})}),(0,ed.jsx)(f.x,{children:(0,ed.jsx)(l.cC,{id:"jvL5br"})})]})}),(0,ed.jsx)(n1.m,{children:(0,ed.jsxs)(n2.h,{children:[(0,ed.jsx)(el.z,{variant:"ghost",onClick:n,children:(0,ed.jsx)(l.cC,{id:"dEgA5A"})}),(0,ed.jsx)(el.z,{variant:"ghost",colorScheme:"red",onClick:r,children:(0,ed.jsx)(l.cC,{id:"3EbjfR"})})]})})]})]})},sA=t(84558),sT=t(8388),sR=function(e){var n=e.heading,t=e.subheading,r=e.icon,i=e.children;return(0,ed.jsxs)(u.k,{gap:4,alignItems:"center",children:[(0,ed.jsx)(u.k,{h:"8",w:"8",bg:"gray.200",borderRadius:"full",justifyContent:"center",alignItems:"center",color:"gray.800",children:(0,ed.jsx)(x.G,{icon:r})}),(0,ed.jsxs)(eo.K,{spacing:0,children:[n,t]}),(0,ed.jsx)(oD.L,{}),i]})},s_=function(e){var n,t,r=e.doc,i=e.site,o=e.path,s=e.isPublishing,a=void 0!==s&&s,c=e.isUnpublishing,u=void 0!==c&&c,p=e.enabled,h=e.publishButtonTooltipLabel,g=e.onPublishClick,v=e.onUnpublishClick,b=null==r?void 0:r.title,y=!!(null==r?void 0:r.publishedSnapshotId),C=null==i?void 0:null===(n=i.currentDeployment)||void 0===n?void 0:n.deploymentTime,O=y&&!!C&&(null==i?void 0:i.currentDeployment)&&(null==r?void 0:r.publishedTime)&&new Date(null==i?void 0:i.currentDeployment.deploymentTime)>new Date(r.publishedTime),w=null==i?void 0:null===(t=i.domains)||void 0===t?void 0:t[0],k=(0,oR.mn)({domain:w,path:o}),S=(0,j.useMemo)(function(){return{fromNow:(0,sT.Km)(C),calendar:(0,sT.p6)(C,"PPpp")}},[C]);return(0,ed.jsx)(sR,{heading:(0,ed.jsxs)(er.U,{children:[(0,ed.jsx)(f.x,{noOfLines:1,children:b}),O&&(0,ed.jsx)(sf.C,{colorScheme:"green",children:"Live"})]}),subheading:O?(0,ed.jsxs)(er.U,{spacing:1.5,fontSize:"sm",children:[(0,ed.jsx)(f.x,{color:"gray.500",fontSize:"sm",children:(0,ed.jsx)(l.cC,{id:"ay/UB+",values:{0:S.fromNow},components:{0:(0,ed.jsx)(m.kH,{label:S.calendar,placement:"top",shouldWrapChildren:!0}),1:(0,ed.jsx)(f.x,{as:"span",cursor:"pointer",style:{textDecoration:"underline"}})}})}),(0,ed.jsx)(f.x,{fontSize:"sm",color:"gray.500",children:""}),(0,ed.jsx)(el.z,{variant:"link",size:"sm",onClick:v,isDisabled:a||u,isLoading:u,children:(0,ed.jsx)(l.cC,{id:"4DLZUa"})})]}):u||a?(0,ed.jsx)(f.x,{fontSize:"sm",color:"gray.500",children:(0,ed.jsx)(tp.$,{size:"xs"})}):(0,ed.jsx)(f.x,{fontSize:"sm",color:"gray.500",children:(0,ed.jsx)(l.cC,{id:"mY40hj"})}),icon:sA.Rk,children:(0,ed.jsxs)(n2.h,{children:[(0,ed.jsx)(m.kH,{label:h,shouldWrapChildren:!0,placement:"top",children:(0,ed.jsx)(el.z,{variant:"solid",isDisabled:!p,isLoading:a||u,loadingText:a?d.ag._({id:"Bdha5y"}):u?d.ag._({id:"JZOp0b"}):void 0,onClick:g,children:(0,ed.jsx)(l.cC,{id:"qcawwg"})})}),O&&(0,ed.jsx)(m.kH,{label:k,shouldWrapChildren:!0,placement:"top",children:(0,ed.jsx)(el.z,{variant:"plain",as:"a",target:"_blank",_hover:{textDecoration:"none",color:"trueblue.500"},href:k,isDisabled:!p,rightIcon:(0,ed.jsx)(x.G,{icon:tP.faArrowUpRightFromSquare}),children:(0,ed.jsx)(l.cC,{id:"Zel0o2"})})})]})})};function sM(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function sL(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?sM(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sM(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var sz={path:""},sN=function(e){var n,t=e.isOpen,r=e.onClose,i=e.doc,o=(0,eN.p)(),s=(0,j.useState)(sz),a=s[0],c=s[1],d=(0,j.useState)(sz),u=d[0],f=d[1],p=(0,j.useState)(!1),h=p[0],x=p[1],g=i.id,v=null===(n=i.organization)||void 0===n?void 0:n.id,b=(0,sm.bBo)({variables:{workspaceId:v},skip:!v}),y=b.data,C=b.refetch,O=(0,tC.M)({id:"domainSetupModal"}),w=O.isOpen,k=O.onOpen,S=O.onClose,E=(0,tC.M)({id:"publishModalWarning"}),I=E.isOpen,P=E.onOpen,D=E.onClose,A=null==y?void 0:y.sites,T=(0,oR.uK)({doc:i,sites:A}),R=(0,oR.D5)({site:T,docId:g}),_=(0,oR.Rh)({site:T,docId:g}),M=(0,oR.gT)({routes:(null==T?void 0:T.routes)||[],path:a.path,docId:g}),L=null==T?void 0:T.domains.find(function(e){return"pending"===e.status}),z=a.path!==u.path||void 0===R,N=!!i&&!!y,Z=!it()(a,u),G=(0,j.useState)("coldStart"),F=G[0],U=G[1],W=(0,j.useState)(null),H=W[0],V=W[1],B=(0,j.useState)(!1),q=B[0],K=B[1],Y=!!q&&!M&&!1===h,J=(0,j.useState)(),Q=J[0],X=J[1],$=(0,oT.q)({doc:i,site:T,path:a.path}),ee=$.publishAndDeploy,en=$.addDomain,et=$.isAddingDomain,er=$.createSite,ei=$.isCreatingSite,ea=$.unpublishAndDeploy,ec=$.updateRoutes;(0,j.useEffect)(function(){if(L){var e=setInterval(function(){C()},1e4);return function(){clearInterval(e)}}},[L,C,T]),(0,j.useEffect)(function(){N&&T&&K(!0)},[N,T,R]),(0,j.useEffect)(function(){N&&T&&U("hasDomains")},[N,T]),(0,j.useEffect)(function(){c({path:R||""}),f({path:R||""})},[R]);var el=(0,j.useCallback)(function(e){X(e),k()},[k]),eu=(0,j.useCallback)((0,nq.Z)(nY().mark(function e(){return nY().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g){e.next=2;break}return e.abrupt("return");case 2:if(!M){e.next=5;break}return o({description:(0,ed.jsx)(l.cC,{id:"ldkJkh",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc}}),status:"error",position:"top",duration:5e3,isClosable:!0}),e.abrupt("return");case 5:if(x("publish"),!z){e.next=9;break}return e.next=9,ec();case 9:return e.next=11,ee();case 11:x(!1);case 12:case"end":return e.stop()}},e)})),[M,g,z,ee,o,ec]),ef=(0,j.useCallback)((0,nq.Z)(nY().mark(function e(){return nY().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return x("unpublish"),e.next=3,ea();case 3:x(!1);case 4:case"end":return e.stop()}},e)})),[ea]),ep=(0,j.useCallback)(function(){Z?P():r()},[Z,r,P]),eh=(0,j.useCallback)(function(e){"addDomain"===H?(en(e),S()):"createSite"===H&&(er(e),S())},[en,H,er,S]);return console.log("%cPublishWebsite debug","background-color: #cc00ff",{doc:i,sites:A,siteToUse:T,pathForPathEditor:R}),(0,ed.jsx)(m.Wk,{isDark:!1,children:(0,ed.jsxs)(oZ.u_,{isOpen:t,onClose:ep,size:"4xl",closeOnOverlayClick:!1,children:[(0,ed.jsx)(nQ.Z,{}),(0,ed.jsx)(oG.h,{children:N?(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsxs)(eo.K,{px:6,py:4,borderBottomWidth:"1px",children:[(0,ed.jsx)(es.X,{mb:2,children:(0,ed.jsx)(l.cC,{id:"Khu3PV"})}),"hasDomains"===F&&(0,ed.jsx)(s_,{doc:i,path:_,site:T,enabled:Y,publishButtonTooltipLabel:q?void 0===R?(0,ed.jsx)(l.cC,{id:"O7BXvp"}):void 0:(0,ed.jsx)(l.cC,{id:"XDmUdC"}),onPublishClick:eu,onUnpublishClick:ef,isPublishing:"publish"===h,isUnpublishing:"unpublish"===h})]}),(0,ed.jsx)(n$.o,{}),(0,ed.jsx)(n0.f,{children:(0,ed.jsxs)(eo.K,{spacing:6,children:["coldStart"===F&&(0,ed.jsx)(sj,{onAddDomain:function(e){V("createSite"),X(e),k()},isAddingDomain:ei}),"hasDomains"===F&&T&&(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(sb.T,{path:_,site:T,onDomainSetupClick:el,onAddDomain:function(e){k(),X(e),V("addDomain")},isAddingDomain:et,refetchSites:C}),(0,ed.jsx)(sP,{path:a.path,pathError:!!M,conflictingRoute:M,isPathInputDisabled:!1!==h,onPathUpdate:function(e){c(function(n){return sL(sL({},n),{},{path:e})})},onClose:r})]})]})})]}):(0,ed.jsx)(tp.$,{})}),w&&Q&&(0,ed.jsx)(sy.w,{domainName:Q,isOpen:w,onClose:function(){S(),V(null)},onDomainConfirmed:H?eh:null}),I&&(0,ed.jsx)(sD,{onClose:D,onConfirm:r})]})})},sZ=function(e){var n,t=e.doc,r=(0,tC.M)({id:"publishModal"}),i=r.isOpen,o=r.onClose,s=r.onOpen,a=null===(n=t.organization)||void 0===n?void 0:n.id,c=(0,sm.bBo)({variables:{workspaceId:a},skip:!a}).data,d=(null==c?void 0:c.sites)||[];return(0,ed.jsxs)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:oA.A$,fixedWidth:!0}),onClick:function(){s()},children:[(0,ed.jsxs)(er.U,{children:[d.length>0?(0,ed.jsx)(l.cC,{id:"BCIqs5"}):(0,ed.jsx)(l.cC,{id:"TMYPtj"}),(0,ed.jsx)(oD.L,{}),(0,ed.jsx)(sf.C,{colorScheme:"green",ml:2,children:(0,ed.jsx)(l.cC,{id:"YBt9YP"})})]}),t&&i&&(0,ed.jsx)(sN,{doc:t,isOpen:i,onClose:o})]})},sG=t(42048),sF=t(65903),sU=t.n(sF),sW=t(98649),sH=function(e){var n=(0,q.CG)(K.e_),t=(0,q.TL)(),r=(0,j.useCallback)(function(e){t((0,K.Qt)({docAttrs:{format:e}}))},[t]);return(0,ed.jsx)(n2.h,{size:"sm",isAttached:!0,my:2,children:sW.n.map(function(e){return(0,ed.jsx)(el.z,{isActive:e.key===n.key,onClick:function(){return r(e.key)},children:sU()(e.label)},e.key)})})},sV=t(85147),sB=t(20387),sq=function(){var e;return e={},(0,a.Z)(e,nz.q.DOC_VIEW,{buttonLabel:(0,ed.jsx)(l.cC,{id:"eZb+lw"}),shortcutIcon:sB.zc,shortcutKeys:(0,m.cE)("Mod+Enter"),shortcutLabel:(0,ed.jsx)(l.cC,{id:"9vUn+H"})}),(0,a.Z)(e,nz.q.SLIDE_VIEW,{buttonLabel:(0,ed.jsx)(l.cC,{id:"ydzS9x"}),shortcutIcon:sV.Bg,shortcutKeys:"Esc",shortcutLabel:(0,ed.jsx)(l.cC,{id:"5Rfo7J"})}),e},sK=t(8699),sY=t(47592),sJ=t(59131),sQ=(0,rP.ZP)("mod+Enter"),sX=(0,rP.ZP)("Esc"),s$=(0,rP.ZP)("mod+Esc"),s0=(0,rP.ZP)("shift+mod+Enter"),s1=function(e,n){var t=document.querySelector(n);if(t){var r=t.getBoundingClientRect();e.commands.scrollToNodeWithPin(document.elementFromPoint(r.width/2,100),100)}},s2=function(e){var n=e.editorWrapperEl,t=e.scrollingParentSelector,r=(0,q.TL)(),i=(0,j.useState)(!1),o=i[0],s=i[1],a=(0,j.useState)(!1),c=a[0],l=a[1],d=(0,nV._i)().editor,u=(0,q.CG)(K.gh),f=(0,j.useRef)(u);(0,j.useEffect)(function(){f.current=u},[u]);var p=(0,q.CG)(K.yq),h=(0,q.CG)(K.JA),x=(0,q.CG)(rL.C),m=(0,nE.z$)(),g=(0,j.useCallback)(function(e){d&&!d.isDestroyed&&(e===nz.q.SLIDE_VIEW?((0,sY.E0)(d.state.doc,r),(0,rZ.U6)(d,!1),d.commands.spotlightCurrentCard()):(d.commands.turnOffSpotlight(!0),s1(d,t)),r(function(n){n((0,K.Qx)({attached:!1})),n((0,K.PM)({mode:e}))}))},[r,d,t]),v=(0,j.useCallback)(function(){try{var e,n,t,r;if(null!==(e=document.body)&&void 0!==e&&e.requestFullscreen){null===(t=document.body)||void 0===t||t.requestFullscreen();return}null!==(n=document.body)&&void 0!==n&&n.webkitRequestFullscreen&&(null===(r=document.body)||void 0===r||r.webkitRequestFullscreen())}catch(e){console.debug("[PresentBlock] Error entering fullscreen:",e)}},[]),b=(0,j.useCallback)(function(){try{if(document.fullscreenElement){document.exitFullscreen();return}document.webkitCurrentFullScreenElement&&document.webkitExitFullscreen&&document.webkitExitFullscreen()}catch(e){console.debug("[PresentBlock] Error exiting fullscreen:",e)}},[]),y=(0,ir.ye)("realUserMetrics"),C=(0,sK.wK)(y),O=C.recordExitSlideModePerformance,w=C.recordEnterSlideModePerformance,k=(0,j.useCallback)(function(e){var n=e.fullscreen,t=void 0!==n&&n;f.current!==nz.q.SLIDE_VIEW&&(g(nz.q.SLIDE_VIEW),t&&v(),null==m||m.trackDocEvent(nE.AA.PRESENT_MODE_ENTERED),w({isFullscreen:t}),setTimeout(function(){document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()}))},[g,w,v,f,m]),S=(0,j.useCallback)(function(){f.current!==nz.q.DOC_VIEW&&(g(nz.q.DOC_VIEW),o&&b(),null==m||m.trackDocEvent(nE.AA.PRESENT_MODE_EXITED),O({isFullscreen:o}))},[g,o,b,O,f,m]);return(0,j.useEffect)(function(){var e=function(){null!==document.fullscreenElement||c||S(),null!==document.webkitCurrentFullScreenElement||c||S(),s(function(e){return!e}),l(!1)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),function(){document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e)}},[c,S,b]),(0,rw.r)(function(){d&&!d.isDestroyed&&u===nz.q.DOC_VIEW&&requestAnimationFrame(function(){var e=d.state.selection;e instanceof sJ.c&&d.commands.command(function(n){return n.tr.setSelection(e.createSelectionNear()),!0})})},[d,u]),(0,j.useEffect)(function(){return rD.F7.on("keydown","PRESENT_BLOCK",function(e){var n,t,r,i=f.current===nz.q.SLIDE_VIEW;if(!x){if(sQ(e)){if(null!=e&&null!==(n=e.target)&&void 0!==n&&n.closest("[data-gamma-child-tiptap-editor]"))return;return e.preventDefault(),k({fullscreen:!1}),!0}if(s0(e)){if(null!=e&&null!==(t=e.target)&&void 0!==t&&t.closest("[data-gamma-child-tiptap-editor]"))return;return e.preventDefault(),k({fullscreen:!0}),!0}if(s$(e)&&i)return S(),!0;if(sX(e)&&i&&!p&&!h){if(null!=e&&null!==(r=e.target)&&void 0!==r&&r.closest("[data-gamma-child-tiptap-editor]"))return;return S(),!0}}})},[k,S,v,p,h,n,x]),{enterSlideView:k,exitSlideView:S,enterFullscreen:v,exitFullscreen:b,exitedFullscreenByClick:c,isFullscreen:o,setIsFullscreen:s,setExitedFullscreenByClick:l}},s5=function(e){var n=e.editorWrapperEl,t=e.scrollingParentSelector,r=(0,q.CG)(K.gh),i=(0,ir.ye)("presentFullScreen"),o=sq()[r],s=o.shortcutIcon,a=o.shortcutKeys,c=o.buttonLabel,l=s2({editorWrapperEl:n,scrollingParentSelector:t}),d=l.enterSlideView,u=l.exitSlideView;return(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:s,fixedWidth:!0}),command:a,onClick:function(){r===nz.q.SLIDE_VIEW?u():d({fullscreen:i})},children:c})},s3=t(50376),s4=t(47090);function s6(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function s8(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s6(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s6(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var s9=function(e){var n,t,r=e.doc,i=e.editorWrapperEl,o=e.scrollingParentSelector,s=(0,nU.SE)().user,a=(0,y.$gs)().isConnected,c=(0,ru.e)(),d=(0,nV._i)().editor,u=(0,oW.$)(null==r?void 0:r.title),h=(null==r?void 0:r.createdTime)&&(0,sp.Z)((0,sh.Z)(r.createdTime),"PPP"),g=null==r?void 0:r.id,v=(0,tC.M)({id:"snapshotsDrawer"}),b=v.isOpen,C=v.onClose,O=v.onOpen,w=(0,tC.M)({id:"analyticsPanelDisclosure"}),k=w.isOpen,E=w.onClose,I=w.onOpen,P=(0,y.LT4)(),D=(0,S.Z)(P,1)[0],A=(0,y.iX9)(),T=(0,S.Z)(A,1)[0],R=(0,nE.z$)(),_=(0,nU.py)("view",r)&&!!s,M=(0,nU.py)("edit",r),L=(0,nU.py)("manage",r)&&!!s,z=(0,ir.ye)("pageSetup")&&M,N=!!(s&&0!==s.workspaceMemberships.length),Z=(0,ir.ye)("publishing"),G=(0,ir.ye)("docFormats"),F=(0,q.CG)(K.hN),U=(0,j.useCallback)(function(){null==R||R.track(nE.AA.DOC_ANALYTICS_VIEWED,{docId:g,source:"toolbar_doc_menu",type:"personal"}),I()},[R,g,I]),W=(0,j.useCallback)(function(e){return function(){if(g){var n={id:g};e?D({variables:n,optimisticResponse:{archiveDoc:s8(s8({},n),{},{archived:e,__typename:"Doc"})}}):T({variables:n,optimisticResponse:{unarchiveDoc:s8(s8({},n),{},{archived:e,__typename:"Doc"})}})}}},[D,g,T]),H=(0,j.useCallback)(function(){d&&d.commands.undo()},[d]),V=(0,tC.M)({id:"codeEditor"}),B=V.isOpen,Y=V.onOpen,J=V.onClose,Q=(0,ir.ye)("docCustomCode")&&M;return(0,ed.jsxs)(rJ.v,{children:[(0,ed.jsx)(rQ.j,{as:oN.r,borderRadius:"md",isDisabled:b,icon:(0,ed.jsx)(x.G,{icon:oK.cN}),onMouseDown:ni.br,"data-testid":"doc-toolbar-menu-button"}),(0,ed.jsx)(eS.h,{children:r&&(0,ed.jsxs)(rX.q,{zIndex:"popover",maxH:"100vh",minW:"280px",overflow:"auto",children:[(0,ed.jsxs)(p.xu,{px:4,py:2,children:[(0,ed.jsx)(f.x,{noOfLines:6,children:u}),(0,ed.jsx)(f.x,{fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,ed.jsx)(l.cC,{id:"jlWdji",values:{createdTime:h}})}),(0,ed.jsx)(m.kH,{label:null==r?void 0:null===(n=r.createdBy)||void 0===n?void 0:n.email,children:(0,ed.jsx)(f.x,{display:"inline-block",fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,ed.jsx)(l.cC,{id:"t490IT",values:{0:null==r?void 0:null===(t=r.createdBy)||void 0===t?void 0:t.displayName}})})}),G&&(0,ed.jsx)(sH,{})]}),(0,ed.jsx)(r0.R,{}),(0,ed.jsx)(sx.V,{label:(0,ed.jsx)(l.cC,{id:"IdcoRx"}),isConnected:a,maxWidth:"300px"}),a&&(0,ed.jsxs)(ed.Fragment,{children:[!!s&&!L&&(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:oM.M,fixedWidth:!0}),onClick:U,children:(0,ed.jsx)(l.cC,{id:"ZlwDi6"})}),Z&&L&&(0,ed.jsx)(sZ,{doc:r}),(0,ed.jsx)(s5,{editorWrapperEl:i,scrollingParentSelector:o}),N&&(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:iF.kZ,fixedWidth:!0}),onClick:function(){d&&c({docId:g,initialContent:d.getJSON(),source:"editor_toolbar_doc_menu_duplicate",newWindow:!(0,tG.Q5)()})},children:(0,ed.jsx)(l.cC,{id:"euc6Ns"})}),_&&(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:su.kw,fixedWidth:!0}),onClick:function(){oz.T.emit("openSharePanel",{view:"export"})},children:(0,ed.jsx)(l.cC,{id:"U8WPSi"})}),z&&(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:sd.gr,fixedWidth:!0}),onClick:function(){oz.T.emit("openPageSetup","cards")},children:(0,ed.jsxs)(er.U,{children:[(0,ed.jsx)(l.cC,{id:"Kx2GmY"}),(0,ed.jsx)(oD.L,{}),(0,ed.jsx)(sf.C,{colorScheme:"green",ml:2,children:(0,ed.jsx)(l.cC,{id:"isRobC"})})]})}),Q&&(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:sl.dT,fixedWidth:!0}),onClick:Y,children:(0,ed.jsxs)(er.U,{children:[(0,ed.jsx)(l.cC,{id:"cnlGIm"}),(0,ed.jsx)(oD.L,{}),(0,ed.jsx)(sf.C,{colorScheme:"green",ml:2,children:(0,ed.jsx)(l.cC,{id:"YBt9YP"})})]})}),F&&(0,ed.jsx)(r0.R,{}),F&&(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:sc.faArrowRotateLeft,fixedWidth:!0}),onClick:H,command:(0,m.cE)("Mod+Z"),children:(0,ed.jsx)(l.cC,{id:"9uI/rE"})}),M&&(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:sa.SZ,fixedWidth:!0}),onClick:O,children:(0,ed.jsx)(l.cC,{id:"6Z5x06"})}),L&&(0,ed.jsx)(r0.R,{}),L?r.archived?(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:ss.Ze,fixedWidth:!0}),onClick:W(!1),children:(0,ed.jsx)(l.cC,{id:"yKu/3Y"})}):(0,ed.jsx)(iH.s,{"data-testid":"doc-menu-trash-button",color:"red.500",icon:(0,ed.jsx)(x.G,{icon:e_.$,fixedWidth:!0}),onClick:W(!0),children:(0,ed.jsx)(l.cC,{id:"1C/Yjq"})}):null]})]})}),r&&(0,ed.jsx)(s3.Z,{doc:r,isOpen:b,onClose:C}),r&&k&&(0,ed.jsx)(oL.r,{doc:r,isAnalyticsPanelOpen:k,onAnalyticsPanelClose:E,mode:"personal"}),Q&&(0,ed.jsx)(sG.B,{editor:d,isOpen:B,onClose:J}),z&&(0,ed.jsx)(s4.T,{editor:d})]})},s7=t(22595),ae=t(26886),an=t(71528),at=t(26384),ar=t(26673),ai=t(91930),ao=t(7328),as=t(84807),aa=t(28165),ac=t(12221),al=t(97442),ad={followOnStart:"follow_on_start",followingId:"following_id"},au=function(e,n){var t=n.followOnStart,r=n.followingId,i=new URL(e);return r&&i.searchParams.append(ad.followingId,r),t&&i.searchParams.append(ad.followOnStart,"true"),i.toString()},af=function(e){switch(e){case"edit":return d.ag._({id:"UZN1cZ"});case"comment":return d.ag._({id:"jFTs0A"});case"view":return d.ag._({id:"Ya6CJ0"});default:return d.ag._({id:"Txd1qM"})}},ap=function(e){var n,t,r=e.isOpen,i=e.onClose,o=e.accessLinkUrl,a=e.onPlayClick,c=(0,nU.SE)().user,u=(0,o1.useRouter)().replace,h={followOnStart:!0,followingId:null==c?void 0:c.id},g=(0,j.useState)(h),v=g[0];g[1];var b=au(o,v),y=(0,nU.SE)(),C=y.user,O=y.color,w=(0,q.CG)(nB.yx),k=null==w?void 0:null===(n=w.accessLinks)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.permission,S=(0,aa.keyframes)(s||(s=(0,ao.Z)(["\n    0% { transform: scale(1.0); filter: brightness(1.0);  }\n    3% { transform: scale(1.0); filter: brightness(1.0);  }\n    8% {  transform: scale(0.90); filter: brightness(1.30);  }\n    18% { transform: scale(1.05); filter: brightness(1.0); }\n    30% { transform: scale(1.0); filter: brightness(1.0); }\n  "])));return(0,ed.jsx)(m.Wk,{isDark:!1,children:(0,ed.jsxs)(oZ.u_,{isOpen:r,onClose:i,size:"lg",children:[(0,ed.jsx)(nQ.Z,{}),(0,ed.jsxs)(oG.h,{children:[(0,ed.jsx)(oF.x,{children:(0,ed.jsx)(l.cC,{id:"88XnIQ"})}),(0,ed.jsx)(n$.o,{}),(0,ed.jsx)(ec.i,{}),(0,ed.jsx)(n0.f,{pt:"6",children:(0,ed.jsxs)(eo.K,{spacing:"4",children:[(0,ed.jsx)(f.x,{children:(0,ed.jsx)(l.cC,{id:"oYTLJe",values:{0:af(k),GAMMA_ARTIFACT_PROPER_NOUN:em.Yc},components:{0:(0,ed.jsx)(f.x,{as:"span",fontWeight:"bold",borderBottom:"1px dashed",borderColor:"gray.400",display:"inline-block"}),1:(0,ed.jsx)(m.kH,{label:d.ag._({id:"8LnpqL"}),placement:"top"})}})}),(0,ed.jsx)(p.xu,{mb:"2",children:(0,ed.jsx)(al.I,{url:b,variant:"solid"})}),(0,ed.jsxs)(sk.b,{children:[(0,ed.jsx)(sS.z,{}),(0,ed.jsxs)(er.U,{flexBasis:"100%",alignItems:"top",children:[(0,ed.jsx)(f.x,{fontSize:"sm",width:"100%",children:(0,ed.jsx)(l.cC,{id:"EApNIe"})}),(0,ed.jsxs)(p.xu,{position:"relative",textShadow:"sm",children:[(0,ed.jsx)(ac.q,{animation:"".concat(S," 2s infinite ease-out"),name:null==C?void 0:C.displayName,src:null==C?void 0:C.profileImageUrl,size:"md",border:"solid 3px ".concat(O.value),shadow:"lg"}),(0,ed.jsx)(p.xu,{position:"absolute",top:"1.75rem",left:"1.75rem",outline:"0 0 2px rgba(255,255,255,1.0)",sx:{path:{stroke:"white",strokeWidth:48}},color:"black",children:(0,ed.jsx)(x.G,{icon:as.q,fixedWidth:!0})})]})]})]})]})}),(0,ed.jsx)(n1.m,{children:(0,ed.jsxs)(n2.h,{children:[(0,ed.jsx)(el.z,{variant:"ghost",colorScheme:"gray",onClick:function(){i()},children:(0,ed.jsx)(l.cC,{id:"DPfwMq"})}),(0,ed.jsx)(el.z,{variant:"solid",onClick:function(){i(),a(),u(b,b,{shallow:!0})},leftIcon:(0,ed.jsx)(x.G,{icon:sB.zc}),children:(0,ed.jsx)(l.cC,{id:"tbDuNX"})})]})})]})]})})},ah=function(e){var n,t,r,i,o=e.doc,s=e.isStaticEditor,a=e.editorWrapperEl,c=e.scrollingParentSelector,h=(0,tC.M)({id:"meetModal"}),g=h.onOpen,v=h.onClose,b=h.isOpen,y=s2({editorWrapperEl:a,scrollingParentSelector:c}),C=y.enterSlideView,O=y.exitSlideView,w=y.setExitedFullscreenByClick,k=y.isFullscreen,S=y.enterFullscreen,E=y.exitFullscreen,I=(0,nU.SE)().user,P=(0,q.CG)(K.gh),D=(0,j.useRef)(P);(0,j.useEffect)(function(){D.current=P},[P]);var A=sq()[P],T=A.shortcutLabel,R=A.shortcutIcon,_=A.shortcutKeys,M=A.buttonLabel,L=null==o?void 0:null===(n=o.accessLinks)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.url,z=!!(null==o?void 0:null===(r=o.accessLinks)||void 0===r?void 0:null===(i=r[0])||void 0===i?void 0:i.permission),N=(0,nU.py)("manage",o||void 0),Z=(0,ir.ye)("presentFullScreen"),G="present"===(0,q.CG)(K.e_).primaryAction?"solid":"plain";return(0,ed.jsxs)(u.k,{children:[(0,ed.jsxs)(n2.h,{isAttached:!0,size:"sm","data-guider-highlight":"present-button-group","data-editor-mode":P===nz.q.SLIDE_VIEW?"slide":"doc",children:[(0,ed.jsx)(m.kH,{closeOnMouseDown:!1,closeOnClick:!1,label:T,shortcut:_,children:(0,ed.jsx)(oN.h,{fontWeight:"normal",size:"sm",variant:G,onClick:function(){P===nz.q.SLIDE_VIEW?O():C({fullscreen:Z})},onMouseDown:ni.br,icon:(0,ed.jsx)(x.G,{icon:R}),"data-present-button":!0,children:M})}),(0,ed.jsxs)(rJ.v,{children:[(0,ed.jsx)(rQ.j,{variant:G,as:oN.r,icon:(0,ed.jsx)(x.G,{icon:ar.pt})}),(0,ed.jsx)(eS.h,{children:(0,ed.jsxs)(rX.q,{zIndex:"popover",children:[P===nz.q.DOC_VIEW&&(0,ed.jsxs)(ai.k,{title:d.ag._({id:"9vUn+H"}),children:[(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:sA.Rk,fixedWidth:!0}),command:(0,m.cE)("Mod+Enter"),onClick:function(){return C({fullscreen:!1})},children:(0,ed.jsx)(l.cC,{id:"LRFe2O"})}),(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:at.tc,fixedWidth:!0}),command:(0,m.cE)("Mod+Shift+Enter"),onClick:function(){return C({fullscreen:!0})},children:(0,ed.jsx)(l.cC,{id:"OwIqiD"})})]}),P===nz.q.SLIDE_VIEW&&(0,ed.jsx)(iH.s,{icon:(0,ed.jsx)(x.G,{icon:sV.Bg,fixedWidth:!0}),command:"ESC",onClick:O,children:(0,ed.jsx)(l.cC,{id:"5Rfo7J"})}),!s&&I&&N&&(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(r0.R,{}),(0,ed.jsx)(m.kH,{isDisabled:z,label:(0,ed.jsx)(l.cC,{id:"zk6wKo"}),children:(0,ed.jsx)(p.xu,{children:(0,ed.jsx)(iH.s,{onClick:function(){var e;null!=o&&null!==(e=o.accessLinks)&&void 0!==e&&e[0].permission&&g()},isDisabled:!z,icon:(0,ed.jsx)(x.G,{icon:an.AS,fixedWidth:!0}),children:(0,ed.jsx)(eo.K,{spacing:"0",children:(0,ed.jsx)(l.cC,{id:"z7gRub",components:{0:(0,ed.jsx)(f.x,{}),1:(0,ed.jsx)(f.x,{fontSize:"sm",color:"gray.600"})}})})})})})]}),!s&&I&&L&&(0,ed.jsx)(ap,{isOpen:b,onClose:v,accessLinkUrl:L,onPlayClick:function(){C({fullscreen:!1})}})]})})]})]}),P===nz.q.SLIDE_VIEW&&(0,ed.jsx)(u.k,{ml:P===nz.q.SLIDE_VIEW?2:0,children:(0,ed.jsx)(m.kH,{label:k?"Exit full screen":"Enter full screen",children:(0,ed.jsx)(oN.r,{"aria-label":k?"Exit full screen":"Enter full screen",borderRadius:"md",icon:(0,ed.jsx)(x.G,{icon:k?ae.Qj:s7.TL}),onClick:k?function(){w(!0),E()}:S})})})]})},ax=t(46231),am=t(38621),ag=function(e){var n=e.spotlightingByBlock,t=(0,nV._i)().editor,r=(0,j.useCallback)(function(){n?null==t||t.commands.turnOffSpotlight():null==t||t.commands.spotlightNextBlock()},[t,n]);return(0,ed.jsx)(u.k,{children:(0,ed.jsx)(m.kH,{closeOnMouseDown:!1,closeOnClick:!1,label:(0,ed.jsxs)(f.x,{whiteSpace:"nowrap",children:[n?"Turn off spotlight":"Turn on spotlight",(0,ed.jsx)(f.x,{as:"span",display:"inline",color:"gray.400",ml:2,children:"S"})]}),children:(0,ed.jsx)(oN.h,{colorScheme:"trueblue",variant:n?"solid":"plain",onClick:function(e){r(),e.target.blur()},icon:(0,ed.jsx)(x.G,{icon:am.QM}),children:"Spotlight"})})})},av=t(18504),aj=t(60271),ab=t(4685),ay=t(18066),aC=(0,j.memo)(function(e){var n=e.isOpen,t=e.onClose,r=e.openThemeEditor,i=e.setDocTheme,o=(0,q.CG)(K.Pu);return(0,ed.jsx)(m.Wk,{isDark:!1,children:(0,ed.jsxs)(nJ.d,{returnFocusOnClose:!1,isOpen:n,placement:"right",onClose:t,size:"sm",children:[(0,ed.jsx)(nQ.Z,{background:"none"}),(0,ed.jsxs)(nX.s,{"data-testid":"doc-theme-drawer","data-doc-theme-drawer":!0,motionProps:{variants:{enter:{x:"0%",transition:{duration:.2}},exit:{x:"100%",transition:{duration:.1}}}},children:[(0,ed.jsx)(n$.o,{}),(0,ed.jsx)(oF.x,{children:(0,ed.jsx)(l.cC,{id:"FEr96N"})}),(0,ed.jsx)(n0.f,{overflowX:"hidden",children:(0,ed.jsx)(ay.y,{currentTheme:o,setTheme:i,openThemeEditor:r,onClose:t})}),(0,ed.jsx)(n1.m,{children:(0,ed.jsx)(el.z,{w:"100%",variant:"solid",onClick:t,children:(0,ed.jsx)(l.cC,{id:"DPfwMq"})})})]})]})})});aC.displayName="DocThemeDrawer";var aO=(0,j.memo)(function(){var e,n=(0,eN.p)(),t=(0,y.$gs)().isConnected,r=(0,nV._i)(),i=r.docId,o=r.getCollaborativeEditorInstance,s=(0,tC.M)({id:"themeEditor"}),a=s.isOpen,c=s.onOpen,h=s.onClose,g=(0,tC.M)({id:"themeStyleDrawer"}),v=g.isOpen,b=g.onOpen,C=g.onClose,O=null===(e=o())||void 0===e?void 0:e.state.doc.toJSON(),w=(0,q.CG)(K.Pu),k=(0,ab.g)(),E=(0,S.Z)(k,2),I=E[0],P=E[1],D=(0,j.useCallback)(function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?n?P({type:"SET_NEW_THEME_FOR_SELECTING",data:{theme:e}}):P({type:"SET_THEME_EDITING",data:{theme:e}}):P({type:"NEW_BLANK_THEME"}),c()},[P,c]),A=o();(0,eO.bb)(A,D);var T=(0,nE.z$)(),R=(0,eO.vi)({docId:i,editor:A}).updateDocThemeWithAccentImages,_=(0,j.useCallback)(function(e){e.id!==w.id&&R(e.id).then(function(){null==T||T.track(nE.AA.DOC_THEME_UPDATED,{doc_id:i,theme_id:e.id})}).catch(function(e){console.error(e),n({title:(0,ed.jsx)(l.cC,{id:"Fulf8b",values:{0:e.message}}),position:"top",status:"error"})})},[T,w.id,i,n,R]);return(0,j.useEffect)(function(){var e=oz.T.on("toggleThemeBlock",b),n=sI.pw.on(sI.TI.OPEN_THEME_DRAWER,b);return function(){e(),n()}},[b]),(0,ed.jsxs)(u.k,{children:[(0,ed.jsx)(m.kH,{label:t?(0,ed.jsx)(l.cC,{id:"JkEyR8"}):(0,ed.jsx)(l.cC,{id:"GvC+mL",components:{0:(0,ed.jsx)(f.x,{}),1:(0,ed.jsx)(f.x,{color:"gray.300"})}}),"aria-label":d.ag._({id:"JkEyR8"}),children:(0,ed.jsx)(p.xu,{children:(0,ed.jsx)(oN.h,{"data-guider-highlight":"toolbar-theme-button",onClick:b,isDisabled:!t,icon:(0,ed.jsx)(x.G,{icon:av.q2}),"data-testid":"toolbar-theme-button",children:(0,ed.jsx)(l.cC,{id:"FEr96N"})})})}),(0,ed.jsx)(aC,{isOpen:v&&!a,onClose:C,openThemeEditor:D,setDocTheme:_}),(0,ed.jsx)(aj.z,{isOpen:a,onClose:h,state:I,dispatch:P,docContent:O,onThemeCreated:_,disableDrawerTransition:!0})]})});aO.displayName="ThemeBlock";var aw=t(31997),ak=t(74588),aS=t(95472),aE=[.5,.8,.9,1,1.1,1.2,1.5,2],aI=function(e){return"".concat((100*e).toFixed(0),"%")},aP=function(){var e=(0,ir.ye)("presentZoom"),n=(0,nV._i)().editor,t=(0,nE.z$)(),r=(0,b.I0)(),i=(0,q.CG)(K.SU),o=(0,j.useCallback)(function(e){r((0,K.Ic)({zoomLevel:e})),r((0,K.fT)({enabled:!1})),null==t||t.track(nE.AA.DOC_ZOOMED,{direction:"set",level:e})},[r,t]),s=(0,j.useCallback)(function(){r((0,K.fT)({enabled:!0}))},[r]),a=(0,j.useCallback)(function(){var e=Math.min(ii.v4,i+.1);r((0,K.Ic)({zoomLevel:e})),r((0,K.fT)({enabled:!1})),null==t||t.track(nE.AA.DOC_ZOOMED,{direction:"in",level:e})},[r,t,i]),c=(0,j.useCallback)(function(){var e=Math.max(ii.Ou,i-.1);r((0,K.Ic)({zoomLevel:e})),r((0,K.fT)({enabled:!1})),null==t||t.track(nE.AA.DOC_ZOOMED,{direction:"in",level:e})},[r,t,i]),u=(0,j.useCallback)(function(){var e=ii.aX;r((0,K.Ic)({zoomLevel:e})),r((0,K.fT)({enabled:!1})),null==t||t.track(nE.AA.DOC_ZOOMED,{direction:"reset",level:e})},[r,t]),p=(0,q.CG)(rL.C),h=(0,rA.rJ)();return((0,j.useEffect)(function(){if(e)return rD.F7.on("keydown","PRESENT_BLOCK",function(e){return!(p||!n||(0,aS.KB)(n)||(0,nL.Hx)(e.target))&&((0,rP.ZP)("=")(e)?(a(),e.preventDefault(),!0):(0,rP.ZP)("-")(e)?(c(),e.preventDefault(),!0):(0,rP.ZP)("0")(e)?(u(),e.preventDefault(),!0):!!(0,rP.ZP)("9")(e)&&(s(),e.preventDefault(),!0))})},[p,e,n,a,c,u,s]),e)?(0,ed.jsxs)(n2.h,{spacing:"0",size:"sm",variant:"plain",isAttached:!0,children:[(0,ed.jsx)(m.kH,{closeOnMouseDown:!1,closeOnClick:!1,shortcut:"-",label:d.ag._({id:"FjkaiT"}),children:(0,ed.jsx)(A.h,{"aria-label":d.ag._({id:"FjkaiT"}),fontWeight:"normal",onClick:c,icon:(0,ed.jsx)(x.G,{icon:aw.Kl})})}),(0,ed.jsxs)(rJ.v,{closeOnSelect:!0,children:[(0,ed.jsx)(m.kH,{label:d.ag._({id:"VZ3UQG"}),children:(0,ed.jsx)(rQ.j,{minW:20,as:el.z,variant:"plain",size:"sm",rightIcon:(0,ed.jsx)(x.G,{icon:ak.eW}),children:h?(0,ed.jsx)(l.cC,{id:"R9Khdg"}):aI(i)})}),(0,ed.jsxs)(rX.q,{maxW:"220px",children:[(0,ed.jsx)(r1._,{value:h?"auto":i.toString(),type:"radio",children:(0,ed.jsx)(r2.i,{value:"auto",onClick:s,children:(0,ed.jsxs)(er.U,{children:[(0,ed.jsxs)(f.x,{children:[(0,ed.jsx)(l.cC,{id:"R9Khdg"})," ",(0,ed.jsx)(f.x,{as:"span",color:"gray.500",children:(0,ed.jsx)(l.cC,{id:"P9Cyl9"})})]}),(0,ed.jsx)(oD.L,{}),(0,ed.jsx)(f.x,{as:"span",opacity:"0.6",children:"9"})]})})}),(0,ed.jsx)(r0.R,{}),(0,ed.jsx)(r1._,{value:h?"auto":i.toString(),type:"radio",children:aE.map(function(e){return(0,ed.jsx)(r2.i,{value:(e/100).toString(),onClick:function(){o(e)},children:(0,ed.jsxs)(er.U,{children:[(0,ed.jsx)(f.x,{children:aI(e)}),(0,ed.jsx)(oD.L,{}),e===ii.aX&&(0,ed.jsx)(f.x,{as:"span",opacity:"0.6",children:"0"})]})},e)})})]})]}),(0,ed.jsx)(m.kH,{closeOnMouseDown:!1,closeOnClick:!1,shortcut:"+",label:d.ag._({id:"AWOSPo"}),children:(0,ed.jsx)(A.h,{fontWeight:"normal","aria-label":d.ag._({id:"AWOSPo"}),onClick:a,icon:(0,ed.jsx)(x.G,{icon:tD.r8})})})]}):null};(0,eK.E)(p.xu);var aD=(0,j.memo)(function(e){var n,r,i=e.scrollingParentSelector,o=e.toggleCommentsPanel,s=e.isCommentsPanelOpen,c=e.editorWrapperEl,l=e.docEditorType,d=(0,oP.a)(["(max-width: 840px)","(min-width: 841px)"]),f=(0,S.Z)(d,1)[0],p=(0,ow.i)({base:!0,lg:!1}),h=(0,tF.LQ)(window.location.href),x=(0,q.CG)(K.gh),m=(0,q.CG)(nB.yx),g=(0,nV._i)().editor,v=(0,nU.py)("comment",m),b=(0,rN.g)(g).enabled;(0,q.CG)(K.WI),(0,q.CG)(K.yn);var y="SLIDE_VIEW"!==x,C=(0,q.CG)(K.hN),O=l!==nH.Z.COLLABORATIVE,w=l===nH.Z.PUBLIC_STATIC,k=(0,q.CG)(K.Tf),E=(0,ir.ye)("aiChat");(0,ir.ye)("pptExport")&&(window.exportToPptx=(n=(0,nq.Z)(nY().mark(function e(n){var r;return nY().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([t.e(9775),t.e(5743),t.e(3496)]).then(t.bind(t,13448));case 4:return r=e.sent.exportToPptx,e.abrupt("return",r(g,n));case 7:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}));var I=B((0,j.useCallback)(function(e){var n=P.current;return!!n&&(!!(n.querySelector("[data-active]")||n.querySelector('[aria-expanded="true"]'))||e.clientY<100)},[]),!k),P=(0,j.useRef)(null),D=!k||k&&I,A=!!(null==m?void 0:m.publishedSnapshotId),T=!(0,tG.s2)()&&!f&&!h;return(0,ed.jsxs)(u.k,{"data-editor-toolbar":!0,ref:P,bg:"linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.1) 100%)",position:"absolute",zIndex:"overlay",top:0,left:0,right:0,p:2,alignItems:"center",pr:6,marginTop:D?0:"-100%",pointerEvents:"none",sx:(r={},(0,a.Z)(r,"&:focus-within",{marginTop:0}),(0,a.Z)(r,"> *",{pointerEvents:"auto"}),(0,a.Z)(r,"> #toolbar-spacer",{pointerEvents:"none"}),r),transitionProperty:"margin-top",transitionDuration:"ultra-slow",transitionTimingFunction:"ease-in-out","data-print-hidden":!0,children:[(0,ed.jsx)(so.a,{}),!w&&(0,ed.jsx)(er.U,{children:(0,ed.jsx)(o6,{doc:m})}),(0,ed.jsx)(oD.L,{pointerEvents:"none",id:"toolbar-spacer"}),(0,ed.jsxs)(er.U,{children:[!f&&(0,ed.jsx)(st.D,{}),!f&&!y&&(0,ed.jsx)(aP,{}),!f&&!y&&(0,ed.jsx)(ed.Fragment,{children:(0,ed.jsx)(ag,{spotlightingByBlock:b})}),!f&&!O&&C&&(0,ed.jsx)(aO,{}),!f&&!O&&(0,ed.jsx)(ax.S,{doc:m}),T&&!A&&(0,ed.jsx)(ah,{doc:m,isStaticEditor:O,editorWrapperEl:c,scrollingParentSelector:i}),T&&A&&(0,ed.jsx)(o_,{doc:m}),!O&&v&&(0,ed.jsx)(sr.U,{doc:m,mode:x,isCommentsPanelOpen:s,toggleCommentsPanel:o}),!f&&p&&!O&&C&&E&&(0,ed.jsx)(si.u,{}),!f&&!O&&(0,ed.jsx)(oV,{doc:m}),!f&&!O&&(0,ed.jsx)(s9,{doc:m,editorWrapperEl:c,scrollingParentSelector:i}),!w&&(0,ed.jsx)(u.k,{children:(0,ed.jsx)(n4.DY,{showRing:!0})})]})]})}),aA=t(34684),aT=t(18751),aR=t(95993),a_=t(33266),aM=t(27483),aL=t(81891),az=t(2702),aN=t(60081),aZ=t(17665),aG=t(54113),aF=t(51663),aU=t(73593),aW=t(20362),aH=t(34768),aV=t(4038),aB=t(43862),aq=t(42545),aK=t(92470),aY=t(82360),aJ=(i=(0,nq.Z)(nY().mark(function e(n){var t,r,i,o,s,a,c;return nY().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.editor,r=n.chain,i=n.node,o=n.imageAttrs,s=n.pos,r.updateAttributesAtPos(s,(0,aK.j6)(i,{uploadStatus:aB.D.Uploading})),a=o.tempUrl,c=o.src,(0,aV.WY)(c,t.storage.mediaUpload.orgId,{onUploadComplete:function(e){(0,aK.Ns)(t,a,e)},onUploadFailed:function(e){(0,aK.f8)(t,a,e,!0)}});case 4:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)}),aQ=function(e,n){console.debug("[AIStream processAIImages] for cardId: ",n);var t=e.chain(),r=(0,nR.N2)(e.state.doc,function(e){return(0,nM.KH)(e)&&e.attrs.id===n})[0];if(!r){console.error("[processAIImages] can not find card with id: ",n);return}var i=r.pos,o=i+r.node.nodeSize;e.state.doc.descendants(function(n,r){if(r<i||r>o)return!0;var s,a=n.attrs,c=n.type,l=void 0;return"image"===c.name?l=a:(0,aY.E)(n)?l=a.image:((0,nM.KH)(n)||(0,aq.pt)(n))&&(l=null===(s=a.background)||void 0===s?void 0:s.image),l&&l.uploadStatus===aB.D.Queued&&(console.debug("[AIStream processAIImages]: ".concat(n.type.name," node with AI queries at pos ").concat(r,":"),l),aJ({editor:e,chain:t,node:n,imageAttrs:l,pos:r})),!0}),t.run()},aX=["latency"];function a$(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function a0(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a$(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a$(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var a1="[CONTENT_FILTER]",a2=function(){return(0,ed.jsxs)(sk.b,{status:"error",variant:"solid",children:[(0,ed.jsx)(sS.z,{}),(0,ed.jsx)(aT.X,{children:(0,ed.jsxs)(eo.K,{children:[(0,ed.jsx)("strong",{children:(0,ed.jsx)(l.cC,{id:"7g5s/N"})}),(0,ed.jsx)(f.x,{children:(0,ed.jsx)(l.cC,{id:"Xp43Ei"})})]})})]})},a5=function(e){var n=e.editor,t=e.chunk,r=e.theme,i=e.docFormatKey,o=t.id,s=t.index,a=(0,aZ.a)({chunk:t,theme:r,docFormatKey:i}),c=(0,nR.N2)(n.state.doc,function(e){return(0,of.KH)(e)})[0],l=(0,nR.N2)(n.state.doc,function(e){return(0,of.KH)(e)&&e.attrs.id===o})[0];if(!c)throw Error("Doc does not have a first card");var d=l?{from:l.pos,to:l.pos+l.node.nodeSize}:0===s?{from:c.pos,to:c.pos+c.node.nodeSize}:n.state.doc.nodeSize-3;try{if(n.commands.insertContentAt(d,a,{updateSelection:!1}),t.cardComplete&&0===t.index){var u=(0,iX.t)(n.state.doc.resolve(c.pos));u&&n.commands.command(function(e){return e.tr.setSelection(u),!0})}}catch(e){console.warn("[useCreateFromStream] ERROR updating card",a),console.warn(e)}},a3=function(e){var n=e.docId,t=e.store,r=e.generateInfo,i=e.editor;if(!r.lastEventId||!r.streamId||!r.interactionId){console.error("Trying to resume stream for doc (id=".concat(n,") without lastEventId or streamId or interactionId"),{lastEventId:r.lastEventId,streamId:r.streamId,interactionId:r.interactionId});return}aL.a.trackRequestSent(t,{interface:"wizard",streaming:!0,interactionId:r.interactionId,isResuming:!0});var o=(0,aM.pM)({interactionId:r.interactionId,lastEventId:r.lastEventId,streamId:r.streamId,retries:3}).stream;return(0,a_.Nl)({stream:o,docId:n,interactionId:r.interactionId,lastCompletedCardId:r.lastCompletedCardId,lastCompletedCardIndex:r.lastCompletedCardIndex,options:{imageOptions:r.imageOptions||{license:r.imageLicense},docFormatKey:(0,aU.hx)((0,aU.VA)(i)).key},store:t})},a4=function(e,n){var t,r=(0,q.qr)(),i=(0,q.TL)(),o=(0,q.CG)(K.KV),s=(0,ir.ye)("streamResumingEnabled"),a=(0,j.useRef)(!1),c=a6({docId:e}),l=c.isStreaming,d=c.onStreamData,u=c.onStreamDone,f=c.onStreamError,p=c.onStreamStart,h=c.onAbortStream,x=a9(l),m=(0,j.useCallback)((t=(0,nq.Z)(nY().mark(function t(i){var o,s,c;return nY().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:p({editor:n}),s=a8({streamResponse:i,editor:n,store:r,docId:e}).getReader(),t.prev=5;case 6:return t.next=8,s.read();case 8:if((o=t.sent).done){t.next=18;break}if(o.value){t.next=11;break}return t.abrupt("continue",6);case 11:if(!a.current){t.next=14;break}return console.log("[AIStream] has aborted -- no longer reading stream"),t.abrupt("break",18);case 14:"data"===(c=o.value).event&&(d({value:c.data,editor:n,streamResponse:i}),x()),t.next=6;break;case 18:t.next=24;break;case 20:return t.prev=20,t.t0=t.catch(5),f({err:t.t0,streamResponse:i,editor:n}),t.abrupt("return");case 24:if(!a.current){t.next=26;break}return t.abrupt("return");case 26:c&&"done"!==c.event&&console.error('[AIStream] incomplete stream: last message received is not `event="done"`',{lastMessage:c}),u({editor:n,streamResponse:i});case 28:case"end":return t.stop()}},t,null,[[5,20]])})),function(e){return t.apply(this,arguments)}),[e,n,d,u,f,p,x,r]);(0,aH.v)(function(){if(n&&o&&!l){var t=(0,tL.oH)(e)(r.getState()),i=(0,tL.nl)(r.getState());if(t){"running"===t.status&&m(t);return}if(s&&!i){var a=(0,aU.VA)(n),c=a.generateInfo;if("streaming"===a.generateStatus){var d=(0,K.yx)(r.getState());if((null==d?void 0:d.createdTime)&&Date.now()-new Date(d.createdTime).getTime()>36e5){n.commands.updateAttributesAtPos(0,{generateStatus:"done"});return}var u=a3({docId:e,generateInfo:c,editor:n,store:r});u&&m(u)}}}},[e,n,r,o,p,f,d,u,s,m,l],[n,o]),(0,j.useEffect)(function(){return function(){var t=(0,tL.oH)(e)(r.getState());n&&t&&"running"===t.status&&(a.current=!0,h({editor:n,streamResponse:t}))}},[i,e,h,n,r])},a6=function(e){var n=e.docId,t=(0,eN.p)(),r=(0,q.TL)(),i=(0,q.qr)(),o=(0,ir.ye)("aiWizardUploadImages"),s=(0,q.CG)(K.Pu),a=(0,j.useState)(!1),c=a[0],d=a[1],u=(0,j.useRef)(null);(0,j.useEffect)(function(){return function(){u.current&&(t.close(u.current),u.current=null)}},[t]);var f=(0,j.useCallback)(function(){u.current||(u.current=t({id:"ai-generating-toast",isClosable:!1,render:function(){return(0,ed.jsxs)(sk.b,{variant:"light",children:[(0,ed.jsx)(tp.$,{size:"sm",mr:2}),(0,ed.jsxs)(aT.X,{children:[(0,ed.jsx)("strong",{children:(0,ed.jsx)(l.cC,{id:"n2cF1o"})})," ",(0,ed.jsx)(l.cC,{id:"BFGwQA"})]})]})},position:"top",duration:null}))},[t]),p=(0,j.useCallback)(function(e){var n=e.editor;n&&(d(!0),n.commands.setAIGenerationRunning(!0),f())},[f]),h=(0,j.useCallback)(function(e){var n=e.editor,t=e.value;if(e.streamResponse&&n){var r=(0,aU.hx)((0,aU.VA)(n)),i=t.id,a=t.cardComplete;a5({chunk:t,editor:n,theme:s,docFormatKey:r.key}),a&&o&&aQ(n,i)}},[o,s]),x=(0,j.useCallback)(function(e){var n=e.editor,o=e.streamResponse;if(n&&o){var s=o.id,a=(0,aU.hx)((0,aU.VA)(n));d(!1),n.commands.setAIGenerationRunning(!1),n.commands.updateAttributesAtPos(0,{generateStatus:"done"}),(0,aN.rD)(),r((0,tL.G0)({id:s,status:"complete"})),aL.a.trackStreamComplete(i,s),(0,aG.d)("wizardCreation"),u.current&&t.update(u.current,{title:(0,ed.jsx)(l.cC,{id:"2/LpWt",values:{0:a.generationLabel||a.label}}),status:"success",position:"top",duration:3e3,isClosable:!0})}},[r,i,t]);return{isStreaming:c,onStreamStart:p,onStreamData:h,onStreamError:(0,j.useCallback)(function(e){var o=e.err,s=e.editor,a=e.streamResponse,c=a.id,f=(0,az.uS)(o),p=f.errorMessage,h=f.errorCode;d(!1),s.commands.setAIGenerationRunning(!1),s.commands.updateAttributesAtPos(0,{generateStatus:"done"}),(0,aN.rD)(),r((0,tL.G0)({id:c,status:"error"}));var x=(0,tL.Sn)(c)(i.getState());if(x){var m=x.latency,g=(0,eI.Z)(x,aX);(0,tQ.pQ)(a0(a0({},g),{},{errorName:"StreamError",errorMessage:p,errorCode:h,outputMessage:"",latency:m||performance.now()-g.startTime,isResuming:a.isResuming,docId:n}))}u.current&&(p===a1?t.update(u.current,{render:a2,position:"top",duration:null,isClosable:!0}):t.update(u.current,{title:(0,ed.jsx)(l.cC,{id:"sbsGk/"}),status:"error",position:"top",duration:null,isClosable:!0}))},[r,n,i,t]),onStreamDone:x,onAbortStream:(0,j.useCallback)(function(e){var n=e.editor,t=e.streamResponse.id;d(!1),n.commands.setAIGenerationRunning(!1),aL.a.trackStreamAbort(i,{interactionId:t,abortReason:"leave-editor"}),r((0,tL.Of)({id:t}))},[r,i])}},a8=function(e){var n=e.streamResponse,t=e.editor,r=e.store,i=e.docId,o=n.id,s=n.stream,a=!0;return s.pipeThrough(new aR.GJ({transform:function(e,n){if("done"===e.event&&"content_filter"===e.finishReason){n.error(Error(a1));return}n.enqueue(e)}})).pipeThrough((0,a_.c1)(function(e){a&&"data"===e.event&&(aL.a.trackStreamStart(r,{interactionId:o,docId:i}),n.isResuming&&t.commands.deleteCardsAfter(n.lastCompletedCardId||null),a=!1),"data"===e.event&&e.data.cardComplete&&t.commands.updateNestedAttributesAtPos(0,{generateInfo:{lastEventId:e.data.eventId,lastCompletedCardId:e.data.id,lastCompletedCardIndex:e.data.index}})}))},a9=function(e){var n=(0,aF.As)("editor"),t=(0,j.useRef)(!0);(0,j.useEffect)(function(){if(e){var r=n.scroller;if(r){var i=function(){n.isAtBottom(40)?t.current=!0:t.current=!1},o=function(){t.current=!1};return r.addEventListener("wheel",i,{passive:!0}),r.addEventListener("touchend",i,{passive:!0}),r.addEventListener("touchstart",o,{passive:!0}),r.addEventListener("touchmove",o,{passive:!0}),function(){r.removeEventListener("wheel",i),r.removeEventListener("touchend",i),r.removeEventListener("touchstart",o),r.removeEventListener("touchmove",o)}}}},[n,e]);var r=(0,j.useCallback)(function(){if(t.current){var e;null===(e=n.scroller)||void 0===e||e.scrollTo({top:n.scroller.scrollHeight,behavior:"auto"})}},[n]);return(0,aW.Z_)(r,100)},a7=t(14198),ce=function(e){var n=e.toggleToCPanel,t=e.initializeToCPanel,r=e.isToCPanelOpen,i=(0,a7.F)().breakpoints.xl,o=(0,q.CG)(K.gh),s=(0,j.useState)(o!==nz.q.SLIDE_VIEW),a=s[0],c=s[1],l=(0,j.useState)(!1),d=l[0];l[1];var u=(0,b.I0)();(0,ti.vm)(function(){t()},[i,n,t,u],[]),(0,ti.vm)(function(){o===nz.q.SLIDE_VIEW?(c(r),n({disableTransition:!1,override:"closed"})):d&&o===nz.q.DOC_VIEW&&n({disableTransition:!1,override:a?"open":"closed"})},[n,r,a,o,d],[o])};function cn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function ct(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?cn(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cn(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var cr="doc_archived_warning",ci=function(e,n){var t=(0,eN.p)(),r=(0,y.iX9)(),i=(0,S.Z)(r,1)[0];(0,j.useEffect)(function(){return function(){t.close(cr)}},[]),(0,j.useEffect)(function(){e&&n===nH.Z.COLLABORATIVE&&(e.archived&&!t.isActive(cr)?t({id:cr,title:(0,ed.jsxs)(f.x,{"data-testid":"trash-confirmation-toast",children:[(0,ed.jsx)(l.cC,{id:"fkHPZu"})," ",(0,ed.jsx)(eZ.r,{textDecoration:"underline",onClick:function(){var n={id:e.id};i({variables:n,optimisticResponse:{unarchiveDoc:ct(ct({},n),{},{archived:!0,__typename:"Doc"})}})},children:(0,ed.jsx)(l.cC,{id:"7wfwc0"})})]}),status:"warning",position:"top",isClosable:!1,duration:null}):!e.archived&&t.isActive(cr)&&t.close(cr))},[e,n,t,i])},co=function(){var e=(0,ir.ye)("filmstrip"),n=(0,q.CG)(nB.fh),t=(0,ik.Br)("comment"),r=(0,q.CG)(K.gh);return e&&n===nH.Z.COLLABORATIVE&&t&&r===nz.q.DOC_VIEW&&!(0,tG.s2)()},cs=t(20372),ca=t(27910),cc=t(80102),cl=t(50350),cd=function(){var e=(0,ev.nO)(),n=(0,ev.UV)(),t=(0,ow.i)({base:!1,lg:!0,"2xl":!1}),r=(0,q.CG)(K.Hl),i=(0,q.CG)(K.GX),o=co(),s=(0,ca.k)(),c=(0,cs.S)((0,a.Z)({base:"0px"},cc.K0,cl.bk))||"0px";return(0,j.useMemo)(function(){return{"--editor-padding-left":i&&o&&t?"".concat(150,"px"):"0px","--editor-padding-right":r?c:s?"60px":"0px","--present-padding-left":"".concat(e,"px"),"--present-padding-right":"".concat(n,"px"),"--comment-slide-margin":c}},[i,e,r,n,s,t,c,o])},cu=t(28615),cf=function(e){var n=(0,q.TL)(),t=(0,q.CG)(K.GX),r=(0,j.useRef)(!1);(0,j.useEffect)(function(){!e||r.current||t||(r.current=!0,n((0,K.dQ)({isOpen:!0})))},[n,t,e])},cp=t(56675),ch=t(65185);function cx(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function cm(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?cx(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var cg=function(e){var n=(0,cp.x)(),t=(0,q.CG)(ch.cn);(0,j.useEffect)(function(){t&&n.cache.updateQuery({query:sm.yE1,variables:{id:e}},function(e){if(!(null!=e&&e.doc))return e;var n=e.doc;return n.titleEdited?e:{doc:cm(cm({},n),{},{title:t})}})},[t,n,e])},cv=t(47947),cj=t(46732),cb=function(e,n){var t=(0,cj._)().isUnauthorized;(0,nE.If)(function(r){!0!==t&&void 0!==t&&(r.track(nE.AA.DOC_VIEWED,{doc_id:e}),n===nH.Z.EXAMPLE_STATIC&&r.track(nE.AA.EXAMPLE_VIEWED,{doc_id:e}))},[e,n,t]),(0,cv.d)();var r=(0,ir.ye)("realUserMetrics"),i=n===nH.Z.COLLABORATIVE&&r,o=(0,ir.ye)("rumKeystrokeSampleRate");(0,sK.lh)(i,o)},cy=function(e){var n=(0,b.I0)(),t=(0,nE.z$)();(0,j.useEffect)(function(){var r,i=function(){var i=(0,q.bh)().getState();r=(0,K.Q5)(i),(0,sY.I7)(e),n((0,K.lx)({isEditingDisabled:!0})),null==t||t.trackDocEvent(nE.AA.DOC_PRINTED)},o=function(){n((0,K.lx)({isEditingDisabled:!1})),n((0,K.xn)({expandedCardsMap:r}))};return window.addEventListener("beforeprint",i),window.addEventListener("afterprint",o),function(){window.removeEventListener("beforeprint",i),window.removeEventListener("afterprint",o)}},[n,e,t])};function cC(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function cO(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?cC(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var cw="doc-root",ck=function(e){var n=e.isConnected;return(0,ed.jsx)(u.k,{flex:1,alignItems:"center",justifyContent:"center",color:"gray.500",fontSize:"2xl",children:n?(0,ed.jsx)(l.cC,{id:"svObPT",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc}}):(0,ed.jsxs)(u.k,{m:8,alignItems:"center",direction:"row",children:[(0,ed.jsx)(x.G,{icon:c.bK,size:"4x"}),(0,ed.jsx)(f.x,{ml:8,children:(0,ed.jsx)(l.cC,{id:"qercPA",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc},components:{0:(0,ed.jsx)("strong",{})}})})]})})},cS=function(e){var n=e.doc,t=e.user,r=e.docEditorType,i=(0,C.$m)(n,t),o=(0,b.v9)(K.gh),s=r===nH.Z.COLLABORATIVE&&!i,a=s&&o===nz.q.SLIDE_VIEW;return(null==i?void 0:i.permission)=="view"?(0,ed.jsx)(rm.m,{}):a?(0,ed.jsx)(ex,{}):s?(0,ed.jsx)(k.C,{showTourReplay:!0}):null},cE=(0,nV.eT)(function(e){var n=e.docEditorType,t=(0,nV._i)(),r=t.docId,i=t.isUnauthorized,o=t.setCollaborativeEditorInstance,s=t.editor,a=(0,q.CG)(nB.yx),c=(0,y.$gs)().isConnected,l=(0,nU.SE)().user;(0,O.F3)(),ci(a,n),a4(r,s),cg(r),cb(r,n),(0,cu.j)(),(0,aA.P)(),(0,aA.J)(),(0,rb.Zd)(s,".".concat(cw)),rI(s),(0,nW.V)(),cy(s),(0,C.DD)(a,n===nH.Z.COLLABORATIVE);var f=(0,j.useRef)(null),x=(0,q.TL)(),g=(0,eO.Yy)(),b=(0,j.useMemo)(function(){return(0,nk.vu)(g)},[g]),k=co();cf(k);var S=cd(),E=(0,j.useMemo)(function(){return cO(cO({},b),S)},[b,S]);console.debug("%c[DocEditorComponent] RENDER - ".concat(r),"background-color: gold");var I=(0,ev.Pp)(oI.Q),P=I.togglePanel,D=I.isPanelOpen,A=I.initPanel,T=(0,ev.Pp)(tE.s),R=T.togglePanel,_=T.isPanelOpen,M=(0,ev.Pp)(tI.Rr),L=M.togglePanel,z=M.isPanelOpen;(0,tI.QK)({toggleDesignPartnerPanel:L,isDesignPartnerPanelOpen:z,editor:s}),ce({toggleToCPanel:P,isToCPanelOpen:D,initializeToCPanel:A}),(0,j.useEffect)(function(){return function(){x((0,ey.qo)())}},[x]);var N=(0,j.useCallback)(function(){return!!(s&&s.state.selection.empty)},[s]),Z=(0,ev.Xy)(),G=Z.leftPanelLifecycle,F=Z.rightPanelLifecycle,U=Z.globalPanelLifecycle,W=(0,eg.dU)(null==a?void 0:a.organization),H=(0,w.U)(null==a?void 0:a.title,W),V=d.ag._({id:"X6YCwz"}),B=d.ag._({id:"abr3hR"});return(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)("style",{id:"editorStyleOverride",children:"body {overflow: hidden;}"}),(0,ed.jsx)(v(),{children:(0,ed.jsx)("title",{children:H})}),(0,ed.jsx)(tk,{doc:a,editor:s}),(0,ed.jsx)(eC.H9,{isEnabledFn:N}),i?(0,ed.jsx)(ck,{isConnected:c}):(0,ed.jsxs)(u.k,{id:"doc-main",direction:"row",w:"100%",h:"100%","data-testid":"doc-editor-root",ref:f,children:[(0,ed.jsx)(ej.Av,{panelLifecycle:G}),(0,ed.jsxs)(u.k,{flex:"1",direction:"column",position:"relative",minWidth:"0",h:"100%",children:[(0,ed.jsx)(m.Wk,{isDark:g,children:(0,ed.jsx)(aD,{scrollingParentSelector:".".concat(cw),editorWrapperEl:f.current,docEditorType:n,isToCPanelOpen:D,toggleToCPanel:P,isCommentsPanelOpen:_,toggleCommentsPanel:R})}),(0,ed.jsxs)(p.xu,{flex:"1",overflowY:"auto",overflowX:"hidden",minWidth:"0",h:"100%",className:(0,h.cx)(cw,z&&"design-partner-panel-open"),style:{"--ai-editing-label":"'".concat(V,"'"),"--ai-generating-label":"'".concat(B,"'")},sx:E,children:[n===nH.Z.PUBLIC_STATIC?(0,ed.jsx)(rO,{docId:r,snapshotId:null==a?void 0:a.currentSnapshotId,scrollingParentSelector:".".concat(cw),onCreate:o}):n===nH.Z.EXAMPLE_STATIC?(0,ed.jsx)(rj,{docId:r,snapshotId:null==a?void 0:a.currentSnapshotId,scrollingParentSelector:".".concat(cw),onCreate:o}):(0,ed.jsxs)(eb.Mn.Provider,{value:U,children:[(0,ed.jsx)(ew.Ge,{doc:a,docId:r,readOnly:null==a?void 0:a.archived,onCreate:o,scrollingParentSelector:".".concat(cw)}),s&&(0,ed.jsx)(nF,{editor:s})]}),(0,ed.jsx)(rc,{editor:s}),(0,ed.jsx)(iy,{editor:s})]})]}),(0,ed.jsx)(ej.U8,{panelLifecycle:F}),(0,ed.jsx)(nS.a,{editorId:"main",children:(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(nw,{editor:s}),(0,ed.jsx)(cS,{doc:a,user:l,docEditorType:n}),k&&(0,ed.jsx)(oE,{})]})})]})]})}),cI=t(56768),cP=t(93031),cD=t(59195),cA=t(92488),cT=t(38717),cR=t(21496),c_=function(e){var n=e.theme,t=e.onClick,r=e.isChecked,i=e.index,o=e.startIndex;return(0,ed.jsxs)(p.xu,{gridColumnStart:i+1-o,display:o>i?"none":"block",gridRow:1,as:cT.f,p:2,transition:"all 0.2s ease-in-out",bgColor:r?"trueblue.100":"linen.50",textAlign:"left",tabIndex:0,borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_focus:{boxShadow:r?void 0:"outline"},outline:"none",onClick:t,_hover:{bgColor:r?"trueblue.100":"gray.100"},onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&t()},"data-theme-id":n.id,"data-testid":r?"current-theme-preview":void 0,cursor:"pointer",children:[(0,ed.jsx)(cR.n,{theme:n}),(0,ed.jsxs)(eo.K,{direction:"row",spacing:1,pt:1,children:[r&&(0,ed.jsx)(tu.n,{w:3,h:"auto",mr:1,color:"trueblue.700"}),(0,ed.jsx)(f.x,{fontSize:"sm",noOfLines:1,"data-testid":"theme-name",color:r?"trueblue.700":void 0,children:n.name})]})]})};c_.displayName="DemoDocThemePreview";var cM="linen.50",cL=function(e){var n=e.templateTheme,r=e.setTheme,i=e.currentThemeId,o=(0,b.v9)(K.gh)===nz.q.SLIDE_VIEW,s=(0,j.useState)([]),a=s[0],c=s[1],d=(0,j.useState)(!1),f=d[0],p=d[1],h=(0,j.useState)(0),m=h[0],g=h[1],v=(0,ow.i)({base:3,md:4,lg:5})||3;(0,j.useEffect)(function(){t.e(3541).then(t.bind(t,33541)).then(function(e){c(e.GLOBAL_THEMES)})},[]);var y=[].concat((0,ih.Z)(n?[n]:[]),(0,ih.Z)(a.filter(function(e){return e.id!==(null==n?void 0:n.id)}))),C=(0,j.useCallback)(function(e){1===e?g(function(e){return e+1}):g(function(e){return e-1})},[]);return o?(0,ed.jsx)(ed.Fragment,{}):(0,ed.jsx)(eS.h,{children:(0,ed.jsxs)(u.k,{w:"100%",position:"absolute",bottom:0,left:0,bgColor:cM,zIndex:"sticky",direction:"column",borderTop:"3px solid var(--chakra-colors-trueblue-500)",minH:12,p:2,justifyContent:"center",children:[(0,ed.jsx)(u.k,{alignItems:"flex-end",justify:"flex-end",children:(0,ed.jsx)(el.z,{variant:"ghost",size:"sm",rightIcon:(0,ed.jsx)(x.G,{icon:f?cA.gc:cD.on}),onClick:function(){return p(function(e){return!e})},children:f?(0,ed.jsx)(l.cC,{id:"yz7wBu"}):(0,ed.jsx)(l.cC,{id:"x6tIe+"})})}),(0,ed.jsx)(u.k,{justify:"flex-start",align:"flex-start",bgColor:cM,w:"100%",children:f&&(0,ed.jsxs)(eo.K,{direction:"row",align:"center",justify:"center",w:"100%",children:[(0,ed.jsx)(A.h,{"aria-label":"Left",onClick:function(){return C(-1)},variant:"ghost",isDisabled:0===m,icon:(0,ed.jsx)(x.G,{icon:cP.Ey})}),(0,ed.jsx)(rR.r,{w:"100%",flex:1,overflow:"hidden",padding:2,transition:"all 0.2s ease-in-out",templateColumns:["repeat(".concat(v,", calc(100% / ").concat(v," - 1em))")],gap:"0 1em",bgColor:cM,children:y.map(function(e,n){return(0,ed.jsx)(c_,{index:n,startIndex:m,isChecked:e.id===i,theme:e,onClick:function(){r(e)}},e.id)})}),(0,ed.jsx)(A.h,{"aria-label":"Right",variant:"ghost",isDisabled:m+v>y.length,onClick:function(){return C(1)},icon:(0,ed.jsx)(x.G,{icon:cI.yO})})]})})]})})},cz=t(53589),cN=t(68690),cZ=t(10344),cG=t(70091),cF=t(88963),cU=[{description:(0,ed.jsx)(l.cC,{id:"gtWy3j"}),shortcut:["",""]},{description:(0,ed.jsx)(l.cC,{id:"UCxK2S"}),shortcut:["",""]},{description:(0,ed.jsx)(l.cC,{id:"IkakN2"}),shortcut:"Esc"},{description:(0,ed.jsx)(l.cC,{id:"CgmvBu"}),shortcut:"S"},{description:(0,ed.jsx)(l.cC,{id:"rEj/lx"}),shortcut:"Enter"},{description:(0,ed.jsx)(l.cC,{id:"dQU33K"}),shortcut:"Mod+Shift+O"},{description:(0,ed.jsx)(l.cC,{id:"K0Oq/D"}),shortcut:"R"}],cW=function(e){var n=s2({editorWrapperEl:e.editorWrapperEl,scrollingParentSelector:e.scrollingParentSelector}),t=n.enterSlideView,r=n.exitSlideView,i=n.setExitedFullscreenByClick,o=n.isFullscreen,s=n.enterFullscreen,a=n.exitFullscreen,c=(0,q.CG)(K.gh),u=(0,j.useRef)(c);return(0,j.useEffect)(function(){u.current=c},[c]),(0,ed.jsxs)(er.U,{children:[(0,ed.jsxs)(n2.h,{isAttached:!0,size:"sm",children:[(0,ed.jsx)(m.kH,{label:c===nz.q.DOC_VIEW?(0,ed.jsx)(l.cC,{id:"ek5OwP",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc}}):(0,ed.jsx)(l.cC,{id:"43JI0J",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc}}),children:(0,ed.jsx)(el.z,{variant:c===nz.q.DOC_VIEW?"solid":"plain",cursor:c===nz.q.SLIDE_VIEW?"pointer":"auto",onClick:function(){c===nz.q.SLIDE_VIEW&&r()},leftIcon:(0,ed.jsx)(x.G,{icon:cN.cw}),children:(0,ed.jsx)(l.cC,{id:"7Zdnlq"})})}),(0,ed.jsx)(m.kH,{label:c===nz.q.SLIDE_VIEW?(0,ed.jsx)(l.cC,{id:"Zfr5aa",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc}}):(0,ed.jsx)(l.cC,{id:"rK6Cev",values:{GAMMA_ARTIFACT_PROPER_NOUN:em.Yc}}),children:(0,ed.jsx)(el.z,{variant:c===nz.q.SLIDE_VIEW?"solid":"plain",cursor:c===nz.q.DOC_VIEW?"pointer":"auto",onClick:function(){c===nz.q.DOC_VIEW&&t({fullscreen:!1})},leftIcon:(0,ed.jsx)(x.G,{icon:cz.bg}),children:(0,ed.jsx)(l.cC,{id:"FOoDGS"})})})]}),c===nz.q.SLIDE_VIEW&&(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(ec.i,{orientation:"vertical"}),(0,ed.jsx)(m.kH,{label:o?(0,ed.jsx)(l.cC,{id:"IkOhTI"}):(0,ed.jsx)(l.cC,{id:"q8ARHN"}),children:(0,ed.jsx)(A.h,{size:"sm","aria-label":o?d.ag._({id:"IkOhTI"}):d.ag._({id:"q8ARHN"}),borderRadius:"md",icon:(0,ed.jsx)(x.G,{icon:o?ae.Qj:s7.TL}),onClick:o?function(){i(!0),a()}:s})}),(0,ed.jsxs)(P.J,{children:[(0,ed.jsx)(D.x,{children:(0,ed.jsx)(el.z,{size:"sm",variant:"plain",fontWeight:"normal",children:(0,ed.jsx)(l.cC,{id:"77Emn0"})})}),(0,ed.jsxs)(T.y,{border:"1px solid #eee !important",children:[(0,ed.jsx)(cZ.Q,{}),(0,ed.jsx)(cG.u,{}),(0,ed.jsx)(R.b,{children:(0,ed.jsx)(cF.A,{list:cU})})]})]})]})]})},cH=(0,j.memo)(function(e){var n=e.scrollingParentSelector,t=e.editorWrapperEl;(0,q.CG)(nB.yx);var r=(0,j.useRef)(null);return(0,ed.jsx)(u.k,{ref:r,bg:"white",borderBottom:"3px solid var(--chakra-colors-trueblue-600)",position:"absolute",zIndex:"overlay",top:0,left:0,right:0,p:2,alignItems:"flex-start",justifyContent:"flex-start",pr:6,children:(0,ed.jsx)(u.k,{direction:"column",w:"100%",children:(0,ed.jsx)(cW,{editorWrapperEl:t,scrollingParentSelector:n})})})}),cV="doc-root",cB=(0,nV.eT)(function(e){var n,t=e.docEditorType,r=void 0===t?nH.Z.COLLABORATIVE:t,i=(0,nV._i)(),o=i.docId,s=i.setCollaborativeEditorInstance,a=i.editor,c=(0,q.CG)(nB.yx);cb(o,r),(0,cu.j)(),(0,aA.P)(),(0,aA.J)(),(0,rb.Zd)(a,".".concat(cV)),rI(a),(0,nW.V)(),cy(a),(0,C.DD)(c,r===nH.Z.COLLABORATIVE);var l=(0,j.useRef)(null),d=null==c?void 0:c.theme,f=(0,j.useState)(function(){return d}),h=f[0],x=f[1],m=(0,q.TL)(),g=(0,j.useRef)(!1),b=(0,y.EDv)({variables:{docId:o,snapshotId:null==c?void 0:c.currentSnapshotId},skip:!(null!=c&&c.currentSnapshotId)}).data,O=null==b?void 0:null===(n=b.snapshot)||void 0===n?void 0:n.content.default;console.debug("%c[DemoDocEditorComponent] RENDER - ".concat(o),"background-color: gold"),(0,j.useEffect)(function(){d&&!g.current&&(x(d),g.current=!0)},[d]),(0,j.useEffect)(function(){if(a){var e=null==h?void 0:h.config.accentBackgrounds;if(!e||0===e.length){O&&a.commands.setContent(O);return}a.commands.updateThemeAccentImages(e)}},[a,h,O]);var w=(0,ev.Pp)(oI.Q);ce({toggleToCPanel:w.togglePanel,isToCPanelOpen:w.isPanelOpen,initializeToCPanel:w.initPanel}),(0,j.useEffect)(function(){return function(){m((0,ey.qo)())}},[m]);var k=(0,ev.Xy)(),S=k.leftPanelLifecycle;return k.globalPanelLifecycle,(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)("style",{id:"editorStyleOverride",children:"body {overflow: hidden;}"}),(0,ed.jsx)(v(),{children:(0,ed.jsxs)("title",{children:["".concat(c?(0,oW.$)(c.title)+" | ":""),"Gamma"]})}),(0,ed.jsxs)(u.k,{id:"doc-main",direction:"row",w:"100%",h:"100%","data-testid":"doc-editor-root",ref:l,children:[(0,ed.jsx)(ej.Av,{panelLifecycle:S}),(0,ed.jsxs)(u.k,{flex:"1",direction:"column",position:"relative",minWidth:"0",h:"100%",children:[a&&(0,ed.jsx)(cH,{scrollingParentSelector:".".concat(cV),editorWrapperEl:l.current,setTheme:x,currentThemeId:(null==h?void 0:h.id)||(null==d?void 0:d.id),templateTheme:d}),(0,ed.jsxs)(p.xu,{flex:"1",overflowY:"auto",overflowX:"hidden",minWidth:"0",h:"100%",className:cV,children:[(0,ed.jsx)(rO,{docId:o,snapshotId:null==c?void 0:c.currentSnapshotId,scrollingParentSelector:".".concat(cV),onCreate:s,theme:h,showMadeWithGammaBadge:!1}),(0,ed.jsx)(iy,{editor:a,showNavigationControls:!0})]})]}),(0,ed.jsx)(nw,{editor:a}),(0,ed.jsx)(cL,{setTheme:x,currentThemeId:(null==h?void 0:h.id)||(null==d?void 0:d.id),templateTheme:d})]})]})}),cq=t(1005),cK=t(86633),cY="body",cJ=t(56648),cQ=t(60670),cX=function(e){var n=(0,aF.As)(e),t=(0,j.useState)("up"),r=t[0],i=t[1];return(0,j.useEffect)(function(){var e=document.querySelector(n.scrollSelector);if(e){var t=(null==e?void 0:e.scrollTop)||0,r=function(){var n=(null==e?void 0:e.scrollTop)||0;Math.abs(n-t)>0&&(i(!(n>t)||t>0&&0===n||n>0&&0===t?"up":"down"),t=n>0?n:0)},o=W()(function(){return window.requestAnimationFrame(r)},500,{leading:!0});return null==e||e.addEventListener("scroll",o),function(){return null==e?void 0:e.removeEventListener("scroll",o)}}},[n.scrollSelector]),r},c$=t(26806);function c0(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function c1(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c0(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c0(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var c2=function(e){var n,t,r,i=e.doc,o=e.onCommentFeedOpen,s=e.onTocOpen,a=e.commentsEnabled,c=(0,o2.X)(J.H.lastHomeUrl,"/"),l=(0,S.Z)(c,1)[0],d=(0,nU.SE)().user,u=(null==i?void 0:null===(n=i.comments)||void 0===n?void 0:n.filter(function(e){return e.status===y.Ux9.Open}).length)||0,p=cX("editor"),h=(0,b.v9)(K.Pu),m=(0,c$.Jh)(h),g=null!==(t=h.config.bodyColor)&&void 0!==t?t:(0,n8.wj)(h)?"white":"gray.800",v=null!==(r=h.accentColor)&&void 0!==r?r:(0,n8.wj)(h)?"trueblue.300":"trueblue.700";return(0,ed.jsxs)(er.U,{p:1,px:2,bg:"gray.50",shadow:"lg",position:"sticky",top:0,transitionProperty:"common",transitionDuration:"normal",transform:"up"==p?"translate(0px,0px)":"translate(0px,-100%)",opacity:"up"==p?1:0,zIndex:"sticky",sx:c1(c1({},(0,c$.Oj)(m,h,!0)),{},{border:"none",filter:"none",borderRadius:0}),color:g,children:[d&&(0,ed.jsx)(tM(),{href:l,passHref:!0,legacyBehavior:!0,children:(0,ed.jsx)(A.h,{as:eZ.r,"aria-label":"Home",color:g,_hover:{bg:"transparent",color:v},icon:(0,ed.jsx)(x.G,{icon:oB.J9,size:"1x"}),variant:"ghost"})}),(0,ed.jsx)(f.x,{flex:1,fontSize:"sm",noOfLines:1,ml:2,color:g,children:null==i?void 0:i.title}),(0,ed.jsxs)(n2.h,{variant:"ghost",children:[(void 0===a||a)&&(0,ed.jsx)(el.z,{color:g,_hover:{bg:"transparent",color:v},fontSize:"sm",onClick:o,leftIcon:(0,ed.jsx)(x.G,{icon:cQ.Mz}),children:u}),(0,ed.jsx)(A.h,{color:g,"aria-label":"Open table of contents",_hover:{bg:"transparent",color:v},onClick:s,icon:(0,ed.jsx)(x.G,{icon:cJ.xi})})]})]})},c5=function(e){var n=e.doc,t=e.docEditorType,r=e.commentsEnabled,i=void 0===r||r,o=(0,nV._i)(),s=o.docId,a=o.setCollaborativeEditorInstance,c=o.editor,l=(0,I.q)({id:"mobile-comment-feed-panel-drawer"}),d=l.isOpen,f=l.onOpen,p=l.onClose,h=(0,I.q)({id:"mobile-toc-drawer"}),x=h.isOpen,g=h.onOpen,v=h.onClose,b=(0,j.useState)(null),y=b[0],C=b[1];return console.debug("%c[MobileEditorWrapper] RENDER - ".concat(s),"background-color: gold"),(0,ed.jsxs)(u.k,{ref:(0,j.useCallback)(function(e){return C(e)},[]),direction:"column",flex:1,children:[(0,ed.jsx)(c2,{doc:n,onCommentFeedOpen:f,onTocOpen:g,commentsEnabled:i}),t===nH.Z.PUBLIC_STATIC?(0,ed.jsx)(rO,{docId:s,snapshotId:null==n?void 0:n.currentSnapshotId,scrollingParentSelector:cY,onCreate:a}):t===nH.Z.EXAMPLE_STATIC?(0,ed.jsx)(rj,{docId:s,snapshotId:null==n?void 0:n.currentSnapshotId,scrollingParentSelector:cY,onCreate:a}):(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(ew.Ge,{doc:n,docId:s,readOnly:!0,onCreate:a,scrollingParentSelector:cY}),c&&(0,ed.jsx)(nF,{editor:c})]}),i&&d&&(0,ed.jsx)(m.Aj,{isOpen:d,onClose:p,drawerProps:{autoFocus:!1},children:(0,ed.jsx)(cq.m,{onClose:p,editor:c})}),x&&(0,ed.jsx)(m.Aj,{isOpen:x,onClose:v,children:(0,ed.jsx)(cK.o,{rootElement:y,handleClose:v})}),(0,ed.jsx)(nS.a,{children:(0,ed.jsx)(rc,{editor:c})})]})},c3=(0,nV.eT)(function(e){var n=e.docEditorType,t=(0,nV._i)(),r=t.docId,i=t.isUnauthorized,o=t.editor;cb(r,n),a4(r,o),(0,cu.j)();var s=(0,j.useRef)(null),a=(0,b.v9)(nB.yx);console.debug("%c[MobileDocViewerComponent] RENDER - ".concat(r),"background-color: gold");var c=n===nH.Z.COLLABORATIVE;return(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsxs)(v(),{children:[(0,ed.jsxs)("title",{children:["".concat(a?(0,oW.$)(a.title)+" | ":""),"Gamma"]}),(0,ed.jsx)("meta",{name:"viewport",content:"width=device-width, user-scalable=no"})]}),(0,ed.jsx)(aa.Global,{styles:{html:{overflowX:"hidden"},body:{overflow:"hidden scroll",WebkitOverflowScrolling:"touch"}}}),i?(0,ed.jsxs)(u.k,{flex:1,alignItems:"center",justifyContent:"center",color:"gray.500",fontSize:"2xl",p:6,textAlign:"center",children:["It looks like you don't have access to this"," ",em.Yc,"."]}):(0,ed.jsx)(u.k,{id:"doc-main",direction:"column",w:"100%",h:"100%","data-testid":"doc-editor-root",ref:s,flex:"1",children:(0,ed.jsx)(c5,{doc:a,docEditorType:n,commentsEnabled:c})})]})})},47827:function(e,n,t){t.d(n,{AA:function(){return h},DN:function(){return f},mb:function(){return p}});var r=t(20406),i=t(28526),o=t.n(i),s=t(5632),a=t(2784),c=t(46358),l=t(42879),d=t(62141),u=t(6985),f=(0,a.createContext)({openPageSetup:function(e,n){},openSharePanel:function(e,n){}}),p=function(e,n){var t=(0,s.useRouter)().push,i=(0,c.qr)();return(0,a.useMemo)(function(){var s,a;return{openPageSetup:(s=(0,r.Z)(o().mark(function r(s,a){var c,f;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n){r.next=2;break}return r.abrupt("return");case 2:if(c=function(){return u.T.emit("openPageSetup",a)},!(s!==e)){r.next=9;break}return r.next=6,t((0,l.as)(n,s));case 6:f=i.subscribe(function(){(0,d.ke)(i.getState())===s&&(c(),f())}),r.next=10;break;case 9:c();case 10:case"end":return r.stop()}},r)})),function(e,n){return s.apply(this,arguments)}),openSharePanel:(a=(0,r.Z)(o().mark(function r(s,a){var c,f;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n){r.next=2;break}return r.abrupt("return");case 2:if(c=function(){return u.T.emit("openSharePanel",a)},!(s!==e)){r.next=9;break}return r.next=6,t((0,l.as)(n,s));case 6:f=i.subscribe(function(){(0,d.ke)(i.getState())===s&&(c(),f())}),r.next=10;break;case 9:c();case 10:case"end":return r.stop()}},r)})),function(e,n){return a.apply(this,arguments)})}},[e,t,n,i])},h=function(){return(0,a.useContext)(f)}},28916:function(e,n,t){t.d(n,{V:function(){return o}});var r=t(2784),i="drag-in-progress",o=function(){(0,r.useEffect)(function(){var e=function(){document.body.classList.add(i)},n=function(){document.body.classList.remove(i)};return document.body.addEventListener("dragstart",e,!0),document.body.addEventListener("dragend",n,!0),document.body.addEventListener("drop",n,!0),document.body.addEventListener("mouseup",n,!0),function(){document.body.removeEventListener("dragstart",e,!0),document.body.removeEventListener("dragend",n,!0),document.body.removeEventListener("drop",n,!0),document.body.removeEventListener("mouseup",n,!0)}},[])}}}]);
//# sourceMappingURL=3056-409dc86c22c94e6a.js.map